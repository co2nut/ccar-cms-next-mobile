{"ast":null,"code":"var __jsx = React.createElement;\nimport { Avatar, Button, Form, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { loading } from '../../redux/actions/app-actions';\nimport { withRouter } from 'next/router';\nimport client from '../../feathers';\nconst minTimeout = 1000;\nconst popoutPercentage = [true, true, false, false, false, false, false, false, false, false]; // const popoutPercentage = [true, true, true, true, true, true, true, true, true, true]\n// const popoutPercentage = [false, false, false, false, false, false, false, false, false, false]\n\nconst types = ['company', 'product', 'user'];\n\nconst RecommendDialog = props => {\n  const {\n    0: confirmModalState,\n    1: setConfirmModalState\n  } = useState(false);\n  useEffect(() => {\n    let timeout = minTimeout * Math.random() * 10;\n    setTimeout(function () {\n      setConfirmModalState(_.sample(_.shuffle(popoutPercentage), 1));\n    }, timeout);\n  }, []);\n\n  function close(e) {\n    setConfirmModalState(false);\n  }\n\n  function createRecommended(type, id, isRecommended) {\n    if (props[type + 'Id'] == null) {\n      if (props.handleError) {\n        props.handleError({\n          message: 'Invalid recommend item.'\n        });\n      }\n\n      return null;\n    }\n\n    if (!props.user.authenticated) {\n      if (props.handleError) {\n        props.handleError({\n          message: 'Please Login First.'\n        });\n      }\n\n      return null;\n    }\n\n    let data = {};\n    data.type = type;\n    data[type + 'Id'] = id;\n    data.reviewerId = props.user.info.user._id;\n    data.isRecommended = isRecommended;\n    props.loading(true);\n    setTimeout(() => {\n      client.authenticate().then(res => {\n        client.service('recommendeds').create(data).then(res => {\n          props.loading(false);\n          message.success(isRecommended ? 'Thank you for recommending us.' : 'Kindly provide your feedback to us. We will try our best to improve our services.');\n\n          if (props.handleSuccess) {\n            props.handleSuccess(res);\n          }\n\n          close();\n        });\n      }).catch(err => {\n        props.loading(false);\n        console.log(err);\n        message.error(err.message);\n\n        if (props.handleError) {\n          props.handleError(err);\n        }\n\n        close();\n      });\n    }, 1000);\n  }\n\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: confirmModalState,\n    closable: true,\n    centered: true,\n    maskClosable: false,\n    footer: null,\n    onCancel: close\n  }, __jsx(\"div\", {\n    className: \"padding-md fill-parent\"\n  }, props.renderAvatar ? props.renderAvatar(props.avatar ? props.avatar : null) : props.avatar ? __jsx(\"div\", {\n    className: \"flex-justify-center flex-items-align-center fill-parent padding-y-sm\"\n  }, __jsx(Avatar, {\n    size: 100,\n    src: props.avatar\n  })) : null, props.renderTitle ? props.renderTitle(props.title ? props.title : null) : props.title ? __jsx(\"div\", {\n    className: \"flex-justify-center flex-items-align-center text-overflow-break headline   font-weight-bold fill-parent padding-y-sm margin-bottom-lg\"\n  }, props.title) : null, props.renderDesc ? props.renderDesc(props.desc ? props.desc : null) : props.desc ? __jsx(\"div\", {\n    className: \"flex-justify-center flex-items-align-center text-overflow-break subtitle1 fill-parent padding-y-sm margin-bottom-sm\"\n  }, props.desc) : null, __jsx(\"div\", {\n    className: props.buttonClass ? props.buttonClass : \"flex-justify-center flex-items-align-center fill-parent padding-y-sm\"\n  }, __jsx(\"a\", {\n    className: \"margin-x-sm\",\n    onClick: e => {\n      if (!props.app.loading) {\n        createRecommended(props.type ? props.type : null, props[`${props.type}Id`] ? props[`${props.type}Id`] : null, true);\n      }\n    }\n  }, props.renderYesButton ? props.renderYesButton() : __jsx(Button, {\n    style: {\n      backgroundColor: \"#F9A825\"\n    }\n  }, props.okText ? props.okText : \"Yes\")), __jsx(\"a\", {\n    className: \"margin-x-sm\",\n    onClick: e => {\n      if (!props.app.loading) {\n        createRecommended(props.type ? props.type : null, props[`${props.type}Id`] ? props[`${props.type}Id`] : null, false);\n      }\n    }\n  }, props.renderNoButton ? props.renderNoButton() : __jsx(Button, null, props.noText ? props.noText : \"No\"))))));\n};\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user\n});\n\nconst mapDispatchToProps = {\n  loading: loading\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(RecommendDialog)));","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/profile/RecommendDialog.jsx"],"names":["Avatar","Button","Form","message","Modal","_","React","useEffect","useState","connect","loading","withRouter","client","minTimeout","popoutPercentage","types","RecommendDialog","props","confirmModalState","setConfirmModalState","timeout","Math","random","setTimeout","sample","shuffle","close","e","createRecommended","type","id","isRecommended","handleError","user","authenticated","data","reviewerId","info","_id","authenticate","then","res","service","create","success","handleSuccess","catch","err","console","log","error","className","style","renderAvatar","avatar","renderTitle","title","renderDesc","desc","buttonClass","app","renderYesButton","backgroundColor","okText","renderNoButton","noText","mapStateToProps","state","mapDispatchToProps"],"mappings":";AAAA,SAASA,MAAT,EAAiBC,MAAjB,EAAyBC,IAAzB,EAA+BC,OAA/B,EAAwCC,KAAxC,QAAqD,MAArD;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,OAAT,QAAwB,iCAAxB;AACA,SAASC,UAAT,QAA2B,aAA3B;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AAGA,MAAMC,UAAU,GAAG,IAAnB;AACA,MAAMC,gBAAgB,GAAG,CAAC,IAAD,EAAO,IAAP,EAAa,KAAb,EAAoB,KAApB,EAA2B,KAA3B,EAAkC,KAAlC,EAAyC,KAAzC,EAAgD,KAAhD,EAAuD,KAAvD,EAA8D,KAA9D,CAAzB,C,CACA;AACA;;AAEA,MAAMC,KAAK,GAAG,CAAC,SAAD,EAAY,SAAZ,EAAuB,MAAvB,CAAd;;AACA,MAAMC,eAAe,GAAIC,KAAD,IAAW;AAE/B,QAAM;AAAA,OAACC,iBAAD;AAAA,OAAoBC;AAApB,MAA4CX,QAAQ,CAAC,KAAD,CAA1D;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAIa,OAAO,GAAGP,UAAU,GAAGQ,IAAI,CAACC,MAAL,EAAb,GAA6B,EAA3C;AACAC,IAAAA,UAAU,CAAC,YAAY;AAAEJ,MAAAA,oBAAoB,CAACd,CAAC,CAACmB,MAAF,CAASnB,CAAC,CAACoB,OAAF,CAAUX,gBAAV,CAAT,EAAsC,CAAtC,CAAD,CAApB;AAAgE,KAA/E,EAAiFM,OAAjF,CAAV;AAEH,GAJQ,EAIN,EAJM,CAAT;;AAMA,WAASM,KAAT,CAAeC,CAAf,EAAkB;AACdR,IAAAA,oBAAoB,CAAC,KAAD,CAApB;AACH;;AAED,WAASS,iBAAT,CAA2BC,IAA3B,EAAiCC,EAAjC,EAAqCC,aAArC,EAAoD;AAEhD,QAAId,KAAK,CAACY,IAAI,GAAG,IAAR,CAAL,IAAsB,IAA1B,EAAgC;AAC5B,UAAIZ,KAAK,CAACe,WAAV,EAAuB;AACnBf,QAAAA,KAAK,CAACe,WAAN,CAAkB;AAAE7B,UAAAA,OAAO,EAAE;AAAX,SAAlB;AACH;;AACD,aAAO,IAAP;AACH;;AAED,QAAI,CAACc,KAAK,CAACgB,IAAN,CAAWC,aAAhB,EAA+B;AAC3B,UAAIjB,KAAK,CAACe,WAAV,EAAuB;AACnBf,QAAAA,KAAK,CAACe,WAAN,CAAkB;AAAE7B,UAAAA,OAAO,EAAE;AAAX,SAAlB;AACH;;AACD,aAAO,IAAP;AACH;;AAED,QAAIgC,IAAI,GAAG,EAAX;AACAA,IAAAA,IAAI,CAACN,IAAL,GAAYA,IAAZ;AACAM,IAAAA,IAAI,CAACN,IAAI,GAAG,IAAR,CAAJ,GAAoBC,EAApB;AACAK,IAAAA,IAAI,CAACC,UAAL,GAAkBnB,KAAK,CAACgB,IAAN,CAAWI,IAAX,CAAgBJ,IAAhB,CAAqBK,GAAvC;AACAH,IAAAA,IAAI,CAACJ,aAAL,GAAqBA,aAArB;AAEAd,IAAAA,KAAK,CAACP,OAAN,CAAc,IAAd;AACAa,IAAAA,UAAU,CAAC,MAAM;AACbX,MAAAA,MAAM,CAAC2B,YAAP,GACKC,IADL,CACWC,GAAD,IAAS;AACX7B,QAAAA,MAAM,CAAC8B,OAAP,CAAe,cAAf,EAA+BC,MAA/B,CAAsCR,IAAtC,EAA4CK,IAA5C,CAAkDC,GAAD,IAAS;AACtDxB,UAAAA,KAAK,CAACP,OAAN,CAAc,KAAd;AACAP,UAAAA,OAAO,CAACyC,OAAR,CAAgBb,aAAa,GAAG,gCAAH,GAAsC,mFAAnE;;AACA,cAAId,KAAK,CAAC4B,aAAV,EAAyB;AACrB5B,YAAAA,KAAK,CAAC4B,aAAN,CAAoBJ,GAApB;AACH;;AAEDf,UAAAA,KAAK;AACR,SARD;AAUH,OAZL,EAaKoB,KAbL,CAaYC,GAAD,IAAS;AACZ9B,QAAAA,KAAK,CAACP,OAAN,CAAc,KAAd;AACAsC,QAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACA5C,QAAAA,OAAO,CAAC+C,KAAR,CAAcH,GAAG,CAAC5C,OAAlB;;AACA,YAAIc,KAAK,CAACe,WAAV,EAAuB;AACnBf,UAAAA,KAAK,CAACe,WAAN,CAAkBe,GAAlB;AACH;;AAEDrB,QAAAA,KAAK;AACR,OAtBL;AAuBH,KAxBS,EAwBP,IAxBO,CAAV;AAyBH;;AAED,SAEI;AAAM,IAAA,SAAS,EAAET,KAAK,CAACkC,SAAN,GAAkBlC,KAAK,CAACkC,SAAxB,GAAoC,IAArD;AAA2D,IAAA,KAAK,EAAElC,KAAK,CAACmC,KAAN,GAAcnC,KAAK,CAACmC,KAApB,GAA4B;AAA9F,KACI,MAAC,KAAD;AACI,IAAA,OAAO,EAAElC,iBADb;AAEI,IAAA,QAAQ,MAFZ;AAGI,IAAA,QAAQ,MAHZ;AAII,IAAA,YAAY,EAAE,KAJlB;AAKI,IAAA,MAAM,EAAE,IALZ;AAMI,IAAA,QAAQ,EAAEQ;AANd,KAQI;AAAK,IAAA,SAAS,EAAC;AAAf,KAEQT,KAAK,CAACoC,YAAN,GACIpC,KAAK,CAACoC,YAAN,CAAmBpC,KAAK,CAACqC,MAAN,GAAerC,KAAK,CAACqC,MAArB,GAA8B,IAAjD,CADJ,GAGIrC,KAAK,CAACqC,MAAN,GACI;AAAK,IAAA,SAAS,EAAC;AAAf,KACI,MAAC,MAAD;AAAQ,IAAA,IAAI,EAAE,GAAd;AAAmB,IAAA,GAAG,EAAErC,KAAK,CAACqC;AAA9B,IADJ,CADJ,GAKI,IAVhB,EAaQrC,KAAK,CAACsC,WAAN,GACItC,KAAK,CAACsC,WAAN,CAAkBtC,KAAK,CAACuC,KAAN,GAAcvC,KAAK,CAACuC,KAApB,GAA4B,IAA9C,CADJ,GAGIvC,KAAK,CAACuC,KAAN,GACI;AAAK,IAAA,SAAS,EAAC;AAAf,KACKvC,KAAK,CAACuC,KADX,CADJ,GAKI,IArBhB,EAwBQvC,KAAK,CAACwC,UAAN,GACIxC,KAAK,CAACwC,UAAN,CAAiBxC,KAAK,CAACyC,IAAN,GAAazC,KAAK,CAACyC,IAAnB,GAA0B,IAA3C,CADJ,GAGIzC,KAAK,CAACyC,IAAN,GACI;AAAK,IAAA,SAAS,EAAC;AAAf,KACKzC,KAAK,CAACyC,IADX,CADJ,GAKI,IAhChB,EAkCI;AAAK,IAAA,SAAS,EAAEzC,KAAK,CAAC0C,WAAN,GAAoB1C,KAAK,CAAC0C,WAA1B,GAAwC;AAAxD,KACI;AAAG,IAAA,SAAS,EAAC,aAAb;AAA2B,IAAA,OAAO,EAAGhC,CAAD,IAAO;AACvC,UAAI,CAACV,KAAK,CAAC2C,GAAN,CAAUlD,OAAf,EAAwB;AACpBkB,QAAAA,iBAAiB,CAACX,KAAK,CAACY,IAAN,GAAaZ,KAAK,CAACY,IAAnB,GAA0B,IAA3B,EAAiCZ,KAAK,CAAE,GAAEA,KAAK,CAACY,IAAK,IAAf,CAAL,GAA2BZ,KAAK,CAAE,GAAEA,KAAK,CAACY,IAAK,IAAf,CAAhC,GAAsD,IAAvF,EAA6F,IAA7F,CAAjB;AACH;AACJ;AAJD,KAMQZ,KAAK,CAAC4C,eAAN,GACI5C,KAAK,CAAC4C,eAAN,EADJ,GAGI,MAAC,MAAD;AAAQ,IAAA,KAAK,EAAE;AAAEC,MAAAA,eAAe,EAAE;AAAnB;AAAf,KAAgD7C,KAAK,CAAC8C,MAAN,GAAe9C,KAAK,CAAC8C,MAArB,GAA8B,KAA9E,CATZ,CADJ,EAaI;AAAG,IAAA,SAAS,EAAC,aAAb;AAA2B,IAAA,OAAO,EAAGpC,CAAD,IAAO;AACvC,UAAI,CAACV,KAAK,CAAC2C,GAAN,CAAUlD,OAAf,EAAwB;AACpBkB,QAAAA,iBAAiB,CAACX,KAAK,CAACY,IAAN,GAAaZ,KAAK,CAACY,IAAnB,GAA0B,IAA3B,EAAiCZ,KAAK,CAAE,GAAEA,KAAK,CAACY,IAAK,IAAf,CAAL,GAA2BZ,KAAK,CAAE,GAAEA,KAAK,CAACY,IAAK,IAAf,CAAhC,GAAsD,IAAvF,EAA6F,KAA7F,CAAjB;AACH;AACJ;AAJD,KAMQZ,KAAK,CAAC+C,cAAN,GACI/C,KAAK,CAAC+C,cAAN,EADJ,GAGI,MAAC,MAAD,QAAS/C,KAAK,CAACgD,MAAN,GAAehD,KAAK,CAACgD,MAArB,GAA8B,IAAvC,CATZ,CAbJ,CAlCJ,CARJ,CADJ,CAFJ;AA8EH,CA9ID;;AAiJA,MAAMC,eAAe,GAAGC,KAAK,KAAK;AAC9BP,EAAAA,GAAG,EAAEO,KAAK,CAACP,GADmB;AAE9B3B,EAAAA,IAAI,EAAEkC,KAAK,CAAClC;AAFkB,CAAL,CAA7B;;AAKA,MAAMmC,kBAAkB,GAAG;AACvB1D,EAAAA,OAAO,EAAEA;AADc,CAA3B;AAGA,eAAeD,OAAO,CAACyD,eAAD,EAAkBE,kBAAlB,CAAP,CAA6ClE,IAAI,CAACyC,MAAL,GAAchC,UAAU,CAACK,eAAD,CAAxB,CAA7C,CAAf","sourcesContent":["import { Avatar, Button, Form, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { loading } from '../../redux/actions/app-actions';\nimport { withRouter } from 'next/router';\nimport client from '../../feathers';\n\n\nconst minTimeout = 1000;\nconst popoutPercentage = [true, true, false, false, false, false, false, false, false, false]\n// const popoutPercentage = [true, true, true, true, true, true, true, true, true, true]\n// const popoutPercentage = [false, false, false, false, false, false, false, false, false, false]\n\nconst types = ['company', 'product', 'user'];\nconst RecommendDialog = (props) => {\n\n    const [confirmModalState, setConfirmModalState] = useState(false);\n\n    useEffect(() => {\n        let timeout = minTimeout * Math.random() * 10;\n        setTimeout(function () { setConfirmModalState(_.sample(_.shuffle(popoutPercentage), 1)) }, timeout);\n        \n    }, [])\n\n    function close(e) {\n        setConfirmModalState(false);\n    }\n\n    function createRecommended(type, id, isRecommended) {\n\n        if (props[type + 'Id'] == null) {\n            if (props.handleError) {\n                props.handleError({ message: 'Invalid recommend item.' });\n            }\n            return null;\n        }\n\n        if (!props.user.authenticated) {\n            if (props.handleError) {\n                props.handleError({ message: 'Please Login First.' });\n            }\n            return null;\n        }\n\n        let data = {};\n        data.type = type;\n        data[type + 'Id'] = id;\n        data.reviewerId = props.user.info.user._id;\n        data.isRecommended = isRecommended;\n\n        props.loading(true);\n        setTimeout(() => {\n            client.authenticate()\n                .then((res) => {\n                    client.service('recommendeds').create(data).then((res) => {\n                        props.loading(false);\n                        message.success(isRecommended ? 'Thank you for recommending us.' : 'Kindly provide your feedback to us. We will try our best to improve our services.');\n                        if (props.handleSuccess) {\n                            props.handleSuccess(res);\n                        }\n\n                        close();\n                    })\n\n                })\n                .catch((err) => {\n                    props.loading(false);\n                    console.log(err)\n                    message.error(err.message);\n                    if (props.handleError) {\n                        props.handleError(err);\n                    }\n\n                    close();\n                })\n        }, 1000);\n    }\n\n    return (\n\n        <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n            <Modal\n                visible={confirmModalState}\n                closable\n                centered\n                maskClosable={false}\n                footer={null}\n                onCancel={close}\n            >\n                <div className=\"padding-md fill-parent\">\n                    {\n                        props.renderAvatar ?\n                            props.renderAvatar(props.avatar ? props.avatar : null)\n                            :\n                            props.avatar ?\n                                <div className=\"flex-justify-center flex-items-align-center fill-parent padding-y-sm\">\n                                    <Avatar size={100} src={props.avatar} />\n                                </div>\n                                :\n                                null\n                    }\n                    {\n                        props.renderTitle ?\n                            props.renderTitle(props.title ? props.title : null)\n                            :\n                            props.title ?\n                                <div className=\"flex-justify-center flex-items-align-center text-overflow-break headline   font-weight-bold fill-parent padding-y-sm margin-bottom-lg\">\n                                    {props.title}\n                                </div>\n                                :\n                                null\n                    }\n                    {\n                        props.renderDesc ?\n                            props.renderDesc(props.desc ? props.desc : null)\n                            :\n                            props.desc ?\n                                <div className=\"flex-justify-center flex-items-align-center text-overflow-break subtitle1 fill-parent padding-y-sm margin-bottom-sm\">\n                                    {props.desc}\n                                </div>\n                                :\n                                null\n                    }\n                    <div className={props.buttonClass ? props.buttonClass : \"flex-justify-center flex-items-align-center fill-parent padding-y-sm\"} >\n                        <a className=\"margin-x-sm\" onClick={(e) => {\n                            if (!props.app.loading) {\n                                createRecommended(props.type ? props.type : null, props[`${props.type}Id`] ? props[`${props.type}Id`] : null, true)\n                            }\n                        }}>\n                            {\n                                props.renderYesButton ?\n                                    props.renderYesButton()\n                                    :\n                                    <Button style={{ backgroundColor: \"#F9A825\" }}>{props.okText ? props.okText : \"Yes\"}</Button>\n                            }\n                        </a>\n                        <a className=\"margin-x-sm\" onClick={(e) => {\n                            if (!props.app.loading) {\n                                createRecommended(props.type ? props.type : null, props[`${props.type}Id`] ? props[`${props.type}Id`] : null, false)\n                            }\n                        }}>\n                            {\n                                props.renderNoButton ?\n                                    props.renderNoButton()\n                                    :\n                                    <Button>{props.noText ? props.noText : \"No\"}</Button>\n                            }\n                        </a>\n                    </div>\n                </div>\n\n            </Modal>\n\n\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\n\nconst mapDispatchToProps = {\n    loading: loading,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(RecommendDialog)));"]},"metadata":{},"sourceType":"module"}