{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Avatar, Col, Empty, Row, Tabs, Tooltip } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport Scrollbars from 'react-custom-scrollbars';\nimport { withRouter } from 'next/dist/client/router';\nimport { Form } from '@ant-design/compatible';\nimport { notEmptyLength, arrayLengthCount } from '../../common-function';\nimport Loading from '../general/Loading';\nimport { SmallDashOutlined } from '@ant-design/icons';\nimport { allIcon } from '../../icon';\nvar opts = {\n  height: '390',\n  width: '640',\n  playerVars: {\n    // https://developers.google.com/youtube/player_parameters\n    autoplay: 0\n  }\n};\nvar AUTHORSIZE = 10;\n\nvar SocialNewTabs = function SocialNewTabs(props) {\n  _s();\n\n  var _useState = useState(null),\n      activeKey = _useState[0],\n      setActiveKey = _useState[1];\n\n  var _useState2 = useState([]),\n      newslist = _useState2[0],\n      setNewslist = _useState2[1];\n\n  var _useState3 = useState(false),\n      newsLoading = _useState3[0],\n      setNewsLoading = _useState3[1];\n\n  var _useState4 = useState([]),\n      authorList = _useState4[0],\n      setAuthorList = _useState4[1];\n\n  var _useState5 = useState(false),\n      authorLoading = _useState5[0],\n      setAuthorLoading = _useState5[1];\n\n  var _useState6 = useState(null),\n      selectedAuthor = _useState6[0],\n      setSelectedAuthor = _useState6[1];\n\n  var _useState7 = useState({\n    authorId: null,\n    language: null\n  }),\n      filterGroup = _useState7[0],\n      setFilterGroup = _useState7[1];\n\n  useEffect(function () {\n    getAuthorList();\n  }, []);\n  useEffect(function () {\n    getNewslist();\n  }, [filterGroup, authorList]);\n\n  function getAuthorList() {\n    var match = {\n      publisher: {\n        $ne: 'youtube'\n      }\n    };\n\n    if (props.isNewCar) {\n      match.carYear = moment().format('YYYY');\n\n      if (notEmptyLength(props.data)) {\n        var data = _.compact([_.toLower(props.data.model)]);\n\n        if (notEmptyLength(data)) {\n          match.keywords = {\n            $in: data\n          };\n        }\n      }\n    }\n\n    setAuthorLoading(true);\n    axios.get(\"\".concat(client.io.io.uri, \"getAuthorList\"), {\n      params: {\n        limit: AUTHORSIZE,\n        $match: match\n      }\n    }).then(function (res) {\n      //Wait for render done just unloading\n      setTimeout(function () {\n        setAuthorLoading(false);\n      }, 500);\n\n      if (notEmptyLength(res.data.data)) {\n        setAuthorList(res.data.data);\n      } else {\n        setAuthorList([]);\n      }\n    })[\"catch\"](function (err) {\n      setAuthorLoading(false); // message.error(err.message)\n    });\n  }\n\n  function getNewslist(key) {\n    var query = {\n      $sort: {\n        publishedAt: -1\n      },\n      $limit: 5,\n      $populate: ['authorId'],\n      publisher: {\n        $ne: 'youtube'\n      }\n    };\n\n    if (props.isNewCar) {\n      query.carYear = moment().format('YYYY');\n\n      if (notEmptyLength(props.data)) {\n        var temp = _.compact([props.data.model]);\n\n        if (notEmptyLength(temp)) {\n          temp = _.map(temp, function (item) {\n            return _.toLower(item);\n          });\n          query.keywords = {\n            $in: temp\n          };\n        }\n      }\n    }\n\n    if (filterGroup.authorId != null && filterGroup.authorId != \"\") {\n      query.authorId = filterGroup.authorId;\n    } else {\n      delete query['authorId'];\n    }\n\n    if (filterGroup.language != null && filterGroup.language != \"\" && filterGroup.language != \"all\") {\n      query.language = filterGroup.language;\n      setActiveKey(filterGroup.language);\n    } else {\n      delete query['language'];\n\n      if (languageCount() > 1) {\n        setActiveKey(null);\n      } else {\n        var langs = [];\n\n        _.forEach(authorList, function (item) {\n          langs = _.union(langs, item.language);\n        });\n\n        setActiveKey(langs ? langs[0] : null);\n      }\n    }\n\n    setNewsLoading(true);\n    client.service('news').find({\n      query: query\n    }).then(function (res) {\n      //Wait for render done just unloading\n      setTimeout(function () {\n        setNewsLoading(false);\n      }, 500);\n\n      if (res.data.length > 0) {\n        setNewslist(res.data);\n      } else {\n        setNewslist([]);\n      }\n    })[\"catch\"](function (err) {\n      setNewsLoading(false); // message.error(err.message)\n    });\n  }\n\n  function isSelectedAuthor(author, selectedAuthor) {\n    if (author == null && selectedAuthor == null) {\n      return true;\n    } else if (notEmptyLength(author) && notEmptyLength(selectedAuthor)) {\n      return _.isEqual(author, selectedAuthor);\n    } else {\n      return false;\n    }\n  }\n\n  function languageExisted(lang) {\n    if (lang != null) {\n      if (notEmptyLength(selectedAuthor)) {\n        return _.includes(selectedAuthor.language, lang);\n      } else {\n        var langs = [];\n\n        _.forEach(authorList, function (item) {\n          langs = _.union(langs, item.language);\n        });\n\n        return _.includes(langs, lang);\n      }\n    } else {\n      return false;\n    }\n  }\n\n  function languageCount(author) {\n    var langs = [];\n\n    if (notEmptyLength(author)) {\n      return notEmptyLength(author.language) ? author.language.length : 0;\n    } else {\n      _.forEach(authorList, function (item) {\n        langs = _.union(langs, item.language);\n      });\n    }\n\n    return langs.length;\n  }\n\n  var _renderAuthorList = function _renderAuthorList(data) {\n    if (notEmptyLength(data)) {\n      var allIconHtml = __jsx(\"div\", {\n        key: \"authorList\",\n        className: !isSelectedAuthor(null, selectedAuthor) ? \"padding-md flex-justify-center flex-items-align-center\" : \"padding-md flex-justify-center flex-items-align-center border-selected-yellow thin-border\"\n      }, __jsx(Tooltip, {\n        title: \"All\",\n        placement: \"right\"\n      }, __jsx(\"a\", {\n        onClick: function onClick() {\n          setFilterGroup(_objectSpread(_objectSpread({}, filterGroup), {}, {\n            authorId: null,\n            language: null\n          }));\n          setSelectedAuthor(null);\n        }\n      }, __jsx(\"span\", {\n        className: \"d-inline-block avatar background-grey-lighten-2 overflow-hidden relative-wrapper\",\n        style: {\n          width: 50,\n          height: 50\n        }\n      }, __jsx(\"img\", {\n        src: allIcon,\n        className: \"width-50 height-50 absolute-center\"\n      })))));\n\n      var list = data.map(function (item, i) {\n        return __jsx(\"div\", {\n          key: 'alistData' + i,\n          className: !isSelectedAuthor(item, selectedAuthor) ? \"padding-md flex-justify-center flex-items-align-center\" : \"padding-md flex-justify-center flex-items-align-center border-selected-yellow thin-border\"\n        }, __jsx(Tooltip, {\n          title: item.name ? item.name : null,\n          placement: \"right\"\n        }, __jsx(\"a\", {\n          onClick: function onClick() {\n            setFilterGroup(_objectSpread(_objectSpread({}, filterGroup), {}, {\n              authorId: item._id,\n              language: languageCount(item) > 1 ? null : item.language[0]\n            }));\n            setSelectedAuthor(item);\n          }\n        }, __jsx(Avatar, {\n          size: 50,\n          src: item.thumbnailUrl ? item.thumbnailUrl : null,\n          icon: item.thumbnailUrl ? null : 'user'\n        }))));\n      });\n      list.unshift(allIconHtml);\n      return __jsx(Loading, {\n        spinning: authorLoading\n      }, list);\n    } else {\n      return null;\n    }\n  };\n\n  var renderContent = function renderContent(data) {\n    switch (data.language) {\n      case \"en\":\n        return data.content ? data.content : null;\n\n      case \"cn\":\n        return data.content ? data.content2 : null;\n\n      case 'my':\n        return data.content3 ? data.content3 : null;\n\n      default:\n        break;\n    }\n  };\n\n  var _renderNewsList = function _renderNewsList(data) {\n    if (notEmptyLength(data)) {\n      return __jsx(Row, {\n        gutter: [10, 10]\n      }, __jsx(\"div\", {\n        key: \"newsList\",\n        className: \"d-flex scroller-type\",\n        style: {\n          overflow: 'scroll'\n        }\n      }, data.map(function (item, i) {\n        return __jsx(Col, {\n          key: item._id,\n          xs: 18,\n          sm: 18,\n          md: 18,\n          lg: 18,\n          xl: 18\n        }, __jsx(\"div\", {\n          className: \"box-shadow-thin round-border wrap\",\n          style: {\n            height: '300px'\n          }\n        }, __jsx(\"a\", {\n          style: {\n            color: '#000000'\n          },\n          href: item.originalUrl\n        }, __jsx(\"div\", {\n          className: \"inews\"\n        }, __jsx(\"img\", {\n          src: item.thumbnailUrl,\n          style: {\n            width: \"100%\",\n            height: '150px'\n          }\n        })), __jsx(\"div\", {\n          className: \"ftitle\"\n        }, __jsx(\"h4\", null, item.title), __jsx(\"p\", null, renderContent(item)), __jsx(\"span\", {\n          style: {\n            textTransform: 'capitalize'\n          }\n        }, item.authorId ? item.authorId.name : null, \" | \", moment(item.publishedAt).format('DD-MM-YYYY'))))));\n      })));\n    } else {\n      return null;\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"padding-x-xs\",\n    style: {\n      touchAction: 'pan-y'\n    }\n  }, _renderNewsList(newslist)));\n};\n\n_s(SocialNewTabs, \"piYtMMpFeIQ4uhEgXXt4UfahUnU=\");\n\n_c = SocialNewTabs;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    app: state.app,\n    newCars: state.newCars\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(SocialNewTabs)));\n\nvar _c;\n\n$RefreshReg$(_c, \"SocialNewTabs\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/news/social-new-tabs.jsx"],"names":["Avatar","Col","Empty","Row","Tabs","Tooltip","axios","_","moment","React","useEffect","useState","connect","client","Scrollbars","withRouter","Form","notEmptyLength","arrayLengthCount","Loading","SmallDashOutlined","allIcon","opts","height","width","playerVars","autoplay","AUTHORSIZE","SocialNewTabs","props","activeKey","setActiveKey","newslist","setNewslist","newsLoading","setNewsLoading","authorList","setAuthorList","authorLoading","setAuthorLoading","selectedAuthor","setSelectedAuthor","authorId","language","filterGroup","setFilterGroup","getAuthorList","getNewslist","match","publisher","$ne","isNewCar","carYear","format","data","compact","toLower","model","keywords","$in","get","io","uri","params","limit","$match","then","res","setTimeout","err","key","query","$sort","publishedAt","$limit","$populate","temp","map","item","languageCount","langs","forEach","union","service","find","length","isSelectedAuthor","author","isEqual","languageExisted","lang","includes","_renderAuthorList","allIconHtml","list","i","name","_id","thumbnailUrl","unshift","renderContent","content","content2","content3","_renderNewsList","overflow","color","originalUrl","title","textTransform","touchAction","mapStateToProps","state","app","newCars","mapDispatchToProps","create"],"mappings":"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","sourcesContent":["import { Avatar, Col, Empty, Row, Tabs, Tooltip } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport Scrollbars from 'react-custom-scrollbars';\nimport { withRouter } from 'next/dist/client/router';\nimport { Form } from '@ant-design/compatible';\nimport { notEmptyLength, arrayLengthCount } from '../../common-function';\nimport Loading from '../general/Loading';\nimport { SmallDashOutlined } from '@ant-design/icons';\nimport { allIcon } from '../../icon';\n\n\n\nconst opts = {\n    height: '390',\n    width: '640',\n    playerVars: {\n        // https://developers.google.com/youtube/player_parameters\n        autoplay: 0,\n    },\n};\n\nconst AUTHORSIZE = 10\nconst SocialNewTabs = (props) => {\n\n\n    const [activeKey, setActiveKey] = useState(null);\n    const [newslist, setNewslist] = useState([]);\n    const [newsLoading, setNewsLoading] = useState(false);\n    const [authorList, setAuthorList] = useState([]);\n    const [authorLoading, setAuthorLoading] = useState(false);\n    const [selectedAuthor, setSelectedAuthor] = useState(null);\n    const [filterGroup, setFilterGroup] = useState({\n        authorId: null,\n        language: null,\n    });\n\n\n\n    useEffect(() => {\n        getAuthorList();\n    }, [])\n\n\n    useEffect(() => {\n        getNewslist();\n    }, [filterGroup, authorList])\n\n    function getAuthorList() {\n\n        let match = {\n            publisher: {\n                $ne: 'youtube',\n            }\n        };\n\n        if (props.isNewCar) {\n            match.carYear = moment().format('YYYY');\n\n            if (notEmptyLength(props.data)) {\n                let data = _.compact([_.toLower(props.data.model)]);\n                if (notEmptyLength(data)) {\n                    match.keywords = {\n                        $in: data,\n                    }\n                }\n            }\n        }\n\n        setAuthorLoading(true);\n        axios.get(`${client.io.io.uri}getAuthorList`,\n            {\n                params: {\n                    limit: AUTHORSIZE,\n                    $match: match,\n                }\n            }).then((res) => {\n                //Wait for render done just unloading\n                setTimeout(() => {\n                    setAuthorLoading(false);\n                }, 500);\n                if (notEmptyLength(res.data.data)) {\n                    setAuthorList(res.data.data);\n                } else {\n                    setAuthorList([]);\n                }\n            }).catch(err => {\n                setAuthorLoading(false);\n                // message.error(err.message)\n            });\n    }\n\n    function getNewslist(key) {\n        let query = {\n            $sort: {\n                publishedAt: -1\n            },\n            $limit: 5,\n            $populate: ['authorId'],\n            publisher: { $ne: 'youtube' }\n        }\n\n        if (props.isNewCar) {\n            query.carYear = moment().format('YYYY');\n            if (notEmptyLength(props.data)) {\n                let temp = _.compact([props.data.model]);\n                if (notEmptyLength(temp)) {\n                    temp = _.map(temp, function (item) {\n                        return _.toLower(item);\n                    })\n                    query.keywords = {\n                        $in: temp,\n                    }\n                }\n            }\n        }\n\n        if (filterGroup.authorId != null && filterGroup.authorId != \"\") {\n            query.authorId = filterGroup.authorId;\n        } else {\n            delete query['authorId'];\n        }\n\n        if (filterGroup.language != null && filterGroup.language != \"\" && filterGroup.language != \"all\") {\n            query.language = filterGroup.language;\n            setActiveKey(filterGroup.language);\n        } else {\n            delete query['language'];\n            if (languageCount() > 1) {\n                setActiveKey(null);\n            } else {\n                let langs = [];\n                _.forEach(authorList, function (item) {\n                    langs = _.union(langs, item.language);\n                })\n                setActiveKey((langs) ? langs[0] : null);\n            }\n        }\n\n        setNewsLoading(true)\n        client.service('news').find({\n            query: query,\n        }).then((res) => {\n            //Wait for render done just unloading\n            setTimeout(() => {\n                setNewsLoading(false);\n            }, 500);\n            if (res.data.length > 0) {\n                setNewslist(res.data);\n            } else {\n                setNewslist([]);\n            }\n        }).catch(err => {\n            setNewsLoading(false)\n            // message.error(err.message)\n        });\n\n\n    }\n\n\n    function isSelectedAuthor(author, selectedAuthor) {\n        if (author == null && selectedAuthor == null) {\n            return true;\n        } else if (notEmptyLength(author) && notEmptyLength(selectedAuthor)) {\n            return _.isEqual(author, selectedAuthor);\n        } else {\n            return false;\n        }\n    }\n\n    function languageExisted(lang) {\n        if (lang != null) {\n            if (notEmptyLength(selectedAuthor)) {\n                return _.includes(selectedAuthor.language, lang)\n            } else {\n                let langs = [];\n                _.forEach(authorList, function (item) {\n                    langs = _.union(langs, item.language);\n                })\n\n                return _.includes(langs, lang)\n            }\n        } else {\n            return false;\n        }\n    }\n\n    function languageCount(author) {\n        let langs = [];\n        if (notEmptyLength(author)) {\n            return notEmptyLength(author.language) ? author.language.length : 0;\n        } else {\n            _.forEach(authorList, function (item) {\n                langs = _.union(langs, item.language);\n            })\n        }\n        return langs.length;\n    }\n\n    const _renderAuthorList = (data) => {\n\n        if (notEmptyLength(data)) {\n            let allIconHtml = (\n                <div key='authorList' className={!isSelectedAuthor(null, selectedAuthor) ? \"padding-md flex-justify-center flex-items-align-center\" : \"padding-md flex-justify-center flex-items-align-center border-selected-yellow thin-border\"}>\n                    <Tooltip title=\"All\" placement=\"right\">\n                        <a onClick={() => { setFilterGroup({ ...filterGroup, authorId: null, language: null }); setSelectedAuthor(null); }}>\n                            <span className='d-inline-block avatar background-grey-lighten-2 overflow-hidden relative-wrapper' style={{ width : 50, height : 50 }} >\n                              <img src={allIcon} className=\"width-50 height-50 absolute-center\" />\n                            </span>\n                        </a>\n                    </Tooltip>\n                </div>\n            );\n\n            let list = data.map(function (item, i) {\n                return (\n                    <div key={'alistData' + i} className={!isSelectedAuthor(item, selectedAuthor) ? \"padding-md flex-justify-center flex-items-align-center\" : \"padding-md flex-justify-center flex-items-align-center border-selected-yellow thin-border\"}>\n                        <Tooltip title={item.name ? item.name : null} placement=\"right\">\n                            <a onClick={() => { setFilterGroup({ ...filterGroup, authorId: item._id, language: languageCount(item) > 1 ? null : item.language[0] }); setSelectedAuthor(item); }}>\n                                <Avatar size={50} src={item.thumbnailUrl ? item.thumbnailUrl : null} icon={item.thumbnailUrl ? null : 'user'} />\n                            </a>\n                        </Tooltip>\n                    </div>\n\n                );\n\n            });\n\n            list.unshift(allIconHtml);\n            return (\n                <Loading spinning={authorLoading}>\n                    {list}\n                </Loading>\n            );\n        } else {\n            return null;\n        }\n\n    }\n\n    const renderContent = (data) => {\n        switch (data.language) {\n            case \"en\":\n                return (\n                    data.content ? data.content : null\n                )\n            case \"cn\":\n                return (\n                    data.content ? data.content2 : null\n                )\n            case 'my':\n                return (\n                    data.content3 ? data.content3 : null\n                )\n            default:\n                break;\n        }\n    }\n\n    const _renderNewsList = (data) => {\n        if (notEmptyLength(data)) {\n            return (\n                    <Row gutter={[10, 10]}>\n                         <div key='newsList' className=\"d-flex scroller-type\" style={{overflow:'scroll' }}>\n                        {data.map(function (item, i) {\n                                return (\n                                    <Col key={item._id} xs={18} sm={18} md={18} lg={18} xl={18}>\n                                        <div className=\"box-shadow-thin round-border wrap\" style={{height:'300px'}}>\n                                        <a style={{color:'#000000'}} href={item.originalUrl} >\n                                            <div className=\"inews\">\n                                                <img src={item.thumbnailUrl} style={{ width: \"100%\", height:'150px' }} />\n                                            </div>\n                                            <div className=\"ftitle\">\n                                                <h4>{item.title}</h4>\n                                                <p>\n                                                    {renderContent(item)}\n                                                </p>\n                                                <span style={{ textTransform: 'capitalize' }}>\n                                                    {item.authorId ? item.authorId.name : null} | {moment(item.publishedAt).format('DD-MM-YYYY')}\n                                                </span>\n                                            </div>\n                                        </a>\n                                        </div> \n                                    </Col>\n                                )\n                            })\n                        }\n                        </div>\n                    </Row>\n            )\n        } else {\n            return null;\n        }\n    }\n\n\n    return (\n\n        <React.Fragment>\n            <div className=\"padding-x-xs\" style={{touchAction:'pan-y'}}>\n                {_renderNewsList(newslist)}\n            </div>\n        </React.Fragment>\n\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    newCars: state.newCars,\n});\n\nconst mapDispatchToProps = {\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(SocialNewTabs)));"]},"metadata":{},"sourceType":"module"}