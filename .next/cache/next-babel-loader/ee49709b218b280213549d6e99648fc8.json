{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Form } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport ShowMoreText from 'react-show-more-text';\nimport { parseTagStringToArray } from '../carFreak/config';\nimport { withRouter } from 'next/router';\nimport client from '../../feathers';\nvar timeoutFunc;\n\nvar ParseTag = function ParseTag(props) {\n  _s();\n\n  var _useState = useState(''),\n      text = _useState[0],\n      setText = _useState[1];\n\n  useEffect(function () {\n    if (_.isString(props.data)) {\n      parseText(props.data);\n    } else {\n      setText(props.data);\n    }\n  }, [props.data]);\n\n  function parseText(_x) {\n    return _parseText.apply(this, arguments);\n  }\n\n  function _parseText() {\n    _parseText = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var userIds, users, textArr, userRes;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              userIds = [];\n              users = [];\n\n              if (!_.isString(data)) {\n                _context.next = 13;\n                break;\n              }\n\n              textArr = parseTagStringToArray(data || '') || [];\n\n              _.forEach(textArr, function (v) {\n                if (v.type == 'tag') {\n                  userIds.push(v.id);\n                }\n              });\n\n              if (!(_.isArray(userIds) && !_.isEmpty(userIds))) {\n                _context.next = 10;\n                break;\n              }\n\n              _context.next = 8;\n              return client.service('users').find({\n                query: {\n                  _id: {\n                    $in: userIds || []\n                  }\n                }\n              });\n\n            case 8:\n              userRes = _context.sent;\n              users = _.get(userRes, 'data') || [];\n\n            case 10:\n              setText(_.map(textArr, function (v, i) {\n                if (v.type == 'tag') {\n                  var user = _.find(users, function (user) {\n                    return user._id == v.id;\n                  });\n\n                  if (_.get(user, ['userurlId'])) {\n                    return __jsx(\"a\", {\n                      key: 'ccartag' + i,\n                      className: \"\".concat(props.tagClassName || 'font-weight-bold blue', \" cursor-pointer\"),\n                      href: \"/profile/\".concat(user.userurlId),\n                      target: \"_blank\"\n                    }, v.value);\n                  }\n                }\n\n                if (v.type == 'hashTag') {\n                  return __jsx(\"a\", {\n                    key: 'ccarhashtag' + i,\n                    className: \"\".concat(props.tagClassName || 'font-weight-bold black', \" cursor-pointer\"),\n                    href: v.id ? \"/hashtag/\".concat((v.value || '').replace('#', '')) : '#',\n                    target: \"_blank\"\n                  }, v.value);\n                }\n\n                return v.value;\n              }));\n              _context.next = 14;\n              break;\n\n            case 13:\n              setText(data);\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _parseText.apply(this, arguments);\n  }\n\n  return __jsx(\"span\", {\n    className: \"text-overflow-break d-inline-block \".concat(props.className || ''),\n    style: _objectSpread({\n      maxWidth: '100%'\n    }, props.style)\n  }, props.expandable ? __jsx(ShowMoreText, {\n    lines: props.lines || 1,\n    more: props.more || __jsx(\"a\", {\n      className: \"small-text\"\n    }, \"Show More\"),\n    less: props.less || __jsx(\"a\", {\n      className: \"small-text\"\n    }, \"Show Less\"),\n    expanded: false\n  }, text || '') : text || '');\n};\n\n_s(ParseTag, \"4ujWDM02ns4tez/JXYjL1bw6ipA=\");\n\n_c = ParseTag;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user\n  };\n};\n\nvar mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(ParseTag)));\n\nvar _c;\n\n$RefreshReg$(_c, \"ParseTag\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/general/ParseTag.jsx"],"names":["Form","_","React","useEffect","useState","connect","ShowMoreText","parseTagStringToArray","withRouter","client","timeoutFunc","ParseTag","props","text","setText","isString","data","parseText","userIds","users","textArr","forEach","v","type","push","id","isArray","isEmpty","service","find","query","_id","$in","userRes","get","map","i","user","tagClassName","userurlId","value","replace","className","maxWidth","style","expandable","lines","more","less","mapStateToProps","state","app","mapDispatchToProps","create"],"mappings":"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","sourcesContent":["import { Form } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport ShowMoreText from 'react-show-more-text';\nimport { parseTagStringToArray } from '../carFreak/config';\nimport { withRouter } from 'next/router';\nimport client from '../../feathers';\n\n\nlet timeoutFunc;\n\nconst ParseTag = (props) => {\n\n    const [text, setText] = useState('');\n\n    useEffect(() => {\n\n        if (_.isString(props.data)) {\n            parseText(props.data)\n        } else {\n            setText(props.data)\n        }\n\n    }, [props.data])\n\n\n    async function parseText(data) {\n        let userIds = [];\n        let users = [];\n        if (_.isString(data)) {\n\n            let textArr = parseTagStringToArray(data || '') || [];\n            _.forEach(textArr, function (v) {\n                if (v.type == 'tag') {\n                    userIds.push(v.id)\n                }\n            })\n\n            if (_.isArray(userIds) && !_.isEmpty(userIds)) {\n                let userRes = await client.service('users').find({\n                    query: {\n                        _id: {\n                            $in: userIds || [],\n                        }\n                    }\n                })\n\n                users = _.get(userRes, 'data') || [];\n            }\n\n\n            setText(_.map(textArr, function (v, i) {\n\n                if (v.type == 'tag') {\n                    let user = _.find(users, function (user) {\n                        return user._id == v.id;\n                    })\n                    if (_.get(user, ['userurlId'])) {\n                        return <a key={'ccartag' + i} className={`${props.tagClassName || 'font-weight-bold blue'} cursor-pointer`} href={`/profile/${user.userurlId}`} target=\"_blank\">\n                            {v.value}\n                        </a>\n                    }\n                }\n                if (v.type == 'hashTag') {\n                    return <a key={'ccarhashtag' + i} className={`${props.tagClassName || 'font-weight-bold black'} cursor-pointer`} href={v.id ? `/hashtag/${(v.value || '').replace('#', '')}` : '#'} target=\"_blank\">\n                        {v.value}\n                    </a>\n                }\n                return v.value;\n            }))\n        } else {\n            setText(data)\n        }\n    }\n\n\n    return (\n        <span className={`text-overflow-break d-inline-block ${props.className || ''}`} style={{ maxWidth: '100%', ...props.style }}>\n            {\n                props.expandable ?\n                    <ShowMoreText\n                        lines={props.lines || 1}\n                        more={props.more || <a className=\"small-text\">Show More</a>}\n                        less={props.less || <a className=\"small-text\">Show Less</a>}\n                        expanded={false}\n                    >\n                        {\n                            text || ''\n                        }\n                    </ShowMoreText>\n                    :\n                    text || ''\n            }\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\n\nconst mapDispatchToProps = {\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(ParseTag)));"]},"metadata":{},"sourceType":"module"}