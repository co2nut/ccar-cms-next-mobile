{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Button, Form, Input, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport client from '../../feathers';\n\nvar ReportButton = function ReportButton(props) {\n  _s();\n\n  var form = props.form;\n  var getFieldDecorator = form.getFieldDecorator;\n\n  var _useState = useState([]),\n      report = _useState[0],\n      setReport = _useState[1];\n\n  var _useState2 = useState(false),\n      visible = _useState2[0],\n      setVisible = _useState2[1];\n\n  var _useState3 = useState(false),\n      isReported = _useState3[0],\n      setIsReported = _useState3[1];\n\n  var _useState4 = useState(),\n      type = _useState4[0],\n      setType = _useState4[1];\n\n  useEffect(function () {\n    getReport();\n  }, [props.reporterId, type, props[type + 'Id']]);\n  useEffect(function () {\n    if (props.type) {\n      setType(props.type);\n    } else {\n      setType('');\n    }\n  }, [props.type]);\n  useEffect(function () {\n    setIsReported(_.isPlainObject(report) && !_.isEmpty(report));\n  }, [report]);\n\n  function getReport() {\n    if (props.reporterId && props[type + 'Id'] && type) {\n      var query = {\n        $limit: 1\n      };\n      query[type + 'Id'] = props[type + 'Id'];\n      query.type = type;\n      query.reporterId = props.reporterId;\n      client.service('report').find({\n        query: query\n      }).then(function (res) {\n        setReport(_.isArray(res.data) && !_.isEmpty(res.data) ? res.data[0] : {});\n        setIsReported(_.isArray(res.data) && !_.isEmpty(res.data) ? _.isPlainObject(res.data[0]) && !_.isEmpty(res.data[0]) : false);\n      })[\"catch\"](function (err) {\n        message.error(err.message);\n      });\n    }\n  }\n\n  function handleSuccess(success) {\n    setVisible(false);\n\n    if (props.handleSuccess) {\n      props.handleSuccess(success);\n    }\n  }\n\n  function handleError(error) {\n    setVisible(false);\n\n    if (props.handleError) {\n      props.handleError(error);\n    }\n  }\n\n  function handleSubmit() {\n    if (!_.get(props.user, ['authenticated']) || !_.get(props.user, ['info', 'user', '_id'])) {\n      message.error('Please Login First!');\n      props.loginMode(true);\n      return;\n    }\n\n    switch (type) {\n      case 'chat':\n        break;\n\n      case 'user':\n        break;\n\n      case 'message':\n        break;\n\n      default:\n        message.error('Invalid type');\n        return;\n        break;\n    }\n\n    if (!props[type + 'Id']) {\n      message.error('Content Not Found');\n      return;\n    }\n\n    if (!props.reporterId) {\n      message.error('Reporter Not Found');\n      return;\n    }\n\n    form.validateFields(function (err, values) {\n      if (!err) {\n        var promises = [];\n        promises.push(client.authenticate());\n\n        if (!isReported) {\n          var data = {};\n          data.type = type;\n          data.reporterId = props.reporterId;\n          data[type + 'Id'] = props[type + 'Id']; //For Activity Logs;\n\n          data.actionType = 'createReport';\n          promises.push(client.service('report').create(_objectSpread(_objectSpread({}, data), values)));\n        } else {\n          promises.push(client.service('report').remove(report._id));\n        }\n\n        props.loading(true); //Write in report model\n\n        Promise.all(promises).then(function (_ref) {\n          var _ref2 = _slicedToArray(_ref, 2),\n              auth = _ref2[0],\n              res = _ref2[1];\n\n          props.loading(false);\n          handleSuccess({\n            type: isReported ? 'cancel' : 'reported',\n            data: res\n          });\n          setReport(isReported ? {} : res);\n          setVisible(false);\n        })[\"catch\"](function (error) {\n          props.loading(false);\n          setVisible(false);\n          handleError({\n            message: \"Report Failed\"\n          });\n        });\n      }\n    });\n  }\n\n  ;\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: visible,\n    title: \"Report Form\",\n    maskClosable: true,\n    centered: true,\n    onOk: function onOk(e) {\n      handleSubmit();\n    },\n    okText: \"Submit\",\n    onCancel: function onCancel(e) {\n      setVisible(false);\n    }\n  }, __jsx(Form, {\n    layout: \"vertical\"\n  }, __jsx(Form.Item, null, getFieldDecorator('title', {\n    rules: [{\n      required: true,\n      message: 'Please input title.'\n    }]\n  })(__jsx(Input, {\n    placeholder: \"Title(max 200)\",\n    maxLength: 200\n  }))), __jsx(Form.Item, null, getFieldDecorator('description', {\n    rules: [{\n      required: true,\n      message: 'Please input description.'\n    }]\n  })(__jsx(Input.TextArea, {\n    autoSize: {\n      minRows: 6,\n      maxRows: 6\n    },\n    showCount: true,\n    placeholder: \"Description(max 900)\",\n    maxLength: 900\n  }))))), __jsx(\"span\", {\n    onClick: function onClick() {\n      setVisible(true);\n    }\n  }, isReported ? props.cancelButton ? props.cancelButton() : __jsx(Button, {\n    type: \"danger\",\n    icon: \"flag\"\n  }, \"Report\") : props.reportButton ? props.reportButton() : __jsx(Button, {\n    type: \"danger\",\n    icon: \"flag\",\n    disabled: true\n  }, \"Reported\")));\n};\n\n_s(ReportButton, \"RCnXHUKz8QhwxFhBH8qisDhEKwU=\");\n\n_c = ReportButton;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user\n  };\n};\n\nvar mapDispatchToProps = {\n  loginMode: loginMode,\n  loading: loading\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(ReportButton)));\n\nvar _c;\n\n$RefreshReg$(_c, \"ReportButton\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/general/ReportButton.jsx"],"names":["Button","Form","Input","message","Modal","_","React","useEffect","useState","connect","withRouter","loading","loginMode","client","ReportButton","props","form","getFieldDecorator","report","setReport","visible","setVisible","isReported","setIsReported","type","setType","getReport","reporterId","isPlainObject","isEmpty","query","$limit","service","find","then","res","isArray","data","err","error","handleSuccess","success","handleError","handleSubmit","get","user","validateFields","values","promises","push","authenticate","actionType","create","remove","_id","Promise","all","auth","className","style","e","rules","required","minRows","maxRows","cancelButton","reportButton","mapStateToProps","state","app","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { Button, Form, Input, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport client from '../../feathers';\n\n\nconst ReportButton = (props) => {\n\n\n    const { form } = props;\n    const { getFieldDecorator } = form;\n    const [report, setReport] = useState([]);\n    const [visible, setVisible] = useState(false);\n    const [isReported, setIsReported] = useState(false);\n    const [type, setType] = useState();\n\n    useEffect(() => {\n        getReport();\n    }, [props.reporterId, type, props[type + 'Id']])\n\n    useEffect(() => {\n        if (props.type) {\n            setType(props.type);\n        } else {\n            setType('');\n        }\n    }, [props.type])\n\n    useEffect(() => {\n        setIsReported(_.isPlainObject(report) && !_.isEmpty(report))\n    }, [report])\n\n    function getReport() {\n        if (props.reporterId && props[type + 'Id'] && type) {\n            let query = {\n                $limit: 1,\n            };\n            query[type + 'Id'] = props[type + 'Id'];\n            query.type = type;\n            query.reporterId = props.reporterId\n\n            client.service('report').find({\n                query: query\n            }).then(res => {\n                setReport(_.isArray(res.data) && !_.isEmpty(res.data) ? res.data[0] : {});\n                setIsReported(_.isArray(res.data) && !_.isEmpty(res.data) ? _.isPlainObject(res.data[0]) && !_.isEmpty(res.data[0]) : false);\n            }).catch(err => {\n                message.error(err.message)\n            });\n        }\n    }\n\n    function handleSuccess(success) {\n        setVisible(false);\n        if (props.handleSuccess) {\n            props.handleSuccess(success);\n        }\n    }\n\n\n    function handleError(error) {\n        setVisible(false);\n        if (props.handleError) {\n            props.handleError(error);\n        }\n    }\n\n    function handleSubmit() {\n\n        if (!_.get(props.user, ['authenticated']) || !_.get(props.user, ['info', 'user', '_id'])) {\n            message.error('Please Login First!');\n            props.loginMode(true);\n            return;\n        }\n\n        switch (type) {\n            case 'chat':\n                break;\n            case 'user':\n                break;\n            case 'message':\n                break;\n            default:\n                message.error('Invalid type');\n                return;\n                break;\n        }\n\n\n        if (!props[type + 'Id']) {\n            message.error('Content Not Found');\n            return;\n        }\n\n        if (!props.reporterId) {\n            message.error('Reporter Not Found');\n            return;\n        }\n\n\n        form.validateFields((err, values) => {\n\n            if (!err) {\n                let promises = [];\n                promises.push(client.authenticate());\n                if (!isReported) {\n                    let data = {}\n                    data.type = type;\n                    data.reporterId = props.reporterId;\n                    data[type + 'Id'] = props[type + 'Id'];\n\n                    //For Activity Logs;\n                    data.actionType = 'createReport';\n                    promises.push(client.service('report').create({ ...data, ...values }))\n                } else {\n                    promises.push(client.service('report').remove(report._id))\n                }\n\n                props.loading(true);\n                //Write in report model\n                Promise.all(promises).then(([auth, res]) => {\n                    props.loading(false);\n                    handleSuccess({\n                        type: isReported ? 'cancel' : 'reported',\n                        data: res\n                    });\n                    setReport(isReported ? {} : res);\n                    setVisible(false);\n\n                }).catch(error => {\n                    props.loading(false);\n                    setVisible(false);\n                    handleError({ message: \"Report Failed\" })\n                })\n            }\n        });\n\n\n    };\n\n\n\n    return (\n\n        <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n            <Modal\n                visible={visible}\n                title=\"Report Form\"\n                maskClosable={true}\n                centered={true}\n                onOk={(e) => { handleSubmit(); }}\n                okText=\"Submit\"\n                onCancel={(e) => { setVisible(false) }}\n            >\n\n                <Form layout=\"vertical\">\n                    <Form.Item>\n                        {getFieldDecorator('title', {\n                            rules: [{ required: true, message: 'Please input title.' }],\n                        })(\n                            <Input placeholder=\"Title(max 200)\" maxLength={200}\n                            />\n                        )}\n                    </Form.Item>\n                    <Form.Item>\n                        {getFieldDecorator('description', {\n                            rules: [{ required: true, message: 'Please input description.' }],\n                        })(\n                            <Input.TextArea autoSize={{ minRows: 6, maxRows: 6 }} showCount placeholder=\"Description(max 900)\" maxLength={900}\n                            />\n                        )}\n                    </Form.Item>\n                </Form>\n            </Modal>\n\n            <span onClick={() => { setVisible(true) }}>\n                {\n                    isReported ?\n                        props.cancelButton ?\n                            props.cancelButton()\n                            :\n                            <Button type=\"danger\" icon=\"flag\">\n                                Report\n                            </Button>\n                        :\n                        props.reportButton ?\n                            props.reportButton()\n                            :\n                            <Button type=\"danger\" icon=\"flag\" disabled>\n                                Reported\n                            </Button>\n                }\n            </span>\n\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\n\nconst mapDispatchToProps = {\n    loginMode: loginMode,\n    loading: loading,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(ReportButton)));"]},"metadata":{},"sourceType":"module"}