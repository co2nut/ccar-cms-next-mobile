{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Avatar, Button, Col, Form, Icon, Input, message, Modal, Rate, Row, Select, Tooltip, Upload } from 'antd';\nimport axios from 'axios';\nimport FormData from 'form-data';\nimport _ from 'lodash';\nimport { withRouter } from 'next/router';\nimport QueueAnim from 'rc-queue-anim';\nimport React, { useEffect, useState } from 'react';\nimport Highlighter from 'react-highlight-words';\nimport ScrollContainer from 'react-indiana-drag-scroll';\nimport ReactPlayer from 'react-player';\nimport { connect } from 'react-redux';\nimport { v4 as uuidv4 } from 'uuid';\nimport { isValidNumber, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { getStateIcon, StateList } from '../../params/stateList';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nvar TextArea = Input.TextArea;\n\nvar moment = require('moment');\n\nvar FORM_CONTAINER_SIZE = 500;\nvar IMAGELIMIT = 7;\nvar VIDEOLIMIT = 1;\n\nvar WriteReviewButton = function WriteReviewButton(props) {\n  _s();\n\n  var _useState = useState(false),\n      visible = _useState[0],\n      setVisible = _useState[1];\n\n  var _useState2 = useState(\"Add Post\"),\n      title = _useState2[0],\n      setTitle = _useState2[1];\n\n  var _useState3 = useState(true),\n      run = _useState3[0],\n      setRun = _useState3[1];\n\n  var _useState4 = useState(),\n      timeoutFunction = _useState4[0],\n      setTimeoutFunction = _useState4[1];\n\n  var _useState5 = useState('image'),\n      previewType = _useState5[0],\n      setPreviewType = _useState5[1];\n\n  var _useState6 = useState(false),\n      previewVisible = _useState6[0],\n      setPreviewVisible = _useState6[1];\n\n  var _useState7 = useState({}),\n      previewImage = _useState7[0],\n      setPreviewImage = _useState7[1];\n\n  var _useState8 = useState({}),\n      previewVideo = _useState8[0],\n      setPreviewVideo = _useState8[1];\n\n  var _props$form = props.form,\n      getFieldDecorator = _props$form.getFieldDecorator,\n      getFieldsError = _props$form.getFieldsError,\n      getFieldError = _props$form.getFieldError,\n      isFieldTouched = _props$form.isFieldTouched,\n      isFieldValidating = _props$form.isFieldValidating;\n\n  var _useState9 = useState('add'),\n      view = _useState9[0],\n      setView = _useState9[1];\n\n  var _useState10 = useState({\n    rating: null,\n    title: null,\n    comment: null,\n    type: null,\n    productId: null,\n    userId: null,\n    reviewerId: null,\n    companyId: null,\n    carspecId: null,\n    images: [],\n    videos: [],\n    state: null\n  }),\n      reviewForm = _useState10[0],\n      setReviewForm = _useState10[1];\n\n  var _useState11 = useState([]),\n      filteredState = _useState11[0],\n      setFilteredState = _useState11[1];\n\n  var _useState12 = useState([]),\n      searchStateWords = _useState12[0],\n      setSearchStateWords = _useState12[1];\n\n  var _useState13 = useState([]),\n      origImages = _useState13[0],\n      setOrigImages = _useState13[1];\n\n  var _useState14 = useState([]),\n      origVideos = _useState14[0],\n      setOrigVideos = _useState14[1];\n\n  var _useState15 = useState({}),\n      writer = _useState15[0],\n      setWriter = _useState15[1];\n\n  var _useState16 = useState('add'),\n      mode = _useState16[0],\n      setMode = _useState16[1];\n\n  var _useState17 = useState(false),\n      buttonLoading = _useState17[0],\n      setButtonLoading = _useState17[1]; // Only show error after a field is touched.\n\n\n  var ratingError = (isFieldTouched('rating') || !isFieldValidating('rating')) && getFieldError('rating');\n  var commentError = (isFieldTouched('comment') || !isFieldValidating('comment')) && getFieldError('comment');\n  var titleError = (isFieldTouched('title') || !isFieldValidating('title')) && getFieldError('title');\n  var selectionError = (isFieldTouched('selection') || !isFieldValidating('selection')) && getFieldError('selection');\n  useEffect(function () {\n    if (props.mode) {\n      if (props.mode == 'edit') {\n        setMode('edit');\n      } else {\n        setMode('add');\n      }\n    }\n  }, [props.mode]);\n  useEffect(function () {\n    props.form.setFieldsValue(reviewForm);\n\n    switch (view) {\n      case 'edit':\n        setTitle('Edit Post');\n        break;\n\n      case 'add':\n        setTitle('Add Post');\n        break;\n\n      case 'state':\n        setTitle(__jsx(React.Fragment, null, __jsx(\"span\", {\n          className: \"margin-right-sm \"\n        }, __jsx(\"a\", {\n          onClick: function onClick() {\n            setView(props.mode == \"edit\" ? \"edit\" : \"add\");\n          },\n          className: \"black\"\n        }, __jsx(Icon, {\n          type: \"left\"\n        }))), __jsx(\"span\", {\n          className: \"margin-x-sm\"\n        }, \"Select State\")));\n        filterState(null);\n        break;\n\n      default:\n        setTitle('Add Post');\n        break;\n    }\n  }, [view]);\n  useEffect(function () {\n    if (props.mode == 'edit') {\n      setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n        _id: props.data._id,\n        rating: props.data.rating ? props.data.rating : null,\n        title: props.data.title ? props.data.title : null,\n        comment: props.data.comment ? props.data.comment : null,\n        state: props.data.state ? props.data.state : null,\n        type: props.data.type ? props.data.type : null,\n        userId: props.data.userId ? props.data.userId : null,\n        reviewerId: props.data.reviewerId ? props.data.reviewerId : null,\n        companyId: props.data.companyId ? props.data.companyId : null,\n        productId: props.data.productId ? props.data.productId : null,\n        carspecId: props.data.carspecId ? props.data.carspecId : null,\n        createdAt: props.data.createdAt ? props.data.createdAt : null,\n        images: props.data.images ? props.data.images : [],\n        videos: props.data.videos ? props.data.videos : []\n      }));\n      setOrigImages(props.data.images ? props.data.images : []);\n      setOrigVideos(props.data.videos ? props.data.videos : []);\n    } else {\n      setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n        rating: null,\n        comment: null,\n        title: null,\n        state: null,\n        type: props.data.type ? props.data.type : null,\n        userId: props.data.userId ? props.data.userId : null,\n        reviewerId: props.data.reviewerId ? props.data.reviewerId : null,\n        companyId: props.data.companyId ? props.data.companyId : null,\n        productId: props.data.productId ? props.data.productId : null,\n        carspecId: props.data.carspecId ? props.data.carspecId : null,\n        images: props.data.images ? props.data.images : [],\n        videos: props.data.videos ? props.data.videos : []\n      }));\n      setOrigImages([]);\n      setOrigVideos([]);\n    }\n  }, [props.data]);\n  useEffect(function () {\n    var form = _.cloneDeep(reviewForm);\n\n    form.selection = reviewForm[reviewForm.type + 'Id'];\n\n    if (visible && props.data.reviewerId) {\n      props.form.setFieldsValue({\n        selection: form.selection\n      });\n    }\n  }, [reviewForm]);\n  useEffect(function () {\n    if (run) {\n      setRun(false); //only run every 2 seconds\n\n      setTimeout(function () {\n        setRun(true);\n      }, 2000);\n\n      if (visible && !props.data.reviewerId) {\n        props.loginMode(true);\n        handleError({\n          message: 'Please login to write review'\n        });\n      }\n\n      if (mode == 'add') {\n        if (visible && !props.data[props.data.type + 'Id'] && !notEmptyLength(props.selection)) {\n          handleError({\n            message: 'Item not Found'\n          });\n        }\n      }\n    }\n  });\n  useEffect(function () {\n    setView(mode == 'edit' ? 'edit' : 'add');\n  }, [mode]);\n  useEffect(function () {\n    if (reviewForm.reviewerId) {\n      props.loading(true);\n      client.authenticate().then(function (res) {\n        props.loading(false);\n        client.service('users').get(reviewForm.reviewerId).then(function (res) {\n          if (res) {\n            setWriter(res);\n          } else {\n            setWriter({});\n          }\n        });\n      })[\"catch\"](function (err) {\n        props.loading(false);\n        setButtonLoading(false);\n        handleError({\n          message: 'Error on getting user.'\n        });\n      });\n    } else {\n      setWriter({});\n    }\n  }, [reviewForm.reviewerId]);\n\n  function handleCancel() {\n    setPreviewVisible(false);\n  }\n\n  function getBase64(file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = function () {\n        return resolve(reader.result);\n      };\n\n      reader.onerror = function (error) {\n        return reject(error);\n      };\n    });\n  }\n\n  function handlePreview(_x, _x2) {\n    return _handlePreview.apply(this, arguments);\n  }\n\n  function _handlePreview() {\n    _handlePreview = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(file, type) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (type == 'video') {\n                setPreviewType('video');\n                setPreviewVisible(true);\n                setPreviewVideo({\n                  url: file.url,\n                  name: file.name\n                });\n              } else {\n                setPreviewType('image');\n                setPreviewVisible(true);\n                setPreviewImage({\n                  url: file.url,\n                  name: file.name\n                });\n              }\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _handlePreview.apply(this, arguments);\n  }\n\n  function handleDelete(file, type) {\n    if (!file || !file._id) {\n      //handle Error\n      message.error(type == 'video' ? \"Video not found.\" : 'Image not found.');\n    } else {\n      if (type == 'video') {\n        var data = _.filter(reviewForm.videos, function (item) {\n          return item._id != file._id;\n        });\n\n        if (notEmptyLength(data)) {\n          setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n            videos: data\n          }));\n        } else {\n          setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n            videos: []\n          }));\n        }\n      } else {\n        var _data = _.filter(reviewForm.images, function (item) {\n          return item._id != file._id;\n        });\n\n        if (notEmptyLength(_data)) {\n          setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n            images: _data\n          }));\n        } else {\n          setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n            images: []\n          }));\n        }\n      }\n    }\n  }\n\n  function handleSuccess(success) {\n    setVisible(false);\n\n    if (props.handleSuccess) {\n      props.handleSuccess(success);\n    }\n  }\n\n  function handleError(error) {\n    setVisible(false);\n\n    if (props.handleError) {\n      props.handleError(error);\n    }\n  }\n\n  function timeout(func, time) {\n    if (!isValidNumber(time)) {\n      time = 500;\n    }\n\n    clearTimeout(timeoutFunction);\n    setTimeoutFunction(setTimeout(function () {\n      return func;\n    }, parseInt(time)));\n  }\n\n  function filterState(v) {\n    if (v) {\n      var regex = new RegExp(\"^.*\".concat(v, \".*$\"), 'i');\n      setFilteredState(StateList.filter(function (state) {\n        return regex.test(state.value);\n      }));\n      setSearchStateWords([v]);\n    } else {\n      setSearchStateWords([]);\n      setFilteredState(StateList);\n    }\n  }\n\n  function reset() {\n    setView(mode == \"edit\" ? \"edit\" : \"add\");\n    props.form.resetFields();\n    setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n      images: origImages,\n      videos: origVideos,\n      state: props.data.state ? props.data.state : null\n    }));\n    setButtonLoading(false);\n  }\n\n  function reviewModalVisible() {\n    if (props.data.reviewerId) {\n      setVisible(true);\n    } else {\n      props.loginMode(true);\n      handleError({\n        message: 'Please login to write review'\n      });\n    }\n  }\n\n  function onChangeImage(fileList) {\n    if (notEmptyLength(fileList)) {\n      if (fileList.length > IMAGELIMIT) {\n        fileList = fileList.slice(0, IMAGELIMIT);\n      }\n\n      var data = fileList.map(function (file) {\n        if (file.originFileObj) {\n          getBase64(file.originFileObj).then(function (res) {\n            file.url = res;\n          });\n          file._id = file.uid;\n        }\n\n        return file;\n      });\n      data = _.union(data, reviewForm.images);\n      setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n        images: data\n      }));\n    }\n  }\n\n  function onChangeVideo(fileList) {\n    if (notEmptyLength(fileList)) {\n      if (fileList.length > VIDEOLIMIT) {\n        fileList = fileList.slice(0, VIDEOLIMIT);\n      }\n\n      var data = fileList.map(function (file) {\n        if (file.originFileObj) {\n          getBase64(file.originFileObj).then(function (res) {\n            file.url = res;\n          });\n          file._id = file.uid;\n        }\n\n        return file;\n      });\n      data = _.union(data, reviewForm.videos);\n      setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n        videos: data\n      }));\n    }\n  }\n\n  function hasErrors(fieldsError) {\n    return Object.keys(fieldsError).some(function (field) {\n      return fieldsError[field];\n    });\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    setButtonLoading(true);\n    props.form.validateFields(function (err, values) {\n      if (!err) {\n        var insertImages = [];\n        var removeImages = [];\n        var insertVideos = [];\n        var removeVideos = [];\n\n        var finalData = _.cloneDeep(reviewForm);\n\n        var images = _.cloneDeep(reviewForm.images);\n\n        var videos = _.cloneDeep(reviewForm.videos);\n\n        var promises = []; //get new upload images\n\n        if (notEmptyLength(images)) {\n          insertImages = insertImages.concat(images.filter(function (image) {\n            return _.has(image, \"originFileObj\");\n          }));\n\n          if (insertImages.length > 0) {\n            var formData = new FormData();\n\n            for (var i = 0; i < insertImages.length; i++) {\n              var fileName = uuidv4() + \"-\" + insertImages[i].name.split('.').join(\"-\") + \"-\" + new Date().getTime();\n              formData.append('images', insertImages[i].originFileObj, fileName);\n            } //Upload Image\n\n\n            promises.push(axios.post(\"\".concat(client.io.io.uri, \"upload-images-array\"), formData, {\n              headers: {\n                'Authorization': client.settings.storage.storage.storage['feathers-jwt'],\n                'Content-Type': 'multipart/form-data'\n              }\n            }));\n          }\n        } //get new upload videos\n\n\n        if (notEmptyLength(videos)) {\n          insertVideos = insertVideos.concat(videos.filter(function (video) {\n            return _.has(video, \"originFileObj\");\n          }));\n\n          if (insertVideos.length > 0) {\n            var _formData = new FormData();\n\n            for (var _i = 0; _i < insertVideos.length; _i++) {\n              var fileName = uuidv4() + \"-\" + insertVideos[_i].name.split('.').join(\"-\") + \"-\" + new Date().getTime();\n\n              _formData.append('videos', insertVideos[_i].originFileObj, fileName);\n            } //Upload Image\n\n\n            promises.push(axios.post(\"\".concat(client.io.io.uri, \"upload-videos-array\"), _formData, {\n              headers: {\n                'Authorization': client.settings.storage.storage.storage['feathers-jwt'],\n                'Content-Type': 'multipart/form-data'\n              }\n            }));\n          }\n        } //get removed images\n\n\n        if (mode == 'edit') {\n          var diffIds = _.map(_.differenceBy(origImages, images, '_id'), \"_id\");\n\n          removeImages = removeImages.concat(_.filter(origImages, function (image) {\n            return _.includes(diffIds, image._id);\n          }));\n          diffIds = _.map(_.differenceBy(origVideos, videos, '_id'), \"_id\");\n          removeVideos = removeVideos.concat(_.filter(origVideos, function (video) {\n            return _.includes(diffIds, video._id);\n          }));\n        }\n\n        props.loading(true); //Upload new images to server first\n\n        Promise.all(promises).then(function (responses) {\n          props.loading(false);\n\n          _.forEach(responses, function (res) {\n            if (res.config.url == \"\".concat(client.io.io.uri, \"upload-videos-array\")) {\n              if (notEmptyLength(res.data.result)) {\n                //Replace new upload videos with url\n                videos = videos.filter(function (video) {\n                  return !_.has(video, \"originFileObj\");\n                });\n                videos = videos.concat(res.data.result);\n                finalData.videos = videos;\n              }\n            } else {\n              if (notEmptyLength(res.data.result)) {\n                //Replace new upload images with url\n                images = images.filter(function (image) {\n                  return !_.has(image, \"originFileObj\");\n                });\n                images = images.concat(res.data.result);\n                finalData.images = images;\n              }\n            }\n          });\n\n          promises = [];\n          promises.push(client.authenticate());\n\n          if (mode == 'add') {\n            promises.push(client.service('rating').create(finalData));\n          } else {\n            promises.push(client.service('rating').patch(finalData._id, finalData));\n          } //Write in rating model\n\n\n          if (finalData[finalData.type + \"Id\"] != null) {\n            props.loading(true);\n            Promise.all(promises).then(function (_ref) {\n              var _ref2 = _slicedToArray(_ref, 2),\n                  auth = _ref2[0],\n                  reviewRes = _ref2[1];\n\n              props.loading(false);\n              message.success(mode == \"edit\" ? 'Edit Successful' : 'Create Successful');\n              handleSuccess(reviewRes);\n              setButtonLoading(false);\n              setOrigImages(reviewRes.images);\n              setOrigVideos(reviewRes.videos); //Remove useless images\n\n              if (notEmptyLength(removeImages)) {\n                axios.post(\"\".concat(client.io.io.uri, \"deleteImageS3\"), {\n                  params: {\n                    imageUrl: removeImages\n                  },\n                  headers: {\n                    'Content-Type': 'text/xml; charset=utf-8',\n                    'Content-Length': 'length'\n                  }\n                }).then(function (res) {});\n              } //Remove useless videos\n\n\n              if (notEmptyLength(removeVideos)) {\n                axios.post(\"\".concat(client.io.io.uri, \"deleteVideoS3\"), {\n                  params: {\n                    videoUrl: removeVideos\n                  },\n                  headers: {\n                    'Content-Type': 'text/xml; charset=utf-8',\n                    'Content-Length': 'length'\n                  }\n                });\n              }\n            });\n          }\n        })[\"catch\"](function (err) {\n          props.loading(false);\n          setButtonLoading(false);\n          console.log('err');\n          console.log(err);\n          message.error(err.message);\n        });\n      } else {\n        props.loading(false);\n        setButtonLoading(false);\n\n        _.map(err, function (err) {\n          return message.error(err.errors[0].message);\n        });\n      }\n    });\n  }\n\n  ;\n\n  var _renderImageCard = function _renderImageCard(data) {\n    if (notEmptyLength(data)) {\n      return data.map(function (item) {\n        return __jsx(\"span\", {\n          className: \"d-inline-block thin-border margin-right-xs margin-bottom-xs background-white flex-items-no-shrink\",\n          style: {\n            width: '70px',\n            height: '70px'\n          }\n        }, __jsx(\"div\", {\n          className: \"relative-wrapper fill-parent\"\n        }, __jsx(\"div\", {\n          className: \"absolute-center\"\n        }, __jsx(\"img\", {\n          src: item.url,\n          className: \"fill-parent\"\n        })), __jsx(\"div\", {\n          className: \"absolute-center background-grey-darken-4 stack-element-opacity-50 flex-items-align-center flex-justify-center\"\n        }, __jsx(\"a\", {\n          onClick: function onClick(e) {\n            handlePreview(item, 'image');\n          }\n        }, __jsx(Icon, {\n          type: \"eye\",\n          className: \"white margin-x-xs\",\n          style: {\n            fontSize: '20px'\n          }\n        })), __jsx(\"a\", {\n          onClick: function onClick(e) {\n            handleDelete(item, 'image');\n          }\n        }, __jsx(Icon, {\n          type: \"delete\",\n          className: \"white margin-x-xs\",\n          style: {\n            fontSize: '20px'\n          }\n        })))));\n      });\n    } else {\n      return null;\n    }\n  };\n\n  var _renderVideoCard = function _renderVideoCard(data) {\n    if (notEmptyLength(data)) {\n      return data.map(function (item) {\n        return __jsx(\"span\", {\n          className: \"d-inline-block thin-border margin-right-xs margin-bottom-xs background-white flex-items-no-shrink\",\n          style: {\n            width: '70px',\n            height: '70px'\n          }\n        }, __jsx(\"div\", {\n          className: \"relative-wrapper fill-parent\"\n        }, __jsx(\"div\", {\n          className: \"absolute-center\"\n        }, __jsx(ReactPlayer, {\n          width: \"100%\",\n          height: \"100%\",\n          url: item.url\n        })), __jsx(\"div\", {\n          className: \"absolute-center background-grey-darken-4 stack-element-opacity-50 flex-items-align-center flex-justify-center\"\n        }, __jsx(\"a\", {\n          onClick: function onClick(e) {\n            handlePreview(item, 'video');\n          }\n        }, __jsx(Icon, {\n          type: \"eye\",\n          className: \"white margin-x-xs\",\n          style: {\n            fontSize: '20px'\n          }\n        })), __jsx(\"a\", {\n          onClick: function onClick(e) {\n            handleDelete(item, 'video');\n          }\n        }, __jsx(Icon, {\n          type: \"delete\",\n          className: \"white margin-x-xs\",\n          style: {\n            fontSize: '20px'\n          }\n        })))));\n      });\n    } else {\n      return null;\n    }\n  };\n\n  var _renderSelection = function _renderSelection(data, text) {\n    if (notEmptyLength(data)) {\n      var idType = \"\".concat(reviewForm.type, \"Id\");\n      return __jsx(React.Fragment, null, __jsx(\"div\", {\n        className: \"headline  \"\n      }, text != null ? text : 'Please select item to review'), __jsx(Form.Item, {\n        required: false,\n        validateStatus: selectionError ? 'error' : '',\n        help: selectionError || '',\n        style: {\n          margin: 0\n        }\n      }, getFieldDecorator('selection', {\n        rules: [{\n          required: true,\n          message: 'Please pick 1 item to review!'\n        }],\n        initialValue: props.data[idType]\n      })(__jsx(Select, {\n        onChange: function onChange(v) {\n          var stateObj = _.cloneDeep(reviewForm);\n\n          stateObj[idType] = v;\n          setReviewForm(stateObj);\n        }\n      }, data.map(function (item) {\n        return __jsx(Select.Option, {\n          key: item._id,\n          value: item._id\n        }, item.name);\n      })))));\n    } else {\n      return null;\n    }\n  };\n\n  var _renderForm = function _renderForm() {\n    return __jsx(\"div\", {\n      key: \"form\"\n    }, __jsx(Form, {\n      onSubmit: handleSubmit\n    }, __jsx(\"div\", {\n      style: {\n        height: FORM_CONTAINER_SIZE * 0.15 + 'px'\n      },\n      className: \"scroll-y-wrapper padding-x-sm \"\n    }, __jsx(Form.Item, {\n      style: {\n        margin: 0\n      }\n    }, __jsx(Row, {\n      type: \"flex\",\n      align: \"top\"\n    }, __jsx(Col, {\n      span: 12\n    }, __jsx(\"div\", {\n      className: \"flex-items-align-start\"\n    }, __jsx(\"span\", {\n      className: \"d-inline-block margin-right-sm\"\n    }, __jsx(Avatar, {\n      size: 50,\n      src: writer.avatar ? writer.avatar : null,\n      icon: writer.avatar ? null : 'user'\n    })), __jsx(\"span\", {\n      className: \"d-inline-block flex-items-align-center\"\n    }, __jsx(\"span\", {\n      className: \"d-inline-block\"\n    }, writer.firstName ? writer.firstName : null, \" \", writer.lastName ? writer.lastName : null), reviewForm.state ? __jsx(\"span\", {\n      className: \"blue d-inline-block margin-right-sm flex-items-align-center padding-left-xs\"\n    }, \" \", reviewForm.state) : null))), __jsx(Col, {\n      span: 12\n    }, __jsx(\"div\", {\n      className: \"review2\"\n    }, __jsx(\"p\", null, reviewForm.createdAt ? moment(reviewForm.createdAt).format('D MMMM Y') : moment().format('D MMMM Y'))))))), __jsx(\"div\", {\n      style: {\n        height: FORM_CONTAINER_SIZE * 0.75 + 'px'\n      },\n      className: \"scroll-y-wrapper padding-x-sm\"\n    }, notEmptyLength(props.selection) ? _renderSelection(props.selection, props.selectionText) : null, _.isPlainObject(_.get(props.data, 'carspecId')) && !_.isEmpty(_.get(props.data, 'carspecId')) ? __jsx(\"div\", {\n      className: \"headline font-weight-bold\"\n    }, _.trim(\"\".concat(_.get(props.data, 'carspecId.make') || '', \" \").concat(_.get(props.data, 'carspecId.model') || '', \" \").concat(_.get(props.data, 'carspecId.variant') || ''))) : null, __jsx(\"div\", {\n      className: \"headline  \"\n    }, \"How awesome this?\"), __jsx(Form.Item, {\n      required: false,\n      validateStatus: ratingError ? 'error' : '',\n      help: ratingError || '',\n      style: {\n        margin: 0\n      }\n    }, getFieldDecorator('rating', {\n      rules: [{\n        required: true,\n        message: 'Please rate this store!'\n      }],\n      initialValue: !props.data || !props.data.rating ? null : props.data.rating\n    })(__jsx(Rate, {\n      allowHalf: true,\n      onChange: function onChange(v) {\n        setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n          rating: v\n        }));\n      }\n    }))), __jsx(Form.Item, {\n      required: false,\n      validateStatus: titleError ? 'error' : '',\n      help: titleError || '',\n      style: {\n        margin: 0\n      }\n    }, getFieldDecorator('title', {\n      initialValue: props.data ? props.data.title : null\n    })(__jsx(Input, {\n      placeholder: \"Title\",\n      maxLength: 300,\n      onChange: function onChange(e) {\n        setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n          title: e.target.value\n        }));\n      }\n    }))), __jsx(Form.Item, {\n      required: false,\n      validateStatus: commentError ? 'error' : '',\n      help: commentError || '',\n      style: {\n        margin: 0\n      }\n    }, getFieldDecorator('comment', {\n      initialValue: props.data ? props.data.comment : null\n    })(__jsx(TextArea, {\n      rows: 4,\n      maxLength: 1000,\n      placeholder: \"Write your review....\",\n      onChange: function onChange(e) {\n        setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n          comment: e.target.value\n        }));\n      }\n    }))), __jsx(Form.Item, {\n      style: {\n        margin: 0\n      }\n    }, __jsx(ScrollContainer, {\n      style: {\n        height: '70px',\n        width: \"100%\"\n      },\n      className: \"d-flex margin-y-sm\",\n      vertical: false\n    }, _renderVideoCard(reviewForm.videos), _renderImageCard(reviewForm.images))), __jsx(\"div\", {\n      className: \"margin-y-sm\"\n    }, __jsx(Form.Item, {\n      style: {\n        margin: 0\n      }\n    }, __jsx(Row, {\n      className: \"thin-border round-border padding-sm\",\n      gutter: [10, 20]\n    }, __jsx(Col, {\n      xs: 24,\n      sm: 24,\n      md: 12,\n      lg: 12,\n      xl: 12\n    }, __jsx(\"div\", {\n      className: \"fill-parent  headline   text-overflow-break\"\n    }, \" Add to your post\")), __jsx(Col, {\n      xs: 24,\n      sm: 24,\n      md: 12,\n      lg: 12,\n      xl: 12\n    }, __jsx(\"div\", {\n      className: \"fill-parent flex-justify-end flex-items-align-center flex-align-center text-overflow-break\"\n    }, __jsx(Upload, {\n      accept: \"image/*\",\n      onChange: function onChange(_ref3) {\n        var fileList = _ref3.fileList;\n        onChangeImage(fileList);\n      },\n      multiple: true,\n      fileList: reviewForm.images,\n      showUploadList: false,\n      beforeUpload: function beforeUpload(file) {\n        return false;\n      },\n      disabled: notEmptyLength(reviewForm.images) ? reviewForm.images.length >= IMAGELIMIT : false\n    }, __jsx(Tooltip, {\n      placement: \"top\",\n      title: \"Maximum \".concat(IMAGELIMIT, \" images upload\")\n    }, __jsx(\"img\", {\n      src: \"/assets/add-post/image.png\",\n      style: {\n        width: '25px',\n        height: '25px'\n      },\n      className: \"margin-x-sm margin-bottom-sm \".concat(reviewForm.images.length >= IMAGELIMIT ? 'cursor-not-allowed' : 'cursor-pointer')\n    }))))))))), __jsx(\"div\", {\n      style: {\n        height: FORM_CONTAINER_SIZE * 0.1 + 'px'\n      },\n      className: \"flex-items-align-center\"\n    }, __jsx(Button, {\n      htmlType: \"submit\",\n      loading: buttonLoading,\n      type: \"primary\",\n      style: {\n        color: 'white',\n        width: '100%'\n      }\n    }, mode == 'add' ? \"Add Post\" : \"Edit Post\"))));\n  };\n\n  var _renderState = function _renderState() {\n    return __jsx(\"div\", {\n      key: \"state\"\n    }, __jsx(Row, {\n      gutter: [0, 10]\n    }, __jsx(Col, {\n      xs: 24,\n      sm: 24,\n      md: 24,\n      lg: 24,\n      xl: 24\n    }, __jsx(\"div\", {\n      className: \"fill-parent\"\n    }, __jsx(Input, {\n      placeholder: \"Where are you?\",\n      onChange: function onChange(e) {\n        filterState(e.target.value);\n      }\n    }))), __jsx(Col, {\n      xs: 24,\n      sm: 24,\n      md: 24,\n      lg: 24,\n      xl: 24\n    }, __jsx(\"div\", {\n      style: {\n        height: FORM_CONTAINER_SIZE * 0.85 + 'px'\n      },\n      className: \"scroll-y-wrapper \"\n    }, filteredState.map(function (state) {\n      return __jsx(\"div\", {\n        className: \"flex-justify-start flex-items-align-center margin-y-md hover-background-yellow-lighten-3 cursor-pointer \".concat(_.toLower(reviewForm.state) == _.toLower(state.value) ? 'background-yellow-lighten-2' : ''),\n        onClick: function onClick(e) {\n          setReviewForm(_objectSpread(_objectSpread({}, reviewForm), {}, {\n            state: state.value\n          }));\n          setView(mode == 'edit' ? 'edit' : 'add');\n        }\n      }, __jsx(\"span\", {\n        className: \"d-inline-block relative-wrapper margin-x-md\",\n        style: {\n          width: '30px',\n          height: '20px'\n        }\n      }, __jsx(\"img\", {\n        src: getStateIcon(state.value),\n        className: \"fill-parent absolute-center\"\n      })), __jsx(\"span\", {\n        className: \"d-inline-block\"\n      }, __jsx(Highlighter, {\n        highlightStyle: {\n          color: '#ffc069',\n          padding: 0\n        },\n        textToHighlight: state.value,\n        autoEscape: true,\n        className: \"subtitle1\",\n        searchWords: searchStateWords\n      })));\n    })))));\n  };\n\n  var _renderView = function _renderView(data) {\n    switch (data) {\n      case 'state':\n        return _renderState();\n\n      case 'edit':\n        return _renderForm();\n\n      case 'add':\n        return _renderForm();\n\n      default:\n        return null;\n        break;\n    }\n  };\n\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: visible,\n    title: props.title && (view == 'add' || view == 'edit') ? props.title : title,\n    maskClosable: true,\n    centered: true,\n    closable: true,\n    footer: null,\n    onCancel: function onCancel(e) {\n      setVisible(false);\n    },\n    afterClose: function afterClose() {\n      reset();\n    }\n  }, __jsx(\"div\", {\n    style: {\n      height: FORM_CONTAINER_SIZE + 'px'\n    },\n    className: \"scroll-y-wrapper\"\n  }, __jsx(QueueAnim, {\n    type: \"bottom\"\n  }, view == 'add' || view == 'edit' ? _renderForm() : _renderState()))), __jsx(Modal, {\n    visible: previewVisible,\n    footer: null,\n    onCancel: handleCancel,\n    centered: true,\n    closable: true,\n    title: previewType == 'image' ? previewImage.name : previewVideo.name,\n    width: 400\n  }, previewType == 'video' ? __jsx(ReactPlayer, {\n    width: \"100%\",\n    height: \"200px\",\n    controls: true,\n    url: previewVideo.url,\n    config: {\n      file: {\n        forceVideo: true\n      }\n    }\n  }) : __jsx(\"img\", {\n    alt: \"example\",\n    style: {\n      width: '100%'\n    },\n    src: previewImage.url\n  })), __jsx(\"a\", {\n    onClick: props.readOnly ? null : reviewModalVisible\n  }, props.button ? props.button() : __jsx(Button, {\n    style: {\n      color: '#F57F17'\n    }\n  }, __jsx(Avatar, {\n    src: '/assets/add-post/create-post.png',\n    shape: \"square\",\n    size: \"small\"\n  }))));\n};\n\n_s(WriteReviewButton, \"SvLRnxjSxQ10AEOradu3QT8kgXc=\");\n\n_c = WriteReviewButton;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user\n  };\n};\n\nvar mapDispatchToProps = {\n  loginMode: loginMode,\n  loading: loading\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(WriteReviewButton)));\n\nvar _c;\n\n$RefreshReg$(_c, \"WriteReviewButton\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/rating/WriteReviewButton.jsx"],"names":["Avatar","Button","Col","Form","Icon","Input","message","Modal","Rate","Row","Select","Tooltip","Upload","axios","FormData","_","withRouter","QueueAnim","React","useEffect","useState","Highlighter","ScrollContainer","ReactPlayer","connect","v4","uuidv4","isValidNumber","notEmptyLength","client","getStateIcon","StateList","loading","loginMode","TextArea","moment","require","FORM_CONTAINER_SIZE","IMAGELIMIT","VIDEOLIMIT","WriteReviewButton","props","visible","setVisible","title","setTitle","run","setRun","timeoutFunction","setTimeoutFunction","previewType","setPreviewType","previewVisible","setPreviewVisible","previewImage","setPreviewImage","previewVideo","setPreviewVideo","form","getFieldDecorator","getFieldsError","getFieldError","isFieldTouched","isFieldValidating","view","setView","rating","comment","type","productId","userId","reviewerId","companyId","carspecId","images","videos","state","reviewForm","setReviewForm","filteredState","setFilteredState","searchStateWords","setSearchStateWords","origImages","setOrigImages","origVideos","setOrigVideos","writer","setWriter","mode","setMode","buttonLoading","setButtonLoading","ratingError","commentError","titleError","selectionError","setFieldsValue","filterState","_id","data","createdAt","cloneDeep","selection","setTimeout","handleError","authenticate","then","res","service","get","err","handleCancel","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","handlePreview","url","name","handleDelete","filter","item","handleSuccess","success","timeout","func","time","clearTimeout","parseInt","v","regex","RegExp","test","value","reset","resetFields","reviewModalVisible","onChangeImage","fileList","length","slice","map","originFileObj","uid","union","onChangeVideo","hasErrors","fieldsError","Object","keys","some","field","handleSubmit","e","preventDefault","validateFields","values","insertImages","removeImages","insertVideos","removeVideos","finalData","promises","concat","image","has","formData","i","fileName","split","join","Date","getTime","append","push","post","io","uri","headers","settings","storage","video","diffIds","differenceBy","includes","all","responses","forEach","config","create","patch","auth","reviewRes","params","imageUrl","videoUrl","console","log","errors","_renderImageCard","width","height","fontSize","_renderVideoCard","_renderSelection","text","idType","margin","rules","required","initialValue","stateObj","_renderForm","avatar","firstName","lastName","format","selectionText","isPlainObject","isEmpty","trim","target","color","_renderState","toLower","padding","_renderView","className","style","forceVideo","readOnly","button","mapStateToProps","app","user","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { Avatar, Button, Col, Form, Icon, Input, message, Modal, Rate, Row, Select, Tooltip, Upload } from 'antd';\nimport axios from 'axios';\nimport FormData from 'form-data';\nimport _ from 'lodash';\nimport { withRouter } from 'next/router';\nimport QueueAnim from 'rc-queue-anim';\nimport React, { useEffect, useState } from 'react';\nimport Highlighter from 'react-highlight-words';\nimport ScrollContainer from 'react-indiana-drag-scroll';\nimport ReactPlayer from 'react-player';\nimport { connect } from 'react-redux';\nimport { v4 as uuidv4 } from 'uuid';\nimport { isValidNumber, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { getStateIcon, StateList } from '../../params/stateList';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\n\n\nconst { TextArea } = Input;\nvar moment = require('moment');\n\nconst FORM_CONTAINER_SIZE = 500;\nconst IMAGELIMIT = 7;\nconst VIDEOLIMIT = 1;\n\n\nconst WriteReviewButton = (props) => {\n\n\n    const [visible, setVisible] = useState(false);\n    const [title, setTitle] = useState(\"Add Post\");\n    const [run, setRun] = useState(true);\n    const [timeoutFunction, setTimeoutFunction] = useState();\n    const [previewType, setPreviewType] = useState('image');\n    const [previewVisible, setPreviewVisible] = useState(false);\n    const [previewImage, setPreviewImage] = useState({});\n    const [previewVideo, setPreviewVideo] = useState({});\n\n    const { getFieldDecorator, getFieldsError, getFieldError, isFieldTouched, isFieldValidating } = props.form;\n\n    const [view, setView] = useState('add');\n    const [reviewForm, setReviewForm] = useState({\n        rating: null,\n        title: null,\n        comment: null,\n        type: null,\n        productId: null,\n        userId: null,\n        reviewerId: null,\n        companyId: null,\n        carspecId: null,\n        images: [],\n        videos: [],\n        state: null,\n    });\n\n\n    const [filteredState, setFilteredState] = useState([]);\n    const [searchStateWords, setSearchStateWords] = useState([])\n    const [origImages, setOrigImages] = useState([]);\n    const [origVideos, setOrigVideos] = useState([]);\n    const [writer, setWriter] = useState({});\n    const [mode, setMode] = useState('add');\n    const [buttonLoading, setButtonLoading] = useState(false);\n    // Only show error after a field is touched.\n    const ratingError = (isFieldTouched('rating') || !isFieldValidating('rating')) && getFieldError('rating');\n    const commentError = (isFieldTouched('comment') || !isFieldValidating('comment')) && getFieldError('comment');\n    const titleError = (isFieldTouched('title') || !isFieldValidating('title')) && getFieldError('title');\n    const selectionError = (isFieldTouched('selection') || !isFieldValidating('selection')) && getFieldError('selection');\n\n\n\n\n    useEffect(() => {\n        if (props.mode) {\n            if (props.mode == 'edit') {\n                setMode('edit');\n            } else {\n                setMode('add');\n            }\n        }\n\n    }, [props.mode])\n\n    useEffect(() => {\n\n        props.form.setFieldsValue(reviewForm);\n        switch (view) {\n            case 'edit':\n                setTitle('Edit Post')\n                break;\n            case 'add':\n                setTitle('Add Post')\n                break;\n            case 'state':\n                setTitle(\n                    <React.Fragment>\n                        <span className=\"margin-right-sm \">\n                            <a onClick={() => {\n                                setView(props.mode == \"edit\" ? \"edit\" : \"add\")\n                            }} className=\"black\">\n                                <Icon type=\"left\" />\n                            </a>\n                        </span>\n                        <span className=\"margin-x-sm\">\n                            Select State\n                     </span>\n                    </React.Fragment>\n                )\n                filterState(null);\n                break;\n            default:\n                setTitle('Add Post')\n                break;\n        }\n    }, [view])\n    useEffect(() => {\n\n        if (props.mode == 'edit') {\n            setReviewForm(\n                {\n                    ...reviewForm,\n                    _id: props.data._id,\n                    rating: props.data.rating ? props.data.rating : null,\n                    title: props.data.title ? props.data.title : null,\n                    comment: props.data.comment ? props.data.comment : null,\n                    state: props.data.state ? props.data.state : null,\n                    type: props.data.type ? props.data.type : null,\n                    userId: props.data.userId ? props.data.userId : null,\n                    reviewerId: props.data.reviewerId ? props.data.reviewerId : null,\n                    companyId: props.data.companyId ? props.data.companyId : null,\n                    productId: props.data.productId ? props.data.productId : null,\n                    carspecId: props.data.carspecId ? props.data.carspecId : null,\n                    createdAt: props.data.createdAt ? props.data.createdAt : null,\n                    images: props.data.images ? props.data.images : [],\n                    videos: props.data.videos ? props.data.videos : [],\n                }\n            )\n            setOrigImages(props.data.images ? props.data.images : []);\n            setOrigVideos(props.data.videos ? props.data.videos : []);\n        } else {\n            setReviewForm(\n                {\n                    ...reviewForm,\n                    rating: null,\n                    comment: null,\n                    title: null,\n                    state: null,\n                    type: props.data.type ? props.data.type : null,\n                    userId: props.data.userId ? props.data.userId : null,\n                    reviewerId: props.data.reviewerId ? props.data.reviewerId : null,\n                    companyId: props.data.companyId ? props.data.companyId : null,\n                    productId: props.data.productId ? props.data.productId : null,\n                    carspecId: props.data.carspecId ? props.data.carspecId : null,\n                    images: props.data.images ? props.data.images : [],\n                    videos: props.data.videos ? props.data.videos : [],\n                }\n            )\n            setOrigImages([]);\n            setOrigVideos([]);\n        }\n    }, [props.data])\n\n    useEffect(() => {\n\n        let form = _.cloneDeep(reviewForm);\n        form.selection = reviewForm[reviewForm.type + 'Id'];\n        if (visible && props.data.reviewerId) {\n            props.form.setFieldsValue({ selection: form.selection });\n        }\n\n    }, [reviewForm])\n\n    useEffect(() => {\n\n\n        if (run) {\n            setRun(false);\n            //only run every 2 seconds\n            setTimeout(() => {\n                setRun(true);\n            }, 2000);\n\n\n            if (visible && !props.data.reviewerId) {\n                props.loginMode(true);\n                handleError({ message: 'Please login to write review' });\n            }\n\n            if (mode == 'add') {\n                if (visible && (!props.data[props.data.type + 'Id'] && !notEmptyLength(props.selection))) {\n                    handleError({ message: 'Item not Found' });\n                }\n            }\n        }\n    })\n\n\n    useEffect(() => {\n        setView(mode == 'edit' ? 'edit' : 'add');\n    }, [mode])\n\n\n    useEffect(() => {\n        if (reviewForm.reviewerId) {\n            props.loading(true);\n            client.authenticate()\n                .then((res) => {\n                    props.loading(false);\n                    client.service('users').get(reviewForm.reviewerId).then((res) => {\n                        if (res) {\n                            setWriter(res);\n                        } else {\n                            setWriter({});\n                        }\n                    })\n                })\n                .catch((err) => {\n                    props.loading(false);\n                    setButtonLoading(false);\n                    handleError({ message: 'Error on getting user.' });\n                })\n        } else {\n            setWriter({});\n        }\n    }, [reviewForm.reviewerId])\n\n\n    function handleCancel() {\n        setPreviewVisible(false);\n    }\n\n\n    function getBase64(file) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.readAsDataURL(file);\n            reader.onload = () => resolve(reader.result);\n            reader.onerror = error => reject(error);\n        });\n    }\n\n    async function handlePreview(file, type) {\n\n        if (type == 'video') {\n            setPreviewType('video');\n            setPreviewVisible(true)\n            setPreviewVideo(\n                {\n                    url: file.url,\n                    name: file.name\n                })\n        } else {\n            setPreviewType('image');\n            setPreviewVisible(true)\n            setPreviewImage(\n                {\n                    url: file.url,\n                    name: file.name\n                })\n        }\n    }\n\n    function handleDelete(file, type) {\n\n        if (!file || !file._id) {\n            //handle Error\n            message.error(type == 'video' ? \"Video not found.\" : 'Image not found.')\n        } else {\n            if (type == 'video') {\n\n                let data = _.filter(reviewForm.videos, function (item) {\n                    return item._id != file._id;\n                });\n                if (notEmptyLength(data)) {\n                    setReviewForm({ ...reviewForm, videos: data });\n                } else {\n                    setReviewForm({ ...reviewForm, videos: [] })\n                }\n            } else {\n\n                let data = _.filter(reviewForm.images, function (item) {\n                    return item._id != file._id;\n                });\n                if (notEmptyLength(data)) {\n                    setReviewForm({ ...reviewForm, images: data });\n                } else {\n                    setReviewForm({ ...reviewForm, images: [] })\n                }\n            }\n        }\n    }\n\n    function handleSuccess(success) {\n        setVisible(false);\n        if (props.handleSuccess) {\n            props.handleSuccess(success);\n        }\n    }\n\n\n    function handleError(error) {\n        setVisible(false);\n        if (props.handleError) {\n            props.handleError(error);\n        }\n    }\n    function timeout(func, time) {\n        if (!isValidNumber(time)) {\n            time = 500;\n        }\n        clearTimeout(timeoutFunction);\n        setTimeoutFunction(setTimeout(() => {\n            return func\n        }, parseInt(time)))\n    }\n\n    function filterState(v) {\n        if (v) {\n            let regex = new RegExp(`^.*${v}.*$`, 'i')\n            setFilteredState(StateList.filter(function (state) {\n                return regex.test(state.value);\n            }))\n            setSearchStateWords([v]);\n        } else {\n            setSearchStateWords([]);\n            setFilteredState(StateList);\n        }\n    }\n\n    function reset() {\n        setView(mode == \"edit\" ? \"edit\" : \"add\");\n        props.form.resetFields();\n        setReviewForm({ ...reviewForm, images: origImages, videos: origVideos, state: props.data.state ? props.data.state : null, });\n        setButtonLoading(false);\n    }\n\n    function reviewModalVisible() {\n        if (props.data.reviewerId) {\n            setVisible(true)\n        }\n        else {\n            props.loginMode(true);\n            handleError({ message: 'Please login to write review' });\n        }\n\n    }\n\n    function onChangeImage(fileList) {\n\n        if (notEmptyLength(fileList)) {\n            if (fileList.length > IMAGELIMIT) {\n                fileList = fileList.slice(0, IMAGELIMIT);\n            }\n\n            let data = fileList.map(function (file) {\n                if (file.originFileObj) {\n                    getBase64(file.originFileObj).then(res => {\n                        file.url = res\n                    })\n\n                    file._id = file.uid;\n                }\n                return file;\n            })\n            data = _.union(data, reviewForm.images)\n            setReviewForm({ ...reviewForm, images: data });\n        }\n\n\n    }\n\n    function onChangeVideo(fileList) {\n\n\n        if (notEmptyLength(fileList)) {\n            if (fileList.length > VIDEOLIMIT) {\n                fileList = fileList.slice(0, VIDEOLIMIT);\n            }\n            let data = fileList.map(function (file) {\n                if (file.originFileObj) {\n                    getBase64(file.originFileObj).then(res => {\n                        file.url = res\n                    })\n\n                    file._id = file.uid;\n                }\n                return file;\n            })\n\n            data = _.union(data, reviewForm.videos)\n            setReviewForm({ ...reviewForm, videos: data });\n        }\n    }\n\n    function hasErrors(fieldsError) {\n        return Object.keys(fieldsError).some(field => fieldsError[field]);\n    }\n\n    function handleSubmit(e) {\n        e.preventDefault();\n        setButtonLoading(true);\n        props.form.validateFields((err, values) => {\n            if (!err) {\n                let insertImages = [];\n                let removeImages = [];\n                let insertVideos = [];\n                let removeVideos = [];\n                let finalData = _.cloneDeep(reviewForm);\n                let images = _.cloneDeep(reviewForm.images);\n                let videos = _.cloneDeep(reviewForm.videos);\n                let promises = [];\n\n                //get new upload images\n                if (notEmptyLength(images)) {\n\n                    insertImages = insertImages.concat(images.filter(function (image) {\n                        return _.has(image, \"originFileObj\")\n                    }));\n\n                    if (insertImages.length > 0) {\n                        let formData = new FormData();\n                        for (let i = 0; i < insertImages.length; i++) {\n                            var fileName = uuidv4() + \"-\" + insertImages[i].name.split('.').join(\"-\") + \"-\" + new Date().getTime();\n\n                            formData.append('images', insertImages[i].originFileObj, fileName);\n                        }\n\n                        //Upload Image\n                        promises.push(\n                            axios.post(`${client.io.io.uri}upload-images-array`,\n                                formData\n                                , {\n                                    headers: {\n                                        'Authorization': client.settings.storage.storage.storage['feathers-jwt'],\n                                        'Content-Type': 'multipart/form-data',\n                                    }\n                                }\n                            )\n                        )\n                    }\n                }\n\n                //get new upload videos\n                if (notEmptyLength(videos)) {\n\n                    insertVideos = insertVideos.concat(videos.filter(function (video) {\n                        return _.has(video, \"originFileObj\")\n                    }));\n\n\n                    if (insertVideos.length > 0) {\n                        let formData = new FormData();\n                        for (let i = 0; i < insertVideos.length; i++) {\n                            var fileName = uuidv4() + \"-\" + insertVideos[i].name.split('.').join(\"-\") + \"-\" + new Date().getTime();\n\n                            formData.append('videos', insertVideos[i].originFileObj, fileName);\n                        }\n\n                        //Upload Image\n                        promises.push(\n                            axios.post(`${client.io.io.uri}upload-videos-array`,\n                                formData\n                                , {\n                                    headers: {\n                                        'Authorization': client.settings.storage.storage.storage['feathers-jwt'],\n                                        'Content-Type': 'multipart/form-data',\n                                    }\n                                }\n                            )\n                        )\n                    }\n                }\n\n                //get removed images\n                if (mode == 'edit') {\n\n                    let diffIds = _.map(_.differenceBy(origImages, images, '_id'), \"_id\");\n                    removeImages = removeImages.concat(_.filter(origImages, function (image) {\n                        return _.includes(diffIds, image._id);\n                    }))\n\n                    diffIds = _.map(_.differenceBy(origVideos, videos, '_id'), \"_id\");\n                    removeVideos = removeVideos.concat(_.filter(origVideos, function (video) {\n                        return _.includes(diffIds, video._id);\n                    }))\n                }\n\n                props.loading(true);\n                //Upload new images to server first\n                Promise.all(promises).then((responses) => {\n                    props.loading(false);\n\n                    _.forEach(responses, function (res) {\n                        if (res.config.url == `${client.io.io.uri}upload-videos-array`) {\n                            if (notEmptyLength(res.data.result)) {\n\n                                //Replace new upload videos with url\n                                videos = videos.filter(function (video) {\n                                    return !_.has(video, \"originFileObj\")\n                                });\n\n                                videos = videos.concat(res.data.result);\n                                finalData.videos = videos;\n                            }\n\n                        } else {\n                            if (notEmptyLength(res.data.result)) {\n\n\n                                //Replace new upload images with url\n                                images = images.filter(function (image) {\n                                    return !_.has(image, \"originFileObj\")\n                                });\n\n                                images = images.concat(res.data.result);\n                                finalData.images = images\n                            }\n                        }\n                    })\n\n\n\n                    promises = [];\n                    promises.push(client.authenticate());\n                    if (mode == 'add') {\n                        promises.push(client.service('rating').create(finalData))\n                    } else {\n                        promises.push(client.service('rating').patch(finalData._id, finalData))\n                    }\n\n                    //Write in rating model\n                    if (finalData[finalData.type + \"Id\"] != null) {\n                        props.loading(true);\n                        Promise.all(promises).then(([auth, reviewRes]) => {\n                            props.loading(false);\n                            message.success(mode == \"edit\" ? 'Edit Successful' : 'Create Successful');\n                            handleSuccess(reviewRes);\n                            setButtonLoading(false);\n                            setOrigImages(reviewRes.images);\n                            setOrigVideos(reviewRes.videos);\n\n\n                            //Remove useless images\n                            if (notEmptyLength(removeImages)) {\n                                axios.post(`${client.io.io.uri}deleteImageS3`,\n                                    {\n                                        params: {\n                                            imageUrl: removeImages\n                                        },\n                                        headers: {\n                                            'Content-Type': 'text/xml; charset=utf-8',\n                                            'Content-Length': 'length'\n                                        }\n                                    }\n                                ).then(res => {\n                                })\n                            }\n                            //Remove useless videos\n                            if (notEmptyLength(removeVideos)) {\n                                axios.post(`${client.io.io.uri}deleteVideoS3`,\n                                    {\n                                        params: {\n                                            videoUrl: removeVideos\n                                        },\n                                        headers: {\n                                            'Content-Type': 'text/xml; charset=utf-8',\n                                            'Content-Length': 'length'\n                                        }\n                                    }\n                                )\n                            }\n\n                        })\n                    }\n\n                }).catch(err => {\n                    props.loading(false);\n                    setButtonLoading(false)\n                    console.log('err');\n                    console.log(err);\n                    message.error(err.message)\n                });\n\n\n            } else {\n                props.loading(false);\n                setButtonLoading(false);\n                _.map(err, function (err) {\n                    return message.error(err.errors[0].message)\n                })\n\n            }\n        });\n    };\n\n    const _renderImageCard = (data) => {\n        if (notEmptyLength(data)) {\n            return (\n                data.map(function (item) {\n                    return <span\n                        className={\"d-inline-block thin-border margin-right-xs margin-bottom-xs background-white flex-items-no-shrink\"}\n                        style={{ width: '70px', height: '70px' }}\n                    >\n                        <div className=\"relative-wrapper fill-parent\">\n                            <div className=\"absolute-center\" >\n                                <img src={item.url} className=\"fill-parent\" ></img>\n                            </div>\n                            <div className=\"absolute-center background-grey-darken-4 stack-element-opacity-50 flex-items-align-center flex-justify-center\">\n                                <a onClick={(e) => { handlePreview(item, 'image') }}>\n                                    <Icon type=\"eye\" className=\"white margin-x-xs\" style={{ fontSize: '20px' }} />\n                                </a>\n                                <a onClick={(e) => { handleDelete(item, 'image') }}>\n                                    <Icon type=\"delete\" className=\"white margin-x-xs\" style={{ fontSize: '20px' }} />\n                                </a>\n                            </div>\n                        </div>\n                    </span>\n                })\n            )\n\n        } else {\n            return null;\n        }\n    }\n\n    const _renderVideoCard = (data) => {\n        if (notEmptyLength(data)) {\n            return (\n                data.map(function (item) {\n                    return <span\n                        className={\"d-inline-block thin-border margin-right-xs margin-bottom-xs background-white flex-items-no-shrink\"}\n                        style={{ width: '70px', height: '70px' }}\n                    >\n                        <div className=\"relative-wrapper fill-parent\">\n                            <div className=\"absolute-center\" >\n                                <ReactPlayer width='100%' height=\"100%\" url={item.url} />\n                            </div>\n                            <div className=\"absolute-center background-grey-darken-4 stack-element-opacity-50 flex-items-align-center flex-justify-center\">\n                                <a onClick={(e) => { handlePreview(item, 'video') }}>\n                                    <Icon type=\"eye\" className=\"white margin-x-xs\" style={{ fontSize: '20px' }} />\n                                </a>\n                                <a onClick={(e) => { handleDelete(item, 'video') }}>\n                                    <Icon type=\"delete\" className=\"white margin-x-xs\" style={{ fontSize: '20px' }} />\n                                </a>\n                            </div>\n                        </div>\n                    </span>\n                })\n            )\n\n        } else {\n            return null;\n        }\n    }\n\n    const _renderSelection = (data, text) => {\n\n        if (notEmptyLength(data)) {\n\n            let idType = `${reviewForm.type}Id`;\n            return (\n                <React.Fragment>\n                    <div className=\"headline  \" >\n                        {text != null ? text : 'Please select item to review'}\n                    </div>\n\n                    <Form.Item required={false} validateStatus={selectionError ? 'error' : ''} help={selectionError || ''} style={{ margin: 0 }}>\n                        {getFieldDecorator('selection', {\n                            rules: [{ required: true, message: 'Please pick 1 item to review!' }],\n                            initialValue: props.data[idType],\n                        })(\n                            <Select onChange={(v) => {\n                                let stateObj = _.cloneDeep(reviewForm);\n                                stateObj[idType] = v;\n                                setReviewForm(stateObj)\n                            }}\n                            >\n                                {\n                                    data.map(function (item) {\n                                        return (\n                                            <Select.Option key={item._id} value={item._id}>\n                                                {item.name}\n                                            </Select.Option>\n                                        )\n                                    })\n                                }\n                            </Select>\n                        )}\n                    </Form.Item>\n                </React.Fragment>\n            );\n        } else {\n            return null;\n        }\n    }\n\n\n    const _renderForm = () => {\n\n        return (\n            <div key=\"form\">\n\n                <Form onSubmit={handleSubmit} >\n\n                    <div style={{ height: FORM_CONTAINER_SIZE * 0.15 + 'px' }} className=\"scroll-y-wrapper padding-x-sm \">\n                        <Form.Item style={{ margin: 0 }}>\n                            <Row type=\"flex\" align=\"top\">\n                                <Col span={12}>\n                                    <div className='flex-items-align-start'>\n                                        <span className='d-inline-block margin-right-sm' >\n                                            <Avatar size={50} src={writer.avatar ? writer.avatar : null} icon={writer.avatar ? null : 'user'} ></Avatar>\n                                        </span>\n                                        <span className='d-inline-block flex-items-align-center' >\n                                            <span className='d-inline-block'>{writer.firstName ? writer.firstName : null} {writer.lastName ? writer.lastName : null}</span>\n                                            {\n                                                reviewForm.state ?\n                                                    <span className='blue d-inline-block margin-right-sm flex-items-align-center padding-left-xs'> {reviewForm.state}</span>\n                                                    :\n                                                    null\n                                            }\n                                        </span>\n                                    </div>\n                                </Col>\n                                <Col span={12}>\n                                    <div className=\"review2\">\n                                        <p>{reviewForm.createdAt ? moment(reviewForm.createdAt).format('D MMMM Y') : moment().format('D MMMM Y')}</p>\n                                    </div>\n                                </Col>\n                            </Row>\n                        </Form.Item>\n                    </div>\n                    <div style={{ height: FORM_CONTAINER_SIZE * 0.75 + 'px' }} className=\"scroll-y-wrapper padding-x-sm\">\n\n                        {\n                            notEmptyLength(props.selection) ?\n                                _renderSelection(props.selection, props.selectionText)\n                                :\n                                null\n                        }\n                        {\n                            _.isPlainObject(_.get(props.data, 'carspecId')) && !_.isEmpty(_.get(props.data, 'carspecId')) ?\n                                <div className=\"headline font-weight-bold\">\n                                    {_.trim(`${_.get(props.data, 'carspecId.make') || ''} ${_.get(props.data, 'carspecId.model') || ''} ${_.get(props.data, 'carspecId.variant') || ''}`)}\n                                </div>\n                                :\n                                null\n                        }\n                        <div className=\"headline  \">\n                            How awesome this?\n                        </div>\n                        <Form.Item required={false} validateStatus={ratingError ? 'error' : ''} help={ratingError || ''} style={{ margin: 0 }}>\n                            {getFieldDecorator('rating', {\n                                rules: [{ required: true, message: 'Please rate this store!' }],\n                                initialValue: !props.data || !props.data.rating ? null : props.data.rating,\n                            })(\n                                <Rate allowHalf\n                                    onChange={(v) => { setReviewForm({ ...reviewForm, rating: v }) }}\n                                />\n                            )}\n                        </Form.Item>\n\n                        <Form.Item required={false} validateStatus={titleError ? 'error' : ''} help={titleError || ''} style={{ margin: 0 }}>\n                            {getFieldDecorator('title', {\n                                initialValue: props.data ? props.data.title : null,\n                            })(\n                                <Input\n                                    placeholder=\"Title\"\n                                    maxLength={300}\n                                    onChange={(e) => { setReviewForm({ ...reviewForm, title: e.target.value }) }} />\n                            )}\n                        </Form.Item>\n                        <Form.Item required={false} validateStatus={commentError ? 'error' : ''} help={commentError || ''} style={{ margin: 0 }}>\n                            {getFieldDecorator('comment', {\n                                initialValue: props.data ? props.data.comment : null,\n                            })(\n                                <TextArea rows={4}\n                                    maxLength={1000}\n                                    placeholder=\"Write your review....\"\n                                    onChange={(e) => { setReviewForm({ ...reviewForm, comment: e.target.value }) }} />\n                            )}\n                        </Form.Item>\n\n\n                        <Form.Item style={{ margin: 0 }} >\n\n                            <ScrollContainer style={{ height: '70px', width: \"100%\" }} className=\"d-flex margin-y-sm\" vertical={false}>\n                                {_renderVideoCard(reviewForm.videos)}\n                                {_renderImageCard(reviewForm.images)}\n\n                            </ScrollContainer>\n                        </Form.Item>\n\n                        <div className=\"margin-y-sm\">\n                            <Form.Item style={{ margin: 0 }}>\n                                <Row className=\"thin-border round-border padding-sm\" gutter={[10, 20]}>\n                                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\n                                        <div className=\"fill-parent  headline   text-overflow-break\"> Add to your post</div>\n                                    </Col>\n                                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\n                                        <div className=\"fill-parent flex-justify-end flex-items-align-center flex-align-center text-overflow-break\">\n\n                                            <Upload\n                                                accept=\"image/*\"\n                                                onChange={({ fileList }) => {\n                                                    onChangeImage(fileList)\n                                                }}\n                                                multiple={true}\n                                                fileList={reviewForm.images}\n                                                showUploadList={false}\n                                                beforeUpload={file => false}\n                                                disabled={notEmptyLength(reviewForm.images) ? reviewForm.images.length >= IMAGELIMIT : false}\n                                            >\n                                                <Tooltip placement=\"top\" title={`Maximum ${IMAGELIMIT} images upload`}>\n                                                    <img src=\"/assets/add-post/image.png\" style={{ width: '25px', height: '25px' }} className={`margin-x-sm margin-bottom-sm ${reviewForm.images.length >= IMAGELIMIT ? 'cursor-not-allowed' : 'cursor-pointer'}`} />\n                                                </Tooltip>\n                                            </Upload>\n                                            {/* <a onClick={(e) => { setView('state') }}>\n                                                <img src=\"/assets/add-post/location.png\" style={{ width: '25px', height: '25px' }} className=\"margin-x-sm margin-bottom-sm\" />\n                                            </a> */}\n                                            {/* <a>\n                                                <img src=\"/assets/add-post/add-people.png\" style={{ width: '25px', height: '25px' }} className=\"margin-x-sm margin-bottom-sm\" />\n                                            </a> */}\n                                            {/* <a>\n                                                <Upload\n                                                    accept=\"video/*\"\n                                                    onChange={({ fileList }) => {\n                                                        onChangeVideo(fileList)\n                                                    }}\n                                                    fileList={reviewForm.videos}\n                                                    showUploadList={false}\n                                                    beforeUpload={file => false}\n                                                    disabled={notEmptyLength(reviewForm.videos) ? reviewForm.videos.length >= VIDEOLIMIT : false}\n                                                >\n                                                    <Tooltip placement=\"top\" title={`Maximum ${VIDEOLIMIT} videos upload`}>\n                                                        <img src=\"/assets/add-post/Video.png\" style={{ width: '25px', height: '25px' }} className=\"margin-x-sm margin-bottom-sm\" />\n                                                    </Tooltip>\n                                                </Upload>\n                                            </a> */}\n                                        </div>\n                                    </Col>\n                                </Row>\n                            </Form.Item>\n                        </div>\n                    </div>\n                    <div style={{ height: FORM_CONTAINER_SIZE * 0.1 + 'px' }} className=\"flex-items-align-center\">\n                        <Button htmlType=\"submit\" loading={buttonLoading} type=\"primary\" style={{ color: 'white', width: '100%' }}>\n                            {mode == 'add' ? \"Add Post\" : \"Edit Post\"}\n                        </Button>\n                    </div>\n                </Form>\n            </div >\n        )\n    }\n\n    const _renderState = () => {\n        return (\n            <div key=\"state\">\n                <Row gutter={[0, 10]} >\n                    <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                        <div className='fill-parent'>\n                            <Input placeholder=\"Where are you?\" onChange={(e) => { filterState(e.target.value) }}></Input>\n                        </div>\n                    </Col>\n                    <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                        <div style={{ height: FORM_CONTAINER_SIZE * 0.85 + 'px' }} className='scroll-y-wrapper '>\n                            {\n                                filteredState.map(function (state) {\n                                    return (\n                                        <div className={`flex-justify-start flex-items-align-center margin-y-md hover-background-yellow-lighten-3 cursor-pointer ${_.toLower(reviewForm.state) == _.toLower(state.value) ? 'background-yellow-lighten-2' : ''}`} onClick={(e) => { setReviewForm({ ...reviewForm, state: state.value }); setView(mode == 'edit' ? 'edit' : 'add') }}>\n                                            <span className='d-inline-block relative-wrapper margin-x-md' style={{ width: '30px', height: '20px' }} >\n                                                <img src={getStateIcon(state.value)} className=\"fill-parent absolute-center\"></img>\n                                            </span>\n                                            <span className='d-inline-block' >\n                                                <Highlighter\n                                                    highlightStyle={{ color: '#ffc069', padding: 0 }}\n                                                    textToHighlight={state.value}\n                                                    autoEscape={true}\n                                                    className=\"subtitle1\"\n                                                    searchWords={searchStateWords} />\n                                            </span>\n                                        </div>\n                                    )\n                                })\n                            }\n                        </div>\n                    </Col>\n\n                </Row>\n            </div>\n        )\n    }\n    const _renderView = (data) => {\n        switch (data) {\n            case 'state':\n                return _renderState();\n            case 'edit':\n                return _renderForm();\n            case 'add':\n                return _renderForm();\n            default:\n                return null;\n                break;\n        }\n    }\n\n\n    return (\n\n        <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n            <Modal\n                visible={visible}\n                title={props.title && (view == 'add' || view == 'edit') ? props.title : title}\n                maskClosable={true}\n                centered={true}\n                closable={true}\n                footer={null}\n                onCancel={(e) => { setVisible(false); }}\n                afterClose={() => {\n                    reset();\n                }}\n            >\n                <div style={{ height: FORM_CONTAINER_SIZE + 'px' }} className=\"scroll-y-wrapper\" >\n                    <QueueAnim type=\"bottom\">\n                        {\n                            view == 'add' || view == 'edit' ?\n                                _renderForm()\n                                :\n                                _renderState()\n                        }\n                    </QueueAnim>\n                </div>\n            </Modal>\n\n            <Modal visible={previewVisible} footer={null} onCancel={handleCancel} centered={true} closable={true} title={previewType == 'image' ? previewImage.name : previewVideo.name} width={400}>\n                {\n                    previewType == 'video' ?\n                        <ReactPlayer width='100%' height=\"200px\" controls url={previewVideo.url} config={{\n                            file: {\n                                forceVideo: true,\n                            }\n                        }} />\n                        :\n                        <img alt=\"example\" style={{ width: '100%' }} src={previewImage.url} />\n                }\n            </Modal>\n            <a onClick={props.readOnly ? null : reviewModalVisible}>\n\n                {\n                    props.button ?\n                        props.button()\n                        :\n                        <Button style={{ color: '#F57F17' }}><Avatar src={'/assets/add-post/create-post.png'} shape=\"square\" size=\"small\" /></Button>\n                }\n            </a>\n\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\n\nconst mapDispatchToProps = {\n    loginMode: loginMode,\n    loading: loading,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(WriteReviewButton)));"]},"metadata":{},"sourceType":"module"}