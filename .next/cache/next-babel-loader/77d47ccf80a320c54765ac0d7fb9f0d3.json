{"ast":null,"code":"var _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport { Card, message, Switch, Table } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { fetchDetails, filteredCompareData } from '../../redux/actions/newcars-actions';\nimport { arrayLengthCount, isValidNumber, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { loading } from '../../redux/actions/app-actions';\nloading;\n\nvar CarspecsCompareTable = function CarspecsCompareTable(props) {\n  _s();\n\n  var _useState = useState([]),\n      carspecs = _useState[0],\n      setCarspecs = _useState[1];\n\n  var _useState2 = useState([]),\n      filteredCompareData = _useState2[0],\n      setFilteredCompareData = _useState2[1];\n\n  var _useState3 = useState([]),\n      expandedRow = _useState3[0],\n      setExpandedRow = _useState3[1];\n\n  var _useState4 = useState([]),\n      columns = _useState4[0],\n      setColumns = _useState4[1];\n\n  var _useState5 = useState([{\n    key: 'engineCapacity',\n    name: 'Engine Capacity'\n  }, {\n    key: 'transmission',\n    name: 'Transmission'\n  }, {\n    key: 'year',\n    name: 'Year'\n  }, {\n    key: 'mileage',\n    name: 'Mileage'\n  }, {\n    key: 'bodyType',\n    name: 'Body Type'\n  }]),\n      mainCategory = _useState5[0],\n      setMainCategory = _useState5[1];\n\n  function updateTableCols(data) {\n    var colObj = [{\n      title: 'Name',\n      dataIndex: 'name',\n      key: 'name',\n      width: '250px',\n      fixed: 'left',\n      render: function render(text, row) {\n        if (notEmptyLength(row.children)) {\n          return {\n            children: __jsx(\"span\", null, __jsx(\"strong\", null, row.name)),\n            props: {\n              colSpan: notEmptyLength(data) ? data.length + 1 : 1\n            }\n          };\n        } else {\n          if (row.name) {\n            return {\n              children: __jsx(\"span\", null, row.name)\n            };\n          } else {\n            return {\n              children: __jsx(\"span\", null, row.field)\n            };\n          }\n        }\n      }\n    }];\n\n    if (notEmptyLength(data)) {\n      data.forEach(function (item, index) {\n        colObj.push({\n          title: \"\".concat(_.capitalize(item.make), \" \").concat(_.capitalize(item.model), \" \").concat(_.capitalize(item.variant)),\n          dataIndex: \"compare\".concat(index),\n          key: \"compare\".concat(index),\n          width: arrayLengthCount(data) > 4 ? '250px' : null,\n          render: function render(text, row) {\n            if (notEmptyLength(row.children)) {\n              return {\n                props: {\n                  colSpan: 0\n                }\n              };\n            } else {\n              if (row[\"compare\".concat(index)]) {\n                return {\n                  children: __jsx(\"span\", null, row[\"compare\".concat(index)])\n                };\n              } else {\n                return {\n                  children: __jsx(\"span\", null, \"-\")\n                };\n              }\n            }\n          }\n        });\n      });\n    }\n\n    setColumns(colObj);\n  }\n\n  useEffect(function () {\n    console.log(props.data);\n\n    if (notEmptyLength(props.data)) {\n      var data = _.cloneDeep(props.data);\n\n      if (!isNaN(parseInt(props.limit)) && data.length > parseInt(props.limit)) {\n        data = _.slice(data, 0, parseInt(props.limit));\n        message.warning(\"Maximum \".concat(parseInt(props.limit), \" items to compare. Removed overflow items.\"));\n      }\n\n      if (props.findById) {\n        props.loading(true);\n        client.service('carspecs').find({\n          query: {\n            _id: {\n              $in: data\n            }\n          }\n        }).then(function (res) {\n          console.log(res);\n          props.loading(false);\n\n          if (notEmptyLength(res.data)) {\n            setCarspecs(res.data);\n          } else {\n            setCarspecs([]);\n          }\n        })[\"catch\"](function (err) {\n          props.loading(false);\n          message.error(err.message);\n        });\n      } else {\n        setCarspecs(data);\n      }\n    } else {\n      setCarspecs([]);\n    }\n  }, [props.data]);\n  useEffect(function () {\n    if (notEmptyLength(carspecs)) {\n      filteringCompareData(carspecs);\n      updateTableCols(carspecs);\n    }\n  }, [carspecs]);\n  useEffect(function () {\n    expandAllRow();\n  }, [filteredCompareData]);\n\n  function filteringCompareData(data) {\n    var baseCategory = _.cloneDeep(mainCategory);\n\n    var rows = [];\n\n    if (notEmptyLength(data)) {\n      var allCategory = []; //Restruct data\n\n      _.map(data, function (item) {\n        //prepare base field row\n        var mainCategoryRow = [];\n        var splitObj = Object.entries(item); //IF it is main category data push into specification\n\n        _.forEach(splitObj, function (splitValue) {\n          var selectedBase = _.find(baseCategory, ['key', splitValue[0]]);\n\n          if (notEmptyLength(selectedBase)) {\n            mainCategoryRow.push({\n              category: 'Main Category',\n              field: selectedBase.name,\n              value: splitValue[1]\n            });\n          }\n        });\n\n        if (!item.specification) {\n          return item;\n        } //Push Main Category to Specification\n\n\n        item.specification = _.compact(_.concat(mainCategoryRow, item.specification)); //Find all distinct category\n\n        allCategory = _.unionBy(_.map(_.uniqBy(item.specification, 'category'), 'category'), allCategory);\n        return item;\n      });\n\n      if (isValidNumber(parseInt(props.groupLimit))) {\n        allCategory = _.take(allCategory, parseInt(props.groupLimit));\n      } //prepare expandable rows\n\n\n      if (notEmptyLength(allCategory)) {\n        _.forEach(allCategory, function (category) {\n          var rowData = {\n            key: category,\n            name: category,\n            children: []\n          };\n\n          _.forEach(_.compact(data), function (item, compareCarIndex) {\n            _.forEach(_.compact(item.specification), function (specItem, specificationIndex) {\n              //Found record then push to children\n              if (_.toLower(category) == _.toLower(specItem.category)) {\n                var selectedRowChildren = {}; //find if children already inserted\n\n                selectedRowChildren = _.find(rowData.children, function (child) {\n                  return child.name == specItem.field;\n                });\n\n                if (notEmptyLength(selectedRowChildren)) {\n                  //inserted\n                  selectedRowChildren[\"compare\".concat(compareCarIndex)] = specItem.value;\n                } else {\n                  //haven't insert yet\n                  var temp = {\n                    name: specItem.field,\n                    key: \"\".concat(specItem.field, \"-\").concat(specificationIndex)\n                  };\n                  temp[\"compare\".concat(compareCarIndex)] = specItem.value;\n                  rowData.children.push(temp);\n                }\n              }\n            });\n          });\n\n          rows.push(rowData);\n        });\n      }\n    }\n\n    setFilteredCompareData(rows);\n  }\n\n  function onChange(checked) {\n    if (checked) {\n      hideSameDetails(filteredCompareData);\n    } else {\n      filteringCompareData(carspecs);\n    }\n  }\n\n  function hideSameDetails(data) {\n    if (notEmptyLength(data)) {\n      var finalData = _.cloneDeep(data);\n\n      data.forEach(function (rowData) {\n        var compareFields = findRowCompareFields(rowData, true);\n\n        if (notEmptyLength(compareFields)) {\n          //Check only more than 1 data\n          if (compareFields.length > 1) {\n            var uniqValue = _.uniq(compareFields); //Is same\n\n\n            if (uniqValue.length <= 1) {\n              finalData = removeRowData(finalData, rowData.key);\n            }\n          }\n        } else {\n          if (notEmptyLength(rowData.children)) {\n            _.forEach(rowData.children, function (childrenRowData) {\n              compareFields = findRowCompareFields(childrenRowData, true);\n\n              if (notEmptyLength(compareFields)) {\n                if (compareFields.length > 1) {\n                  var _uniqValue = _.uniq(compareFields); //Is same\n\n\n                  if (_uniqValue.length <= 1) {\n                    finalData = removeRowData(finalData, childrenRowData.key);\n                  }\n                }\n              } else {\n                finalData = removeRowData(finalData, childrenRowData.key);\n              }\n            });\n          } else {\n            finalData = removeRowData(finalData, rowData.key);\n          }\n        }\n      });\n      setFilteredCompareData(finalData);\n    } else {\n      return data;\n    }\n  }\n\n  function findRowCompareFields(row, returnDataOnly) {\n    if (notEmptyLength(row)) {\n      var splitObj = Object.entries(row);\n\n      var compareFields = _.filter(splitObj, function (obj) {\n        var regex = new RegExp('^compare', 'i');\n        return regex.test(obj[0]);\n      });\n\n      if (returnDataOnly) {\n        return _.map(compareFields, function (item) {\n          return item[1];\n        });\n      } else {\n        return compareFields;\n      }\n    } else {\n      return [];\n    }\n  }\n\n  function removeRowData(data, key) {\n    if (key) {\n      var finalData = _.cloneDeep(data); //Check for non expandable row first\n\n\n      finalData = _.filter(finalData, function (row) {\n        return row.key != key;\n      }); //Check for expandable row\n\n      finalData = _.compact(_.map(finalData, function (row) {\n        if (notEmptyLength(row.children)) {\n          var filteredChildren = _.filter(row.children, function (childrenRow) {\n            return childrenRow.key != key;\n          }); //Dont have any children now\n\n\n          if (!notEmptyLength(filteredChildren)) {\n            return null;\n          } else {\n            row.children = filteredChildren;\n            return row;\n          }\n        }\n\n        return row;\n      }));\n      return finalData;\n    } else {\n      return null;\n    }\n  }\n\n  function expandAllRow() {\n    if (notEmptyLength(filteredCompareData)) {\n      var keys = _.map(filteredCompareData, 'key');\n\n      if (notEmptyLength(keys)) {\n        setExpandedRow(keys);\n      }\n    } else {\n      setExpandedRow([]);\n    }\n  }\n\n  function shrinkAllRow() {\n    setExpandedRow([]);\n  }\n\n  var _renderTableTitle = function _renderTableTitle() {\n    return __jsx(React.Fragment, null, __jsx(\"div\", {\n      className: \" flex-justify-start w-100 flex-items-align-center \"\n    }, props.rowExpandControl == null || props.rowExpandControl == true ? __jsx(\"span\", {\n      className: \"d-inline-block margin-x-sm\"\n    }, __jsx(Switch, {\n      onChange: function onChange(e) {\n        e ? expandAllRow() : shrinkAllRow();\n      },\n      defaultChecked: true,\n      unCheckedChildren: \"Expand Rows\",\n      checkedChildren: \"Shrink Rows\"\n    })) : null, (props.hideExpandControl == null || props.hideExpandControl == true) && arrayLengthCount(carspecs) > 1 ? __jsx(\"span\", {\n      className: \"d-inline-block margin-x-sm\"\n    }, __jsx(Switch, {\n      onChange: onChange,\n      unCheckedChildren: \"Hide Same Items\",\n      checkedChildren: \"Show All Items\"\n    })) : null));\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Card, {\n    className: \"card-padding-0\"\n  }, __jsx(Table, {\n    bordered: true,\n    row: \"key\",\n    className: \"compare-table\",\n    title: props.showTitle == null || props.showTitle == true ? function () {\n      return _renderTableTitle();\n    } : null,\n    scroll: {\n      x: 1000,\n      y: 1000\n    },\n    expandedRowKeys: expandedRow,\n    onExpandedRowsChange: function onExpandedRowsChange(e) {\n      setExpandedRow(e);\n    },\n    columns: columns,\n    pagination: false,\n    dataSource: filteredCompareData\n  })));\n};\n\n_s(CarspecsCompareTable, \"zfOmAOtZUDzTh01FeY7T6BINq9Y=\");\n\n_c = CarspecsCompareTable;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    newCars: state.newCars\n  };\n};\n\nvar mapDispatchToProps = {\n  loading: loading,\n  filteredCompareData: filteredCompareData,\n  fetchDetails: fetchDetails\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(CarspecsCompareTable);\n\nvar _c;\n\n$RefreshReg$(_c, \"CarspecsCompareTable\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/compare/CarspecsCompareTable.jsx"],"names":["Card","message","Switch","Table","_","React","useEffect","useState","connect","fetchDetails","filteredCompareData","arrayLengthCount","isValidNumber","notEmptyLength","client","loading","CarspecsCompareTable","props","carspecs","setCarspecs","setFilteredCompareData","expandedRow","setExpandedRow","columns","setColumns","key","name","mainCategory","setMainCategory","updateTableCols","data","colObj","title","dataIndex","width","fixed","render","text","row","children","colSpan","length","field","forEach","item","index","push","capitalize","make","model","variant","console","log","cloneDeep","isNaN","parseInt","limit","slice","warning","findById","service","find","query","_id","$in","then","res","err","error","filteringCompareData","expandAllRow","baseCategory","rows","allCategory","map","mainCategoryRow","splitObj","Object","entries","splitValue","selectedBase","category","value","specification","compact","concat","unionBy","uniqBy","groupLimit","take","rowData","compareCarIndex","specItem","specificationIndex","toLower","selectedRowChildren","child","temp","onChange","checked","hideSameDetails","finalData","compareFields","findRowCompareFields","uniqValue","uniq","removeRowData","childrenRowData","returnDataOnly","filter","obj","regex","RegExp","test","filteredChildren","childrenRow","keys","shrinkAllRow","_renderTableTitle","rowExpandControl","e","hideExpandControl","showTitle","x","y","mapStateToProps","state","newCars","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { Card, message, Switch, Table } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { fetchDetails, filteredCompareData } from '../../redux/actions/newcars-actions';\nimport { arrayLengthCount, isValidNumber, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { loading } from '../../redux/actions/app-actions';\n\nloading\nconst CarspecsCompareTable = (props) => {\n    const [carspecs, setCarspecs] = useState([])\n    const [filteredCompareData, setFilteredCompareData] = useState([])\n    const [expandedRow, setExpandedRow] = useState([])\n    const [columns, setColumns] = useState([])\n\n    const [mainCategory, setMainCategory] = useState([\n        { key: 'engineCapacity', name: 'Engine Capacity' },\n        { key: 'transmission', name: 'Transmission' },\n        { key: 'year', name: 'Year' },\n        { key: 'mileage', name: 'Mileage' },\n        { key: 'bodyType', name: 'Body Type' },\n    ])\n\n    function updateTableCols(data) {\n\n        let colObj = [\n            {\n                title: 'Name',\n                dataIndex: 'name',\n                key: 'name',\n                width: '250px',\n                fixed: 'left',\n                render: (text, row) => {\n                    if (notEmptyLength(row.children)) {\n                        return {\n                            children: <span><strong>{row.name}</strong></span>,\n                            props: {\n                                colSpan: notEmptyLength(data) ? data.length + 1 : 1,\n                            },\n                        };\n                    } else {\n                        if (row.name) {\n                            return {\n                                children: <span>{row.name}</span>,\n                            };\n                        } else {\n                            return {\n                                children: <span>{row.field}</span>,\n                            };\n                        }\n                    }\n                },\n            }\n        ];\n        if (notEmptyLength(data)) {\n\n            data.forEach(function (item, index) {\n                colObj.push(\n                    {\n                        title: `${_.capitalize(item.make)} ${_.capitalize(item.model)} ${_.capitalize(item.variant)}`,\n                        dataIndex: `compare${index}`,\n                        key: `compare${index}`,\n                        width: arrayLengthCount(data) > 4 ? '250px' : null,\n                        render: (text, row) => {\n                            if (notEmptyLength(row.children)) {\n                                return {\n                                    props: {\n                                        colSpan: 0,\n                                    },\n                                };\n                            } else {\n                                if (row[`compare${index}`]) {\n                                    return {\n                                        children: <span>{row[`compare${index}`]}</span>,\n                                    };\n                                } else {\n                                    return {\n                                        children: <span>-</span>,\n                                    };\n                                }\n                            }\n                        },\n                    },\n                )\n            })\n\n        }\n        setColumns(colObj);\n    }\n\n    useEffect(() => {\n\n        console.log(props.data);\n        if (notEmptyLength(props.data)) {\n            let data = _.cloneDeep(props.data);\n            if (!isNaN(parseInt(props.limit)) && data.length > parseInt(props.limit)) {\n                data = _.slice(data, 0, parseInt(props.limit));\n                message.warning(`Maximum ${parseInt(props.limit)} items to compare. Removed overflow items.`)\n            }\n\n            if (props.findById) {\n                props.loading(true);\n                client.service('carspecs').find({\n                    query: {\n                        _id: {\n                            $in: data,\n                        }\n                    }\n                }).then(res => {\n                    console.log(res);\n                    props.loading(false);\n \n                    if (notEmptyLength(res.data)) {\n                        setCarspecs(res.data);\n                    } else {\n                        setCarspecs([]);\n                    }\n\n                }).catch(err => {\n                    props.loading(false);\n                    message.error(err.message)\n                });\n\n            } else {\n                setCarspecs(data);\n            }\n        } else {\n            setCarspecs([]);\n        }\n    }, [props.data])\n\n    useEffect(() => {\n        if (notEmptyLength(carspecs)) {\n            filteringCompareData(carspecs)\n            updateTableCols(carspecs);\n        }\n    }, [carspecs])\n\n    useEffect(() => {\n\n        expandAllRow();\n    }, [filteredCompareData])\n\n\n\n    function filteringCompareData(data) {\n\n        let baseCategory = _.cloneDeep(mainCategory)\n        let rows = []\n\n\n        if (notEmptyLength(data)) {\n\n            let allCategory = [];\n\n            //Restruct data\n            _.map(data, function (item) {\n                //prepare base field row\n                let mainCategoryRow = [];\n                let splitObj = Object.entries(item);\n\n                //IF it is main category data push into specification\n                _.forEach(splitObj, function (splitValue) {\n                    let selectedBase = _.find(baseCategory, ['key', splitValue[0]])\n\n                    if (notEmptyLength(selectedBase)) {\n                        mainCategoryRow.push({\n                            category: 'Main Category',\n                            field: selectedBase.name,\n                            value: splitValue[1],\n                        })\n                    }\n                });\n                if(!item.specification){\n                    return item\n                }\n                //Push Main Category to Specification\n                item.specification = _.compact(_.concat(mainCategoryRow, item.specification));\n\n                //Find all distinct category\n                allCategory = _.unionBy(\n                    _.map(_.uniqBy(item.specification, 'category'), 'category')\n                    ,\n                    allCategory\n                );\n\n                return item;\n            });\n\n            if(isValidNumber(parseInt(props.groupLimit))){\n                allCategory = _.take(allCategory, parseInt(props.groupLimit))\n            }\n\n            //prepare expandable rows\n            if (notEmptyLength(allCategory)) {\n                _.forEach(allCategory, function (category) {\n                    let rowData = {\n                        key: category,\n                        name: category,\n                        children: [],\n                    }\n\n                    _.forEach(_.compact(data), function (item, compareCarIndex) {\n                        _.forEach(_.compact(item.specification), function (specItem, specificationIndex) {\n                            //Found record then push to children\n                            if (_.toLower(category) == _.toLower(specItem.category)) {\n\n                                let selectedRowChildren = {};\n\n                                //find if children already inserted\n                                selectedRowChildren = _.find(rowData.children, function (child) {\n                                    return child.name == specItem.field;\n                                })\n\n                                if (notEmptyLength(selectedRowChildren)) {\n                                    //inserted\n                                    selectedRowChildren[`compare${compareCarIndex}`] = specItem.value;\n                                } else {\n                                    //haven't insert yet\n                                    let temp = { name: specItem.field, key: `${specItem.field}-${specificationIndex}` };\n                                    temp[`compare${compareCarIndex}`] = specItem.value;\n                                    rowData.children.push(temp)\n                                }\n                            }\n\n\n                        })\n\n                    });\n\n                    rows.push(rowData);\n\n                })\n\n            }\n\n\n        }\n\n        setFilteredCompareData(rows)\n    }\n\n    function onChange(checked) {\n        if (checked) {\n            hideSameDetails(filteredCompareData)\n        } else {\n            filteringCompareData(carspecs);\n        }\n    }\n\n    function hideSameDetails(data) {\n\n        if (notEmptyLength(data)) {\n            let finalData = _.cloneDeep(data);\n\n            data.forEach(function (rowData) {\n\n                let compareFields = findRowCompareFields(rowData, true);\n\n                if (notEmptyLength(compareFields)) {\n\n                    //Check only more than 1 data\n                    if (compareFields.length > 1) {\n                        let uniqValue = _.uniq(compareFields);\n\n                        //Is same\n                        if (uniqValue.length <= 1) {\n                            finalData = removeRowData(finalData, rowData.key);\n                        }\n\n                    }\n                } else {\n\n                    if (notEmptyLength(rowData.children)) {\n\n                        _.forEach(rowData.children, function (childrenRowData) {\n                            compareFields = findRowCompareFields(childrenRowData, true);\n                            if (notEmptyLength(compareFields)) {\n                                if (compareFields.length > 1) {\n                                    let uniqValue = _.uniq(compareFields);\n\n                                    //Is same\n                                    if (uniqValue.length <= 1) {\n                                        finalData = removeRowData(finalData, childrenRowData.key);\n                                    }\n                                }\n                            } else {\n                                finalData = removeRowData(finalData, childrenRowData.key);\n                            }\n                        })\n\n                    } else {\n                        finalData = removeRowData(finalData, rowData.key);\n                    }\n                }\n\n            })\n\n\n            setFilteredCompareData(finalData);\n\n        } else {\n            return data;\n        }\n    }\n\n    function findRowCompareFields(row, returnDataOnly) {\n        if (notEmptyLength(row)) {\n            let splitObj = Object.entries(row);\n            let compareFields = _.filter(splitObj, function (obj) {\n                let regex = new RegExp('^compare', 'i');\n                return regex.test(obj[0]);\n            })\n            if (returnDataOnly) {\n                return _.map(compareFields, function (item) {\n                    return item[1];\n                });\n            } else {\n                return compareFields;\n            }\n\n        } else {\n            return [];\n        }\n    }\n\n    function removeRowData(data, key) {\n        if (key) {\n            let finalData = _.cloneDeep(data);\n\n            //Check for non expandable row first\n            finalData = _.filter(finalData, function (row) {\n                return row.key != key;\n            })\n\n            //Check for expandable row\n            finalData = _.compact(\n                _.map(finalData, function (row) {\n\n                    if (notEmptyLength(row.children)) {\n                        let filteredChildren = _.filter(row.children, function (childrenRow) {\n                            return childrenRow.key != key;\n                        })\n\n                        //Dont have any children now\n                        if (!notEmptyLength(filteredChildren)) {\n                            return null;\n                        } else {\n                            row.children = filteredChildren\n                            return row;\n                        }\n                    }\n\n                    return row;\n                })\n            )\n\n\n            return finalData;\n        } else {\n            return null;\n        }\n    }\n\n    function expandAllRow() {\n        if (notEmptyLength(filteredCompareData)) {\n            let keys = _.map(filteredCompareData, 'key');\n            if (notEmptyLength(keys)) {\n                setExpandedRow(keys);\n            }\n        } else {\n            setExpandedRow([]);\n        }\n    }\n\n    function shrinkAllRow() {\n        setExpandedRow([]);\n    }\n\n    const _renderTableTitle = () => {\n        return (\n            <React.Fragment>\n                <div className=' flex-justify-start w-100 flex-items-align-center '>\n                    {\n                        props.rowExpandControl == null || props.rowExpandControl == true ?\n                            <span className='d-inline-block margin-x-sm' >\n                                <Switch onChange={(e) => { e ? expandAllRow() : shrinkAllRow() }} defaultChecked unCheckedChildren=\"Expand Rows\" checkedChildren=\"Shrink Rows\" />\n                            </span>\n                            :\n                            null\n                    }\n                    {\n                        (props.hideExpandControl == null || props.hideExpandControl == true) && arrayLengthCount(carspecs) > 1 ?\n                            <span className='d-inline-block margin-x-sm' >\n                                <Switch onChange={onChange} unCheckedChildren=\"Hide Same Items\" checkedChildren=\"Show All Items\" />\n                            </span>\n                            :\n                            null\n                    }\n                </div>\n            </React.Fragment>\n        )\n    }\n\n    return (\n\n        <React.Fragment>\n            <Card className=\"card-padding-0\" >\n                <Table\n                    bordered\n                    row=\"key\"\n                    className=\"compare-table\"\n                    title={props.showTitle == null || props.showTitle == true ? () => _renderTableTitle() : null}\n                    scroll={{ x: 1000, y: 1000 }}\n                    expandedRowKeys={expandedRow}\n                    onExpandedRowsChange={(e) => { setExpandedRow(e); }}\n                    columns={columns}\n                    pagination={false}\n                    dataSource={filteredCompareData} />\n            </Card>\n        </React.Fragment>\n    );\n}\n\nconst mapStateToProps = state => ({\n    newCars: state.newCars,\n});\n\nconst mapDispatchToProps = {\n    loading: loading,\n    filteredCompareData: filteredCompareData,\n    fetchDetails: fetchDetails\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CarspecsCompareTable);"]},"metadata":{},"sourceType":"module"}