{"ast":null,"code":"var __jsx = React.createElement;\nimport { Button, Form, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport client from '../../feathers';\nimport { setUser } from '../../redux/actions/user-actions';\nimport { notEmptyLength } from '../../common-function';\n\nconst Wishlist = props => {\n  const {\n    0: wishlist,\n    1: setWishlist\n  } = useState([]);\n  const {\n    0: confirmModalState,\n    1: setConfirmModalState\n  } = useState(false);\n  const {\n    0: isSaved,\n    1: setIsSaved\n  } = useState(false);\n  useEffect(() => {\n    init();\n  }, [props.saverId, props[props.type + 'Id']]);\n\n  function init() {\n    if (!_.isEmpty(props.saverId) && !_.isEmpty(props[props.type + 'Id'])) {\n      let query = {};\n      query[props.type + 'Id'] = props[props.type + 'Id'];\n      query.type = props.type;\n      query.saverId = props.saverId;\n      client.service('wishlists').find({\n        query: query\n      }).then(res => {\n        if (notEmptyLength(res.data)) {\n          setWishlist(res.data[0]);\n          setIsSaved(true);\n        } else {\n          setWishlist(null);\n          setIsSaved(false);\n        }\n      }).catch(err => {\n        message.error(err.message);\n      });\n    }\n  }\n\n  function handleSuccess(success) {\n    setConfirmModalState(false);\n\n    if (props.handleSuccess) {\n      props.handleSuccess(success);\n    }\n  }\n\n  function handleError(error) {\n    setConfirmModalState(false);\n\n    if (props.handleError) {\n      props.handleError(error);\n    }\n  }\n\n  function handleSubmit() {\n    if (!_.isEmpty(props.saverId) && !_.isEmpty(props[props.type + 'Id'])) {\n      let promises = [];\n      promises.push(client.authenticate());\n\n      if (!isSaved) {\n        let data = {};\n        data.type = props.type;\n        data.saverId = props.saverId;\n        data[props.type + 'Id'] = props[props.type + 'Id'];\n        promises.push(client.service('wishlists').create(data));\n      } else {\n        promises.push(client.service('wishlists').remove(wishlist._id));\n      }\n\n      props.loading(true); //Write in wishlist model\n\n      Promise.all(promises).then(([auth, wishlistRes]) => {\n        props.loading(false);\n        handleSuccess({\n          type: isSaved ? 'remove' : 'save',\n          data: wishlistRes\n        });\n        init();\n      }).catch(error => {\n        props.loading(false);\n        handleError({\n          message: \"Submit Wishlist Failed\"\n        });\n      });\n    } else {\n      handleError({\n        message: \"Something Went Wrong!\"\n      });\n    }\n  }\n\n  ;\n\n  function handleChange() {\n    if (!props.saverId) {\n      props.loginMode(true);\n      handleError({\n        message: 'Please login to save the wishlist.'\n      });\n      return null;\n    }\n\n    if (!props[props.type + 'Id']) {\n      handleError({\n        message: 'Item not found!'\n      });\n      return null;\n    }\n\n    if (isSaved) {\n      setConfirmModalState(true);\n    } else {\n      handleSubmit();\n    }\n  }\n\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: confirmModalState,\n    title: \"Are you sure?\",\n    maskClosable: true,\n    centered: true,\n    onOk: e => {\n      handleSubmit();\n      setConfirmModalState(false);\n    },\n    onCancel: e => {\n      setConfirmModalState(false);\n    }\n  }, __jsx(\"div\", null, \"Do you want to remove this product from your wishlist?\")), isSaved ? __jsx(\"a\", {\n    onClick: () => props.readOnly ? null : handleChange()\n  }, props.savedButton ? props.savedButton() : __jsx(Button, {\n    style: {\n      color: '#F57F17'\n    }\n  }, \"Saved\")) : __jsx(\"a\", {\n    onClick: () => props.readOnly ? null : handleChange()\n  }, props.saveButton ? props.saveButton() : __jsx(Button, null, \"Save\")));\n};\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user\n});\n\nconst mapDispatchToProps = {\n  loginMode: loginMode,\n  loading: loading,\n  setUser: setUser\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(Wishlist)));","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/general/Wishlist.jsx"],"names":["Button","Form","message","Modal","_","React","useEffect","useState","connect","withRouter","loading","loginMode","client","setUser","notEmptyLength","Wishlist","props","wishlist","setWishlist","confirmModalState","setConfirmModalState","isSaved","setIsSaved","init","saverId","type","isEmpty","query","service","find","then","res","data","catch","err","error","handleSuccess","success","handleError","handleSubmit","promises","push","authenticate","create","remove","_id","Promise","all","auth","wishlistRes","handleChange","className","style","e","readOnly","savedButton","color","saveButton","mapStateToProps","state","app","user","mapDispatchToProps"],"mappings":"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","sourcesContent":["import { Button, Form, message, Modal } from 'antd';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport client from '../../feathers';\nimport { setUser } from '../../redux/actions/user-actions';\nimport { notEmptyLength } from '../../common-function';\n\n\n\nconst Wishlist = (props) => {\n\n\n    const [wishlist, setWishlist] = useState([]);\n    const [confirmModalState, setConfirmModalState] = useState(false);\n    const [isSaved, setIsSaved] = useState(false);\n\n    useEffect(() => {\n        init();\n    }, [props.saverId, props[props.type + 'Id']])\n\n    function init() {\n        if (!_.isEmpty(props.saverId) && !_.isEmpty(props[props.type + 'Id'])) {\n            let query = {};\n            query[props.type + 'Id'] = props[props.type + 'Id'];\n            query.type = props.type;\n            query.saverId = props.saverId\n\n            client.service('wishlists').find({\n                query: query\n            }).then(res => {\n                if (notEmptyLength(res.data)) {\n                    setWishlist(res.data[0])\n                    setIsSaved(true);\n                } else {\n                    setWishlist(null)\n                    setIsSaved(false);\n                }\n            }).catch(err => {\n                message.error(err.message)\n            });\n        }\n    }\n\n    function handleSuccess(success) {\n        setConfirmModalState(false);\n        if (props.handleSuccess) {\n            props.handleSuccess(success);\n        }\n    }\n\n\n    function handleError(error) {\n        setConfirmModalState(false);\n        if (props.handleError) {\n            props.handleError(error);\n        }\n    }\n\n    function handleSubmit() {\n        if (!_.isEmpty(props.saverId) && !_.isEmpty(props[props.type + 'Id'])) {\n            let promises = [];\n            promises.push(client.authenticate());\n            if (!isSaved) {\n                let data = {}\n                data.type = props.type;\n                data.saverId = props.saverId;\n                data[props.type + 'Id'] = props[props.type + 'Id'];\n                promises.push(client.service('wishlists').create(data))\n            } else {\n                promises.push(client.service('wishlists').remove(wishlist._id))\n            }\n\n            props.loading(true);\n            //Write in wishlist model\n            Promise.all(promises).then(([auth, wishlistRes]) => {\n                props.loading(false);\n                handleSuccess({\n                    type: isSaved ? 'remove' : 'save',\n                    data: wishlistRes\n                });\n\n                init();\n\n            }).catch(error => {\n                props.loading(false);\n                handleError({ message: \"Submit Wishlist Failed\" })\n            })\n        } else {\n            handleError({ message: \"Something Went Wrong!\" })\n\n        }\n\n\n    };\n\n    function handleChange() {\n\n        if (!props.saverId) {\n            props.loginMode(true);\n            handleError({ message: 'Please login to save the wishlist.' });\n            return null;\n        }\n\n        if (!props[props.type + 'Id']) {\n            handleError({ message: 'Item not found!' });\n            return null;\n        }\n\n        if (isSaved) {\n            setConfirmModalState(true);\n        } else {\n            handleSubmit();\n        }\n\n    }\n\n\n\n    return (\n\n        <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n            <Modal\n                visible={confirmModalState}\n                title=\"Are you sure?\"\n                maskClosable={true}\n                centered={true}\n                onOk={(e) => { handleSubmit(); setConfirmModalState(false); }}\n                onCancel={(e) => { setConfirmModalState(false) }}\n            >\n                <div>\n                    Do you want to remove this product from your wishlist?\n                </div>\n            </Modal>\n\n            {\n                isSaved ?\n                    <a onClick={() => props.readOnly ? null : handleChange()}>\n\n                        {\n                            props.savedButton ?\n                                props.savedButton()\n                                :\n                                <Button style={{ color: '#F57F17' }}>Saved</Button>\n                        }\n                    </a>\n                    :\n                    <a onClick={() => props.readOnly ? null : handleChange()}>\n                        {\n                            props.saveButton ?\n                                props.saveButton()\n                                :\n                                <Button>Save</Button>\n                        }\n                    </a>\n            }\n\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\nconst mapDispatchToProps = {\n    loginMode: loginMode,\n    loading: loading,\n    setUser: setUser,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(Wishlist)));"]},"metadata":{},"sourceType":"module"}