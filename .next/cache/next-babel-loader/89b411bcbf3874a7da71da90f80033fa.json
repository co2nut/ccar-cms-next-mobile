{"ast":null,"code":"var __jsx = React.createElement;\nimport { Button, Form, message, Modal } from 'antd';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport { notEmptyLength } from '../../common-function';\n\nconst HideReviewButton = props => {\n  const {\n    0: confirmModalState,\n    1: setConfirmModalState\n  } = useState(false);\n\n  function hideReview(data) {\n    if (props.user.authenticated && notEmptyLength(data) && data._id) {\n      if (notEmptyLength(data.hideBy)) {\n        let existed = data.hideBy.some(function (item) {\n          return item.userId == props.user.info.user._id;\n        });\n\n        if (!existed) {\n          props.loading(true);\n          client.authenticate().then(res => {\n            props.loading(false);\n            client.service('rating').patch(data._id, {\n              hideBy: data.hideBy.concat([{\n                userId: props.user.info.user._id\n              }])\n            }).then(res => {\n              message.success('You hide the review.');\n\n              if (props.handleSuccess) {\n                props.handleSuccess(res);\n              }\n            });\n          }).catch(err => {\n            props.loading(false);\n            message.error(err.message);\n\n            if (props.handleError) {\n              props.handleError(err);\n            }\n          });\n        }\n      } else {\n        props.loading(true);\n        client.authenticate().then(res => {\n          props.loading(false);\n          client.service('rating').patch(data._id, {\n            hideBy: [{\n              userId: props.user.info.user._id\n            }]\n          }).then(res => {\n            message.success('You hide the review.');\n\n            if (props.handleSuccess) {\n              props.handleSuccess(res);\n            }\n          });\n        }).catch(err => {\n          props.loading(false);\n          message.error(err.message);\n\n          if (props.handleError) {\n            props.handleError(err);\n          }\n        });\n      }\n    } else {\n      props.loginMode(true);\n      message.error('Please login to hide this review.');\n\n      if (props.handleError) {\n        props.handleError({\n          message: 'Please login to hide this review.'\n        });\n      }\n    }\n  }\n\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: confirmModalState,\n    title: \"Are you sure?\",\n    maskClosable: true,\n    centered: true,\n    onOk: e => {\n      hideReview(props.data ? props.data : null);\n      setConfirmModalState(false);\n    },\n    onCancel: e => {\n      setConfirmModalState(false);\n    }\n  }, __jsx(\"div\", null, \"Do you want to hide this review ?\")), __jsx(\"a\", {\n    onClick: () => {\n      setConfirmModalState(true);\n    }\n  }, props.button ? props.button() : __jsx(Button, {\n    type: \"warning\",\n    icon: \"eye-invisible\"\n  }, \"Hide post\")));\n};\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user\n});\n\nconst mapDispatchToProps = {\n  loginMode: loginMode,\n  loading: loading\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(HideReviewButton)));","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/rating/HideReviewButton.jsx"],"names":["Button","Form","message","Modal","React","useState","connect","client","withRouter","loading","loginMode","notEmptyLength","HideReviewButton","props","confirmModalState","setConfirmModalState","hideReview","data","user","authenticated","_id","hideBy","existed","some","item","userId","info","authenticate","then","res","service","patch","concat","success","handleSuccess","catch","err","error","handleError","className","style","e","button","mapStateToProps","state","app","mapDispatchToProps","create"],"mappings":"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","sourcesContent":["import { Button, Form, message, Modal } from 'antd';\nimport React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport { withRouter } from 'next/router';\nimport { loading, loginMode } from '../../redux/actions/app-actions';\nimport { notEmptyLength } from '../../common-function';\n\n\n\nconst HideReviewButton = (props) => {\n\n\n    const [confirmModalState, setConfirmModalState] = useState(false);\n\n    function hideReview(data) {\n\n        if (props.user.authenticated && notEmptyLength(data) && data._id) {\n\n            if (notEmptyLength(data.hideBy)) {\n                let existed = data.hideBy.some(function (item) {\n                    return item.userId == props.user.info.user._id;\n                })\n\n                if (!existed) {\n\n                    props.loading(true);\n                    client.authenticate()\n                        .then((res) => {\n                            props.loading(false);\n                            client.service('rating').patch(data._id, {\n                                hideBy: data.hideBy.concat([{ userId: props.user.info.user._id }])\n                            }).then((res) => {\n                                message.success('You hide the review.');\n                                if (props.handleSuccess) {\n                                    props.handleSuccess(res);\n                                }\n                            })\n                        })\n                        .catch((err) => {\n                            props.loading(false);\n                            message.error(err.message);\n                            if (props.handleError) {\n                                props.handleError(err);\n                            }\n                        })\n                }\n            } else {\n\n                props.loading(true);\n                client.authenticate()\n                    .then((res) => {\n                        props.loading(false);\n                        client.service('rating').patch(data._id, {\n                            hideBy: [{ userId: props.user.info.user._id }]\n                        }).then((res) => {\n                            message.success('You hide the review.');\n                            if (props.handleSuccess) {\n                                props.handleSuccess(res);\n                            }\n                        })\n                    })\n                    .catch((err) => {\n                        props.loading(false);\n                        message.error(err.message);\n                        if (props.handleError) {\n                            props.handleError(err);\n                        }\n                    })\n\n            }\n\n        } else {\n            props.loginMode(true);\n            message.error('Please login to hide this review.');\n            if (props.handleError) {\n                props.handleError({ message: 'Please login to hide this review.' });\n            }\n        }\n    }\n\n    return (\n\n        <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n            <Modal\n                visible={confirmModalState}\n                title=\"Are you sure?\"\n                maskClosable={true}\n                centered={true}\n                onOk={(e) => { hideReview(props.data ? props.data : null); setConfirmModalState(false); }}\n                onCancel={(e) => { setConfirmModalState(false) }}\n            >\n                <div>\n                    Do you want to hide this review ?\n                </div>\n            </Modal>\n\n\n            <a onClick={() => {\n                setConfirmModalState(true);\n            }}>\n\n                {\n                    props.button ?\n                        props.button()\n                        :\n                        <Button type=\"warning\" icon=\"eye-invisible\">\n                            Hide post\n                        </Button>\n                }\n            </a>\n\n        </span>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n});\n\nconst mapDispatchToProps = {\n    loginMode: loginMode,\n    loading: loading,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(HideReviewButton)));"]},"metadata":{},"sourceType":"module"}