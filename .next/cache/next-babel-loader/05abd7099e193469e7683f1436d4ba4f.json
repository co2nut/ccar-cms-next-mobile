{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport axios from 'axios';\nimport _ from 'lodash';\nimport Head from 'next/head';\nimport { useEffect, useState } from 'react';\nimport ReduxPersistWrapper from '../../../components/general/ReduxPersistWrapper';\nimport ViewCarDetailsPage from '../../../components/product-list/page/ViewCarDetailsPage';\nimport client from '../../../feathers';\nimport { withRouter } from 'next/router';\nimport { checkEnvReturnCmsUrl } from '../../../functionContent';\nimport { connect } from 'react-redux';\nimport ViewCarDetails2Page from '../../../components/product-list/page/ViewCarDetails2Page';\n\nvar moment = require('moment');\n\nconst App = props => {\n  const carInfo = _.get(props, 'carInfo') || {};\n  const companyInfo = _.get(props, 'companyInfo') || {};\n\n  const url = \"https://uat2ssr.ccar.my/viewCar/\" + _.get(carInfo, '_id');\n\n  const oriUrl = !_.get(carInfo, 'code') ? \"https://ccar.my/viewCar/\" + _.get(carInfo, '_id') : \"https://ccar.my\";\n\n  let desc = _.get(carInfo, 'user.fullName') + ' | ' + _.get(companyInfo, 'name');\n\n  let area = _.get(companyInfo, 'area') ? ' | ' + (_.get(companyInfo, 'area') || '').toUpperCase() : '';\n  desc = desc + area; // if (carInfo.code) {\n  //     return null\n  // } else {\n\n  return __jsx(React.Fragment, null, __jsx(ReduxPersistWrapper, {\n    cookie: props.cookie\n  }, props.app.initedRedux ? __jsx(ViewCarDetailsPage, {\n    data: carInfo || {}\n  }) // <ViewCarDetails2Page data={carInfo || {}} />\n  : null)); // }\n};\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user,\n  productsList: state.productsList\n});\n\nconst mapDispatchToProps = {};\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(App));\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  try {\n    let id = _.get(req, `params.id`) || _.get(req, `query.id`);\n\n    let carInfo = {\n      condition: '',\n      companys: {},\n      carspecsAll: {},\n      registrationUrl: {}\n    };\n    let basePath = checkEnvReturnCmsUrl(client.io.io.uri);\n\n    if (id) {\n      carInfo = await client.service('product-ads').find({\n        query: {\n          _id: new Object(id),\n          $populate: ['companyId', 'carspecsId', 'createdBy']\n        }\n      });\n      carInfo = _.get(carInfo, ['data']) || [];\n      carInfo = carInfo.map(function (v) {\n        v.companys = v.companyId;\n        v.carspecsAll = v.carspecsId;\n        return v;\n      });\n      carInfo = _.get(carInfo, [0]) || {};\n      const currentDateTime = moment().format();\n      carInfo.addonSpotlight = _.find(carInfo.addon, {\n        'addonType': 'spotlight'\n      });\n      carInfo.addonSpicydeal = _.find(carInfo.addon, {\n        'addonType': 'spicydeal'\n      });\n      carInfo.addonKingadType = _.find(carInfo.addon, {\n        'addonType': 'kingad',\n        'showPrice': 'show'\n      });\n      carInfo.addonKingadType2 = _.find(carInfo.addon, {\n        'addonType': 'kingad',\n        'showPrice': 'hide'\n      });\n      carInfo.addonKingadType3 = _.find(carInfo.addon, {\n        'addonType': 'kingad',\n        'showPrice': 'highlight'\n      });\n      let priority = '';\n\n      if (priority === '') {\n        if (carInfo.addonKingadType) {\n          if (currentDateTime > moment(carInfo.addonKingadType.startDate).format() && currentDateTime < moment(carInfo.addonKingadType.endDate).format()) {\n            priority = 'addonKingadType';\n            carInfo.priority = 'addonKingadType';\n            carInfo.addonKingadType.endDate = moment(carInfo.addonKingadType.endDate).format();\n            carInfo.addonKingadType.startDate = moment(carInfo.addonKingadType.startDate).format();\n          }\n        }\n      }\n\n      if (priority === '') {\n        if (carInfo.addonKingadType2) {\n          if (currentDateTime > moment(carInfo.addonKingadType2.startDate).format() && currentDateTime < moment(carInfo.addonKingadType2.endDate).format()) {\n            priority = 'addonKingadType2';\n            carInfo.priority = 'addonKingadType2';\n            carInfo.addonKingadType2.startDate = moment(carInfo.addonKingadType2.startDate).format();\n            carInfo.addonKingadType2.endDate = moment(carInfo.addonKingadType2.endDate).format();\n          }\n        }\n      }\n\n      if (priority === '') {\n        if (carInfo.addonKingadType3) {\n          if (currentDateTime > moment(carInfo.addonKingadType3.startDate).format() && currentDateTime < moment(carInfo.addonKingadType3.endDate).format()) {\n            priority = 'addonKingadType3';\n            carInfo.priority = 'addonKingadType3';\n            carInfo.addonKingadType3.startDate = moment(carInfo.addonKingadType3.startDate).format();\n            carInfo.addonKingadType3.endDate = moment(carInfo.addonKingadType3.endDate).format();\n          }\n        }\n      }\n\n      if (priority === '') {\n        if (carInfo.addonSpicydeal) {\n          if (currentDateTime > moment(carInfo.addonSpicydeal.startDate).format() && currentDateTime < moment(carInfo.addonSpicydeal.endDate).format()) {\n            priority = 'addonSpicydeal';\n            carInfo.priority = 'addonSpicydeal';\n            carInfo.addonSpicydeal.startDate = moment(carInfo.addonSpicydeal.startDate).format();\n            carInfo.addonSpicydeal.endDate = moment(carInfo.addonSpicydeal.endDate).format();\n          }\n        }\n      }\n\n      if (priority === '') {\n        if (carInfo.addonSpotlight) {\n          if (currentDateTime > moment(carInfo.addonSpotlight.startDate).format() && currentDateTime < moment(carInfo.addonSpotlight.endDate).format()) {\n            priority = 'addonSpotlight';\n            carInfo.priority = 'addonSpotlight';\n            carInfo.addonSpotlight.startDate = moment(carInfo.addonSpotlight.startDate).format();\n            carInfo.addonSpotlight.endDate = moment(carInfo.addonSpotlight.endDate).format();\n          }\n        }\n      }\n    }\n\n    if (!carInfo.addonSpotlight) {\n      carInfo.addonSpotlight = null;\n    }\n\n    if (!carInfo.addonSpicydeal) {\n      carInfo.addonSpicydeal = null;\n    }\n\n    if (!carInfo.addonKingadType) {\n      carInfo.addonKingadType = null;\n    }\n\n    if (!carInfo.addonKingadType2) {\n      carInfo.addonKingadType2 = null;\n    }\n\n    if (!carInfo.addonKingadType3) {\n      carInfo.addonKingadType3 = null;\n    }\n\n    let title = _.get(carInfo, ['title']) || null;\n    let description = `${_.get(carInfo, 'companyId.name') || ''} | ${_.get(carInfo, 'description') || ''}` || null;\n\n    let ogDescription = _.get(carInfo, 'user.fullName') + ' | ' + _.get(carInfo, 'companyId.name');\n\n    let imageUrl = (_.get(carInfo, ['carUrl', 0, 'url']) || '').indexOf('.jpg') >= 0 ? _.get(carInfo, ['carUrl', 0, 'url']) : (_.get(carInfo, ['carUrl', 0, 'url']) || '') + '.jpg';\n    let url = `${basePath}${req.url || ''}`;\n    return {\n      props: {\n        carInfo: carInfo || {},\n        // dealerInfo:json2,\n        companyInfo: _.get(carInfo, ['companyId']) || {},\n        cookie: _.get(req, ['headers', 'cookie']) || null,\n        seoData: {\n          title: title,\n          description: description,\n          facebookAppId: \"747178012753410\",\n          canonical: url,\n          openGraph: {\n            title: _.get(carInfo, ['title']) || null,\n            description: description,\n            url: url,\n            type: 'website',\n            site_name: 'CCAR SDN BHD',\n            images: [{\n              url: imageUrl,\n              alt: `${_.get(carInfo, 'carspec.make') || ''} ${_.get(carInfo, 'carspec.model' || '')} image` || 'Car Sample Image'\n            }]\n          }\n        }\n      }\n    };\n  } catch (error) {\n    console.log(error);\n    return {\n      props: {\n        carInfo: {},\n        // dealerInfo:json2,\n        companyInfo: {},\n        cookie: _.get(req, ['headers', 'cookie']) || null\n      }\n    };\n  }\n}","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/pages/viewCar/[id]/index.js"],"names":["axios","_","Head","useEffect","useState","ReduxPersistWrapper","ViewCarDetailsPage","client","withRouter","checkEnvReturnCmsUrl","connect","ViewCarDetails2Page","moment","require","App","props","carInfo","get","companyInfo","url","oriUrl","desc","area","toUpperCase","cookie","app","initedRedux","mapStateToProps","state","user","productsList","mapDispatchToProps","getServerSideProps","req","res","id","condition","companys","carspecsAll","registrationUrl","basePath","io","uri","service","find","query","_id","Object","$populate","map","v","companyId","carspecsId","currentDateTime","format","addonSpotlight","addon","addonSpicydeal","addonKingadType","addonKingadType2","addonKingadType3","priority","startDate","endDate","title","description","ogDescription","imageUrl","indexOf","seoData","facebookAppId","canonical","openGraph","type","site_name","images","alt","error","console","log"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport _ from 'lodash'\nimport Head from 'next/head'\nimport { useEffect, useState } from 'react'\nimport ReduxPersistWrapper from '../../../components/general/ReduxPersistWrapper'\nimport ViewCarDetailsPage from '../../../components/product-list/page/ViewCarDetailsPage'\nimport client from '../../../feathers'\nimport { withRouter } from 'next/router'\nimport { checkEnvReturnCmsUrl } from '../../../functionContent'\nimport { connect } from 'react-redux'\nimport ViewCarDetails2Page from '../../../components/product-list/page/ViewCarDetails2Page'\nvar moment = require('moment');\nconst App = (props) => {\n    const carInfo = _.get(props, 'carInfo') || {};\n    const companyInfo = _.get(props, 'companyInfo') || {};\n\n    const url = \"https://uat2ssr.ccar.my/viewCar/\" + _.get(carInfo, '_id')\n    const oriUrl = !_.get(carInfo, 'code') ? \"https://ccar.my/viewCar/\" + _.get(carInfo, '_id') : \"https://ccar.my\"\n    let desc = _.get(carInfo, 'user.fullName') + ' | ' + _.get(companyInfo, 'name')\n    let area = _.get(companyInfo, 'area') ? ' | ' + (_.get(companyInfo, 'area') || '').toUpperCase() : ''\n    desc = desc + area\n\n\n\n    // if (carInfo.code) {\n    //     return null\n    // } else {\n    return (\n        <React.Fragment>\n            <ReduxPersistWrapper cookie={props.cookie}>\n                {\n                    props.app.initedRedux ?\n                        <ViewCarDetailsPage data={carInfo || {}} />\n                        // <ViewCarDetails2Page data={carInfo || {}} />\n                        :\n                        null\n                }\n            </ReduxPersistWrapper>\n        </React.Fragment>\n    )\n    // }\n\n\n}\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n    productsList: state.productsList,\n});\n\n\nconst mapDispatchToProps = {\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(App))\n\nexport async function getServerSideProps({ req, res, }) {\n    try {\n\n        let id = _.get(req, `params.id`) || _.get(req, `query.id`);\n        let carInfo = {\n            condition: '', companys: {}, carspecsAll: {}, registrationUrl: {}\n        };\n        let basePath = checkEnvReturnCmsUrl(client.io.io.uri)\n        \n        if (id) {\n\n            carInfo = await client.service('product-ads').find({\n                query: {\n                    _id: new Object(id),\n                    $populate: ['companyId', 'carspecsId', 'createdBy'],\n                }\n            })\n\n            carInfo = _.get(carInfo, ['data']) || [];\n            carInfo = carInfo.map(function (v) {\n                v.companys = v.companyId\n                v.carspecsAll = v.carspecsId\n                return v;\n            })\n            carInfo = _.get(carInfo, [0]) || {};\n            const currentDateTime = moment().format()\n\n\n            carInfo.addonSpotlight = _.find(carInfo.addon, { 'addonType': 'spotlight' })\n            carInfo.addonSpicydeal = _.find(carInfo.addon, { 'addonType': 'spicydeal' })\n            carInfo.addonKingadType = _.find(carInfo.addon, { 'addonType': 'kingad', 'showPrice': 'show' })\n            carInfo.addonKingadType2 = _.find(carInfo.addon, { 'addonType': 'kingad', 'showPrice': 'hide' })\n            carInfo.addonKingadType3 = _.find(carInfo.addon, { 'addonType': 'kingad', 'showPrice': 'highlight' })\n            let priority = ''\n            if (priority === '') {\n\n                if (carInfo.addonKingadType) {\n                    if (currentDateTime > moment(carInfo.addonKingadType.startDate).format() && currentDateTime < moment(carInfo.addonKingadType.endDate).format()) {\n                        priority = 'addonKingadType'\n                        carInfo.priority = 'addonKingadType'\n                        carInfo.addonKingadType.endDate = moment(carInfo.addonKingadType.endDate).format()\n                        carInfo.addonKingadType.startDate = moment(carInfo.addonKingadType.startDate).format()\n                    }\n                }\n            }\n\n            if (priority === '') {\n                if (carInfo.addonKingadType2) {\n                    if (currentDateTime > moment(carInfo.addonKingadType2.startDate).format() && currentDateTime < moment(carInfo.addonKingadType2.endDate).format()) {\n                        priority = 'addonKingadType2'\n                        carInfo.priority = 'addonKingadType2'\n                        carInfo.addonKingadType2.startDate = moment(carInfo.addonKingadType2.startDate).format()\n                        carInfo.addonKingadType2.endDate = moment(carInfo.addonKingadType2.endDate).format()\n                    }\n                }\n            }\n\n            if (priority === '') {\n                if (carInfo.addonKingadType3) {\n                    if (currentDateTime > moment(carInfo.addonKingadType3.startDate).format() && currentDateTime < moment(carInfo.addonKingadType3.endDate).format()) {\n                        priority = 'addonKingadType3'\n                        carInfo.priority = 'addonKingadType3'\n                        carInfo.addonKingadType3.startDate = moment(carInfo.addonKingadType3.startDate).format()\n                        carInfo.addonKingadType3.endDate = moment(carInfo.addonKingadType3.endDate).format()\n                    }\n                }\n            }\n\n            if (priority === '') {\n                if (carInfo.addonSpicydeal) {\n                    if (currentDateTime > moment(carInfo.addonSpicydeal.startDate).format() && currentDateTime < moment(carInfo.addonSpicydeal.endDate).format()) {\n                        priority = 'addonSpicydeal'\n                        carInfo.priority = 'addonSpicydeal'\n                        carInfo.addonSpicydeal.startDate = moment(carInfo.addonSpicydeal.startDate).format()\n                        carInfo.addonSpicydeal.endDate = moment(carInfo.addonSpicydeal.endDate).format()\n                    }\n                }\n            }\n\n            if (priority === '') {\n                if (carInfo.addonSpotlight) {\n                    if (currentDateTime > moment(carInfo.addonSpotlight.startDate).format() && currentDateTime < moment(carInfo.addonSpotlight.endDate).format()) {\n                        priority = 'addonSpotlight'\n                        carInfo.priority = 'addonSpotlight'\n                        carInfo.addonSpotlight.startDate = moment(carInfo.addonSpotlight.startDate).format()\n                        carInfo.addonSpotlight.endDate = moment(carInfo.addonSpotlight.endDate).format()\n                    }\n                }\n            }\n        }\n        if(!carInfo.addonSpotlight){carInfo.addonSpotlight=null}\n        if(!carInfo.addonSpicydeal){carInfo.addonSpicydeal=null}\n        if(!carInfo.addonKingadType){carInfo.addonKingadType=null}\n        if(!carInfo.addonKingadType2){carInfo.addonKingadType2=null}\n        if(!carInfo.addonKingadType3){carInfo.addonKingadType3=null}\n\n        let title = _.get(carInfo, ['title']) || null\n        let description = `${_.get(carInfo, 'companyId.name') || ''} | ${_.get(carInfo, 'description') || ''}` || null;\n         \n        let ogDescription = _.get(carInfo, 'user.fullName') + ' | ' + _.get(carInfo, 'companyId.name')\n        let imageUrl = (_.get(carInfo, ['carUrl', 0, 'url']) || '').indexOf('.jpg') >= 0 ? _.get(carInfo, ['carUrl', 0, 'url']) : (_.get(carInfo, ['carUrl', 0, 'url']) || '') + '.jpg';\n        let url = `${basePath}${req.url || ''}`;\n        return {\n            props: {\n                carInfo: carInfo || {},\n                // dealerInfo:json2,\n                companyInfo: _.get(carInfo, ['companyId']) || {},\n                cookie: _.get(req, ['headers', 'cookie']) || null,\n                seoData: {\n                    title: title,\n                    description: description,\n                    facebookAppId: \"747178012753410\",\n                    canonical: url,\n                    openGraph: {\n                        title: _.get(carInfo, ['title']) || null,\n                        description: description,\n                        url: url,\n                        type: 'website',\n                        site_name: 'CCAR SDN BHD',\n                        images: [\n                            {\n                                url: imageUrl,\n                                alt: `${_.get(carInfo, 'carspec.make') || ''} ${_.get(carInfo, 'carspec.model' || '')} image` || 'Car Sample Image',\n                            }\n                        ]\n                    }\n\n                }\n            }\n        };\n    } catch (error) {\n        console.log(error);\n        return {\n            props: {\n                carInfo: {},\n                // dealerInfo:json2,\n                companyInfo: {},\n                cookie: _.get(req, ['headers', 'cookie']) || null,\n            }\n        };\n    }\n}\n"]},"metadata":{},"sourceType":"module"}