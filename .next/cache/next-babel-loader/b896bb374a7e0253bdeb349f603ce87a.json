{"ast":null,"code":"var __jsx = React.createElement;\nimport { Form } from '@ant-design/compatible';\nimport { Button, message, Modal, Tooltip } from 'antd';\nimport _ from 'lodash';\nimport { withRouter } from 'next/dist/client/router';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { arrayLengthCount, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { loading } from '../../redux/actions/app-actions';\nimport { clearCompareProductIds, patchCompareProductIds, removeCompareProductId } from '../../redux/actions/productsList-actions';\nimport { setUser } from '../../redux/actions/user-actions';\n\nconst AddCompareProductButton = props => {\n  const {\n    0: confirmModalState,\n    1: setConfirmModalState\n  } = useState(false);\n  const {\n    0: compareLimit,\n    1: setCompareLimit\n  } = useState(4);\n  useEffect(() => {\n    setCompareLimit(_.isNaN(parseInt(props.productsList.compareLimit)) ? 4 : parseInt(props.productsList.compareLimit));\n  }, [props.productsList.compareLimit]);\n\n  function isSavedCompare(id) {\n    if (id && notEmptyLength(props.productsList.compareIds)) {\n      var check = props.productsList.compareIds.filter(function (item) {\n        return item == id;\n      });\n      return check.length > 0;\n    } else {\n      return false;\n    }\n  }\n\n  const pushToList = data => {\n    if (data._id) {\n      if (arrayLengthCount(_.get(props.productsList, ['compareIds'])) >= compareLimit) {\n        message.warning(`Maximum ${compareLimit} products in comparison list.`);\n        return;\n      }\n\n      if (notEmptyLength(props.productsList.compareIds)) {\n        let ids = [];\n        client.service('product-ads').find({\n          query: {\n            _id: {\n              $in: props.productsList.compareIds\n            }\n          }\n        }).then(res => {\n          if (notEmptyLength(res.data)) {} else {\n            props.clearCompareProductIds();\n          }\n\n          ids = _.map(_.get(res, ['data']), '_id') || [];\n          ids.push(data._id);\n          props.patchCompareProductIds(ids);\n          message.success('Added to comparison list');\n        }).catch(err => {// message.error(err.message)\n        });\n      } else {\n        message.success('Added to comparison list');\n        props.patchCompareProductIds([data._id]);\n      }\n    } else {\n      message.error(\"Product Not Found\");\n    }\n  };\n\n  function removeFromList(data) {\n    if (data._id) {\n      props.removeCompareProductId(data._id);\n      message.success('Removed from comparison list');\n    }\n  }\n\n  return __jsx(\"span\", {\n    className: props.className ? props.className : null,\n    style: props.style ? props.style : null\n  }, __jsx(Modal, {\n    visible: confirmModalState,\n    title: \"Are you sure?\",\n    maskClosable: true,\n    centered: true,\n    onOk: e => {\n      removeFromList(props.data);\n      setConfirmModalState(false);\n    },\n    onCancel: e => {\n      setConfirmModalState(false);\n    }\n  }, __jsx(\"div\", null, \" Do you want to remove this product from your comparison list? \")), __jsx(Tooltip, {\n    placement: \"top\",\n    title: \"Add me into the comparison list\"\n  }, isSavedCompare(props.data._id) ? __jsx(\"a\", {\n    onClick: () => props.readOnly ? null : setConfirmModalState(true)\n  }, props.savedButton ? props.savedButton() : __jsx(Button, {\n    type: \"normal\",\n    style: {\n      background: 'rgb(89, 54, 26)',\n      padding: 0\n    },\n    className: \"ads-purchase-button w-100\"\n  }, __jsx(\"img\", {\n    src: \"/assets/profile/icon-list/carmarket-bar-icon/compare.png\",\n    alt: \"compare\"\n  }))) : __jsx(\"a\", {\n    onClick: () => props.readOnly ? null : pushToList(props.data)\n  }, props.saveButton ? props.saveButton() : __jsx(Button, {\n    type: \"normal\",\n    className: \"w-100 ads-purchase-button ads-purchase-compare-btn\"\n  }, __jsx(\"img\", {\n    src: \"/assets/profile/icon-list/carmarket-bar-icon/compare.png\",\n    alt: \"compare\"\n  })))));\n};\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user,\n  productsList: state.productsList\n});\n\nconst mapDispatchToProps = {\n  loading: loading,\n  setUser: setUser,\n  removeCompareProductId: removeCompareProductId,\n  patchCompareProductIds: patchCompareProductIds,\n  clearCompareProductIds: clearCompareProductIds\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(AddCompareProductButton)));","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/general/add-compare-product-button.jsx"],"names":["Form","Button","message","Modal","Tooltip","_","withRouter","React","useEffect","useState","connect","arrayLengthCount","notEmptyLength","client","loading","clearCompareProductIds","patchCompareProductIds","removeCompareProductId","setUser","AddCompareProductButton","props","confirmModalState","setConfirmModalState","compareLimit","setCompareLimit","isNaN","parseInt","productsList","isSavedCompare","id","compareIds","check","filter","item","length","pushToList","data","_id","get","warning","ids","service","find","query","$in","then","res","map","push","success","catch","err","error","removeFromList","className","style","e","readOnly","savedButton","background","padding","saveButton","mapStateToProps","state","app","user","mapDispatchToProps","create"],"mappings":"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","sourcesContent":["import { Form } from '@ant-design/compatible';\nimport { Button, message, Modal, Tooltip } from 'antd';\nimport _ from 'lodash';\nimport { withRouter } from 'next/dist/client/router';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport { arrayLengthCount, notEmptyLength } from '../../common-function';\nimport client from '../../feathers';\nimport { loading } from '../../redux/actions/app-actions';\nimport { clearCompareProductIds, patchCompareProductIds, removeCompareProductId } from '../../redux/actions/productsList-actions';\nimport { setUser } from '../../redux/actions/user-actions';\n\n\n\nconst AddCompareProductButton = (props) => {\n\n  const [confirmModalState, setConfirmModalState] = useState(false);\n  const [compareLimit, setCompareLimit] = useState(4);\n\n\n  useEffect(() => {\n\n    setCompareLimit(_.isNaN(parseInt(props.productsList.compareLimit)) ? 4 : parseInt(props.productsList.compareLimit))\n  }, [props.productsList.compareLimit])\n\n  function isSavedCompare(id) {\n    if (id && notEmptyLength(props.productsList.compareIds)) {\n      var check = props.productsList.compareIds.filter(function (item) {\n        return item == id;\n      });\n\n      return check.length > 0;\n    } else {\n      return false;\n    }\n\n  }\n\n  const pushToList = (data) => {\n    if (data._id) {\n\n      if (arrayLengthCount(_.get(props.productsList, ['compareIds'])) >= compareLimit) {\n        message.warning(`Maximum ${compareLimit} products in comparison list.`)\n        return;\n      }\n      if (notEmptyLength(props.productsList.compareIds)) {\n        let ids = [];\n\n        client.service('product-ads').find({\n          query: {\n            _id: {\n              $in: props.productsList.compareIds,\n            },\n          }\n        }).then(res => {\n          if (notEmptyLength(res.data)) {\n          } else {\n            props.clearCompareProductIds();\n          }\n\n          ids = _.map(_.get(res, ['data']), '_id') || [];\n          ids.push(data._id);\n          props.patchCompareProductIds(ids);\n          message.success('Added to comparison list')\n        }).catch(err => {\n          // message.error(err.message)\n        });\n\n      }\n      else {\n        message.success('Added to comparison list')\n        props.patchCompareProductIds([data._id]);\n      }\n    } else {\n      message.error(\"Product Not Found\")\n    }\n  }\n\n  function removeFromList(data) {\n    if (data._id) {\n      props.removeCompareProductId(data._id);\n      message.success('Removed from comparison list')\n    }\n  }\n\n  return (\n\n    <span className={props.className ? props.className : null} style={props.style ? props.style : null}>\n\n      <Modal\n        visible={confirmModalState}\n        title=\"Are you sure?\"\n        maskClosable={true}\n        centered={true}\n        onOk={(e) => { removeFromList(props.data); setConfirmModalState(false); }}\n        onCancel={(e) => { setConfirmModalState(false) }}\n      >\n        <div> Do you want to remove this product from your comparison list? </div>\n      </Modal>\n      <Tooltip placement=\"top\" title=\"Add me into the comparison list\">\n        {\n          isSavedCompare(props.data._id) ?\n            <a onClick={() => props.readOnly ? null : setConfirmModalState(true)}>\n              {props.savedButton ? props.savedButton() : <Button type=\"normal\" style={{ background: 'rgb(89, 54, 26)', padding: 0 }} className=\"ads-purchase-button w-100\"><img src=\"/assets/profile/icon-list/carmarket-bar-icon/compare.png\" alt=\"compare\" /></Button>}\n            </a>\n            :\n            <a onClick={() => props.readOnly ? null : pushToList(props.data)}>\n              {props.saveButton ? props.saveButton() : <Button type=\"normal\" className=\"w-100 ads-purchase-button ads-purchase-compare-btn\"><img src=\"/assets/profile/icon-list/carmarket-bar-icon/compare.png\" alt=\"compare\" /></Button>}\n            </a>\n        }\n      </Tooltip>\n    </span>\n  );\n}\n\n\nconst mapStateToProps = state => ({\n  app: state.app,\n  user: state.user,\n  productsList: state.productsList,\n});\n\n\nconst mapDispatchToProps = {\n  loading: loading,\n  setUser: setUser,\n  removeCompareProductId: removeCompareProductId,\n  patchCompareProductIds: patchCompareProductIds,\n  clearCompareProductIds: clearCompareProductIds,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(AddCompareProductButton)));"]},"metadata":{},"sourceType":"module"}