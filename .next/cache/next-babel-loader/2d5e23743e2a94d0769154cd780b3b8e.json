{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Button, Col, Empty, Form, Icon, Input, message, Modal, Radio, Row } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport { isDealer } from './config';\nimport { arrayLengthCount, getUserName, isValidNumber } from '../../common-function';\nimport UserAvatar from '../general/UserAvatar';\nimport FollowButton from './FollowButton';\nimport ScrollLoadWrapper from '../general/ScrollLoadWrapper';\nimport { withRouter } from 'next/router';\nimport { loading } from '../../redux/actions/app-actions';\nvar PAGE_SIZE = 12;\nvar TYPING_TIMEOUT = 500;\n\nvar FollowerListModal = function FollowerListModal(props) {\n  _s();\n\n  var _useState = useState(false),\n      visible = _useState[0],\n      setVisible = _useState[1];\n\n  var _useState2 = useState([]),\n      followers = _useState2[0],\n      setFollowers = _useState2[1];\n\n  var _useState3 = useState(0),\n      followerTotal = _useState3[0],\n      setFollowerTotal = _useState3[1];\n\n  var _useState4 = useState(1),\n      followerPage = _useState4[0],\n      setFollowerPage = _useState4[1];\n\n  var _useState5 = useState(false),\n      isLoading = _useState5[0],\n      setIsLoading = _useState5[1];\n\n  var _useState6 = useState(''),\n      searchWord = _useState6[0],\n      setSearchWord = _useState6[1];\n\n  var _useState7 = useState(),\n      typingTimeout = _useState7[0],\n      setTypingTimeout = _useState7[1];\n\n  var _useState8 = useState({\n    keyword: '',\n    type: null\n  }),\n      filterGroup = _useState8[0],\n      setFilterGroup = _useState8[1];\n\n  useEffect(function () {\n    setVisible(props.visible);\n  }, [props.visible]);\n  useEffect(function () {\n    getFollowerList(props.userId, (followerPage - 1) * PAGE_SIZE);\n  }, [followerPage]);\n  useEffect(function () {\n    if (followerPage == 1) {\n      getFollowerList(props.userId, (followerPage - 1) * PAGE_SIZE);\n    } else {\n      setFollowerPage(1);\n    }\n  }, [filterGroup]);\n  useEffect(function () {\n    if (typingTimeout) {\n      clearTimeout(typingTimeout);\n    }\n\n    setTypingTimeout(setTimeout(function () {\n      setFilterGroup(function (filterGroup) {\n        return _objectSpread(_objectSpread({}, filterGroup), {}, {\n          keyword: searchWord\n        });\n      });\n    }, TYPING_TIMEOUT));\n  }, [searchWord]);\n  useEffect(function () {\n    if (visible && props.userId) {\n      getFollowerList(props.userId, 0);\n    }\n  }, [visible, props.userId, props.type]);\n\n  function getFollowerList(userId, skip) {\n    if (userId) {\n      if (!isValidNumber(parseInt(skip))) {\n        skip = 0;\n      } else {\n        skip = parseInt(skip);\n      }\n\n      setIsLoading(true);\n      var filter = filterGroup;\n\n      if (!filter.keyword) {\n        delete filter.keyword;\n      }\n\n      if (!filter.type) {\n        delete filter.type;\n      }\n\n      axios.get(\"\".concat(client.io.io.uri, \"getFollowerList\"), {\n        params: {\n          followingId: userId,\n          type: 'user',\n          limit: PAGE_SIZE,\n          skip: skip,\n          match: filter\n        }\n      }).then(function (res) {\n        setFollowers(_.isArray(_.get(res, ['data', 'data'])) && !_.isEmpty(_.get(res, ['data', 'data'])) ? followerPage <= 1 ? res.data.data : followers.concat(res.data.data) : []);\n        setFollowerTotal(_.get(res, ['data', 'total']));\n        setIsLoading(false);\n      })[\"catch\"](function (err) {\n        message.error(err.message);\n      });\n    }\n  }\n\n  function closeModal() {\n    setFollowers([]);\n\n    if (props.onCancel) {\n      props.onCancel();\n    }\n  }\n\n  return __jsx(Modal, {\n    visible: visible,\n    footer: null,\n    centered: true,\n    maskClosable: false,\n    width: 500,\n    onCancel: function onCancel() {\n      closeModal();\n    }\n  }, __jsx(Row, {\n    className: \"padding-top-lg margin-top-md\",\n    gutter: [10, 10]\n  }, __jsx(Col, {\n    xs: 24,\n    sm: 24,\n    md: 24,\n    lg: 24,\n    xl: 24\n  }, __jsx(\"div\", {\n    className: \"flex-justify-space-between flex-items-align-center width-100\"\n  }, __jsx(\"span\", {\n    className: \"d-inline-block font-weight-black h6\"\n  }, \"Follower\"), __jsx(\"span\", {\n    className: \"d-inline-block\"\n  }, __jsx(Radio.Group, {\n    className: \"condition-form\",\n    style: {\n      textAlign: 'center'\n    },\n    value: filterGroup.type || '',\n    onChange: function onChange(e) {\n      setFilterGroup(_objectSpread(_objectSpread({}, filterGroup), {}, {\n        type: _.toLower(e.target.value)\n      }));\n    }\n  }, __jsx(Radio.Button, {\n    style: {\n      paddingX: 10\n    },\n    className: \"margin-right-md\",\n    value: \"user\",\n    onClick: function onClick(e) {\n      if (filterGroup.type == 'user') {\n        setFilterGroup(_objectSpread(_objectSpread({}, filterGroup), {}, {\n          type: ''\n        }));\n      }\n    }\n  }, \" \", __jsx(\"p\", {\n    style: {\n      fontSize: \"13px\",\n      textAlign: \"center\"\n    }\n  }, \" User \"), \" \"), __jsx(Radio.Button, {\n    style: {\n      paddingX: 10\n    },\n    value: \"dealer\",\n    onClick: function onClick(e) {\n      if (filterGroup.type == 'dealer') {\n        setFilterGroup(_objectSpread(_objectSpread({}, filterGroup), {}, {\n          type: ''\n        }));\n      }\n    }\n  }, \" \", __jsx(\"p\", {\n    style: {\n      fontSize: \"13px\",\n      textAlign: \"center\"\n    }\n  }, \" Dealer\"), \" \"))))), __jsx(Col, {\n    xs: 24,\n    sm: 24,\n    md: 24,\n    lg: 24,\n    xl: 24\n  }, __jsx(\"div\", {\n    className: \"width-100 thin-border round-border-big no-border-input padding-sm\"\n  }, __jsx(Input, {\n    size: \"small\",\n    value: searchWord,\n    onChange: function onChange(e) {\n      setSearchWord(e.target.value);\n    },\n    placeholder: \"Search...\",\n    suffix: __jsx(Icon, {\n      type: \"search\"\n    })\n  }))), __jsx(Col, {\n    xs: 24,\n    sm: 24,\n    md: 24,\n    lg: 24,\n    xl: 24\n  }, __jsx(\"div\", {\n    className: \"width-100 padding-top-sm\"\n  }, __jsx(ScrollLoadWrapper, {\n    style: {\n      height: '50vh'\n    },\n    autoHide: true,\n    onScrolledBottom: function onScrolledBottom() {\n      if (arrayLengthCount(followers) < followerTotal) {\n        setFollowerPage(followerPage + 1);\n      }\n    }\n  }, __jsx(\"div\", {\n    className: \"width-100\"\n  }, _.isArray(followers) && !_.isEmpty(followers) ? __jsx(\"div\", {\n    className: \"width-100\"\n  }, _.map(followers, function (follower) {\n    var user = _.get(follower, 'followerId');\n\n    return __jsx(\"div\", {\n      className: \"flex-justify-space-between flex-items-align-center margin-bottom-sm width-100\"\n    }, __jsx(\"span\", {\n      className: \"flex-items-align-center width-80\"\n    }, __jsx(UserAvatar, {\n      data: user,\n      size: 50,\n      redirectProfile: true,\n      onRedirect: function onRedirect() {\n        closeModal();\n      },\n      avatarClassName: \"flex-items-no-shrink\",\n      className: \"margin-right-md\"\n    }), __jsx(\"span\", {\n      className: \"d-inline-block text-truncate\"\n    }, __jsx(\"div\", null, getUserName(user, 'freakId')), __jsx(\"div\", null, \"\".concat(getUserName(user, 'fullName'), \" \").concat(isDealer(user) && _.get(user, ['companys', 'name']) ? '|' : '', \" \").concat(isDealer(user) && _.get(user, ['companys', 'name']) ? _.get(user, ['companys', 'name']) : '')))), __jsx(\"span\", {\n      className: \"d-inline-block\"\n    }, __jsx(\"div\", {\n      className: \"flex-justify-end flex-items-align-center\"\n    }, __jsx(FollowButton, {\n      userId: _.get(user, ['_id']),\n      type: \"user\",\n      followerId: _.get(props.user, ['info', 'user', '_id']),\n      notify: true,\n      followingButton: function followingButton() {\n        return __jsx(Button, null, \"Following\");\n      },\n      followButton: function followButton() {\n        return __jsx(Button, {\n          className: \"background-ccar-yellow border-ccar-yellow black\"\n        }, \"+ Follow\");\n      }\n    }), \"                                                                            \")));\n  })) : __jsx(\"div\", {\n    className: \"flex-justify-center flex-align-center padding-md\"\n  }, __jsx(Empty, null)))))), __jsx(Col, {\n    xs: 24,\n    sm: 24,\n    md: 24,\n    lg: 24,\n    xl: 24\n  }, __jsx(\"div\", {\n    className: \"width-100 flex-justify-center\",\n    style: {\n      height: 20\n    }\n  }, isLoading ? __jsx(Icon, {\n    type: \"loading\",\n    style: {\n      fontSize: 20\n    }\n  }) : null))));\n};\n\n_s(FollowerListModal, \"gzZ3BONR1PJ5u6DfdW4z2jHUgUQ=\");\n\n_c = FollowerListModal;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    app: state.app,\n    user: state.user,\n    sellerProfile: state.sellerProfile\n  };\n};\n\nvar mapDispatchToProps = {\n  loading: loading\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(FollowerListModal)));\n\nvar _c;\n\n$RefreshReg$(_c, \"FollowerListModal\");","map":{"version":3,"sources":["/Users/faraheen/ccar-cms-next-mobile/components/profile/FollowerListModal.jsx"],"names":["Button","Col","Empty","Form","Icon","Input","message","Modal","Radio","Row","axios","_","React","useEffect","useState","connect","client","isDealer","arrayLengthCount","getUserName","isValidNumber","UserAvatar","FollowButton","ScrollLoadWrapper","withRouter","loading","PAGE_SIZE","TYPING_TIMEOUT","FollowerListModal","props","visible","setVisible","followers","setFollowers","followerTotal","setFollowerTotal","followerPage","setFollowerPage","isLoading","setIsLoading","searchWord","setSearchWord","typingTimeout","setTypingTimeout","keyword","type","filterGroup","setFilterGroup","getFollowerList","userId","clearTimeout","setTimeout","skip","parseInt","filter","get","io","uri","params","followingId","limit","match","then","res","isArray","isEmpty","data","concat","err","error","closeModal","onCancel","textAlign","e","toLower","target","value","paddingX","fontSize","height","map","follower","user","mapStateToProps","state","app","sellerProfile","mapDispatchToProps","create"],"mappings":"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","sourcesContent":["import { Button, Col, Empty, Form, Icon, Input, message, Modal, Radio, Row } from 'antd';\nimport axios from 'axios';\nimport _ from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\nimport client from '../../feathers';\nimport { isDealer } from './config';\nimport { arrayLengthCount, getUserName, isValidNumber } from '../../common-function';\nimport UserAvatar from '../general/UserAvatar';\nimport FollowButton from './FollowButton';\nimport ScrollLoadWrapper from '../general/ScrollLoadWrapper';\nimport { withRouter } from 'next/router';\nimport { loading } from '../../redux/actions/app-actions';\n\n\nconst PAGE_SIZE = 12;\nconst TYPING_TIMEOUT = 500;\n\nconst FollowerListModal = (props) => {\n\n    const [visible, setVisible] = useState(false);\n    const [followers, setFollowers] = useState([]);\n    const [followerTotal, setFollowerTotal] = useState(0);\n    const [followerPage, setFollowerPage] = useState(1);\n    const [isLoading, setIsLoading] = useState(false);\n    const [searchWord, setSearchWord] = useState('');\n    const [typingTimeout, setTypingTimeout] = useState();\n    const [filterGroup, setFilterGroup] = useState({\n        keyword: '',\n        type: null,\n    });\n\n    useEffect(() => {\n        setVisible(props.visible);\n    }, [props.visible])\n\n    useEffect(() => {\n\n        getFollowerList(props.userId, (followerPage - 1) * PAGE_SIZE);\n\n    }, [followerPage])\n\n\n    useEffect(() => {\n\n        if (followerPage == 1) {\n            getFollowerList(props.userId, (followerPage - 1) * PAGE_SIZE);\n        } else {\n            setFollowerPage(1);\n        }\n\n    }, [filterGroup])\n\n    useEffect(() => {\n\n        if (typingTimeout) {\n            clearTimeout(typingTimeout);\n        }\n\n        setTypingTimeout(\n            setTimeout(() => {\n                setFilterGroup(filterGroup => { return { ...filterGroup, keyword: searchWord } })\n            }, TYPING_TIMEOUT)\n        )\n\n    }, [searchWord])\n\n\n    useEffect(() => {\n\n        if (visible && props.userId) {\n            getFollowerList(props.userId, 0);\n        }\n\n    }, [visible, props.userId, props.type])\n\n\n    function getFollowerList(userId, skip) {\n\n        if (userId) {\n\n            if (!isValidNumber(parseInt(skip))) {\n                skip = 0;\n            } else {\n                skip = parseInt(skip);\n            }\n\n            setIsLoading(true);\n\n            let filter = filterGroup;\n            if (!filter.keyword) {\n                delete filter.keyword;\n            }\n\n            if (!filter.type) {\n                delete filter.type;\n            }\n\n\n\n\n            axios.get(`${client.io.io.uri}getFollowerList`, {\n                params: {\n                    followingId: userId,\n                    type: 'user',\n                    limit: PAGE_SIZE,\n                    skip: skip,\n                    match: filter,\n                }\n            }).then(res => {\n\n                setFollowers(_.isArray(_.get(res, ['data', 'data'])) && !_.isEmpty(_.get(res, ['data', 'data'])) ? followerPage <= 1 ? res.data.data : followers.concat(res.data.data) : [])\n                setFollowerTotal(_.get(res, ['data', 'total']));\n                setIsLoading(false)\n\n            }).catch(err => {\n                message.error(err.message)\n            });\n\n\n        }\n    }\n\n    function closeModal() {\n        setFollowers([]);\n        if (props.onCancel) {\n            props.onCancel()\n        }\n    }\n\n    return (\n        <Modal\n            visible={visible}\n            footer={null}\n            centered\n            maskClosable={false}\n            width={500}\n            onCancel={() => { closeModal() }}\n        >\n            <Row className=\"padding-top-lg margin-top-md\" gutter={[10, 10]}>\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                    <div className=\"flex-justify-space-between flex-items-align-center width-100\">\n                        <span className='d-inline-block font-weight-black h6' >\n                            Follower\n                        </span>\n                        <span className='d-inline-block' >\n                            <Radio.Group className=\"condition-form\" style={{ textAlign: 'center' }} value={filterGroup.type || ''} onChange={(e) => { setFilterGroup({ ...filterGroup, type: _.toLower(e.target.value) }) }} >\n                                <Radio.Button style={{ paddingX: 10 }} className=\"margin-right-md\" value=\"user\" onClick={(e) => { if (filterGroup.type == 'user') { setFilterGroup({ ...filterGroup, type: '' }) } }}> <p style={{ fontSize: \"13px\", textAlign: \"center\" }}> User </p> </Radio.Button>\n                                <Radio.Button style={{ paddingX: 10 }} value=\"dealer\" onClick={(e) => { if (filterGroup.type == 'dealer') { setFilterGroup({ ...filterGroup, type: '' }) } }}> <p style={{ fontSize: \"13px\", textAlign: \"center\" }}> Dealer</p> </Radio.Button>\n                            </Radio.Group>\n                        </span>\n                    </div>\n                </Col>\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                    <div className=\"width-100 thin-border round-border-big no-border-input padding-sm\">\n                        <Input size=\"small\" value={searchWord} onChange={(e) => { setSearchWord(e.target.value) }} placeholder=\"Search...\" suffix={<Icon type=\"search\"></Icon>} ></Input>\n                    </div>\n                </Col>\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                    <div className=\"width-100 padding-top-sm\">\n                        <ScrollLoadWrapper style={{ height: '50vh' }} autoHide onScrolledBottom={() => {\n                            if (arrayLengthCount(followers) < followerTotal) {\n                                setFollowerPage(followerPage + 1);\n                            }\n                        }}>\n                            <div className=\"width-100\">\n                                {\n                                    _.isArray(followers) && !_.isEmpty(followers) ?\n                                        <div className=\"width-100\">\n                                            {\n                                                _.map(followers, function (follower) {\n                                                    let user = _.get(follower, 'followerId');\n                                                    return (\n                                                        <div className=\"flex-justify-space-between flex-items-align-center margin-bottom-sm width-100\" >\n                                                            <span className=\"flex-items-align-center width-80\"  >\n                                                                <UserAvatar\n                                                                    data={user}\n                                                                    size={50}\n                                                                    redirectProfile\n                                                                    onRedirect={() => { closeModal() }}\n                                                                    avatarClassName='flex-items-no-shrink'\n                                                                    className=\"margin-right-md\"\n                                                                />\n\n                                                                <span className='d-inline-block text-truncate' >\n                                                                    <div>\n                                                                        {getUserName(user, 'freakId')}\n                                                                    </div>\n                                                                    <div>\n                                                                        {`${getUserName(user, 'fullName')} ${isDealer(user) && _.get(user, ['companys', 'name']) ? '|' : ''} ${isDealer(user) && _.get(user, ['companys', 'name']) ? _.get(user, ['companys', 'name']) : ''}`}\n                                                                    </div>\n                                                                </span>\n                                                            </span>\n                                                            <span className='d-inline-block' >\n                                                                <div className=\"flex-justify-end flex-items-align-center\">\n                                                                    <FollowButton userId={_.get(user, ['_id'])} type=\"user\" followerId={_.get(props.user, ['info', 'user', '_id'])}\n                                                                        notify\n                                                                        followingButton={() => {\n                                                                            return (\n                                                                                <Button>Following</Button>\n                                                                            )\n                                                                        }}\n                                                                        followButton={() => {\n                                                                            return <Button className=\"background-ccar-yellow border-ccar-yellow black\">+ Follow</Button>\n                                                                        }}\n                                                                    />                                                                            </div>\n                                                            </span>\n                                                        </div>\n                                                    )\n                                                })\n                                            }\n                                        </div>\n                                        :\n                                        <div className=\"flex-justify-center flex-align-center padding-md\">\n                                            <Empty></Empty>\n                                        </div>\n                                }\n                            </div>\n                        </ScrollLoadWrapper>\n                    </div>\n                </Col>\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\n                    <div className=\"width-100 flex-justify-center\" style={{ height: 20 }}>\n                        {\n                            isLoading ?\n                                <Icon type=\"loading\" style={{ fontSize: 20 }} />\n                                :\n                                null\n                        }\n                    </div>\n                </Col>\n\n            </Row>\n        </Modal>\n    );\n}\n\n\nconst mapStateToProps = state => ({\n    app: state.app,\n    user: state.user,\n    sellerProfile: state.sellerProfile,\n});\n\nconst mapDispatchToProps = {\n    loading: loading,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Form.create()(withRouter(FollowerListModal)));"]},"metadata":{},"sourceType":"module"}